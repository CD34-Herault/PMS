"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[136],{3177:(ae,X,m)=>{m.d(X,{m:()=>N});var c=m(4274),_=m(4893),L=m(4267),E=m(3305);const J=["myAreaChart"];let N=(()=>{class e{constructor(g,p){this.historiqueService=g,this.serv=p}ngOnInit(){}ngAfterViewInit(){let g=this.historiqueService;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new c.Z(this.myAreaChart.nativeElement,{type:"line",data:{labels:[],datasets:[{label:"Maj necessaires",borderWidth:1,tension:.3,fill:!0,backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",pointRadius:5,pointBackgroundColor:"rgba(179,0,102,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(179,0,102,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj \xe9chou\xe9es",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",pointRadius:5,pointBackgroundColor:"rgba(210,7,7,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(210,7,7,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj inconnues",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",pointRadius:5,pointBackgroundColor:"rgba(103,114,105,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(103,114,105,1)",pointHitRadius:50,pointBorderWidth:2,data:[]}]},options:{scales:{xAxes:{time:{unit:"day"},grid:{display:!1},ticks:{autoSkip:!0,maxRotation:45,minRotation:45,maxTicksLimit:20}},y:{min:0,grid:{color:"rgba(0, 0, 0, .125)"}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(g.typeselected){case"Production":g.imgAreaProd.next(this.toBase64Image());break;case"Pre-production":g.imgAreaPre.next(this.toBase64Image());break;case"Recette-Formation":g.imgAreaRec.next(this.toBase64Image());break;case"BDD":g.imgAreaBdd.next(this.toBase64Image());break;case"BDD-Recette":g.imgAreaBddRec.next(this.toBase64Image());break;case"Production,BDD":case"Production,Pre-production,BDD":g.imgAreaProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":g.imgAreaRecBddRec.next(this.toBase64Image())}}}}}),this.chart.hide(2),this.historique$.subscribe(p=>{var b,P,q,B,T,D,C,f,S,n,Z,I,w,H;null===(P=null===(b=this.chart.data.datasets)||void 0===b?void 0:b[0].data)||void 0===P||P.splice(0,null===(B=null===(q=this.chart.data.datasets)||void 0===q?void 0:q[0].data)||void 0===B?void 0:B.length),null===(D=null===(T=this.chart.data.datasets)||void 0===T?void 0:T[1].data)||void 0===D||D.splice(0,null===(f=null===(C=this.chart.data.datasets)||void 0===C?void 0:C[1].data)||void 0===f?void 0:f.length),null===(n=null===(S=this.chart.data.datasets)||void 0===S?void 0:S[2].data)||void 0===n||n.splice(0,null===(I=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[2].data)||void 0===I?void 0:I.length),null===(w=this.chart.data.labels)||void 0===w||w.splice(0,null===(H=this.chart.data.labels)||void 0===H?void 0:H.length);var u=0;p.forEach(W=>{var $,Y,K,z,G,ee,Q;null===($=this.chart.data.labels)||void 0===$||$.push(W.date);var A=0,O=0,l=0;W.serveurs.forEach(h=>{A+=h.kb_inconnus,O+=h.kb_failed,l+=h.kb_manquantes}),null===(K=null===(Y=this.chart.data.datasets)||void 0===Y?void 0:Y[0].data)||void 0===K||K.push(l),null===(G=null===(z=this.chart.data.datasets)||void 0===z?void 0:z[1].data)||void 0===G||G.push(O),null===(Q=null===(ee=this.chart.data.datasets)||void 0===ee?void 0:ee[2].data)||void 0===Q||Q.push(A),A>=u&&(u=A),O>=u&&(u=O),l>=u&&(u=l),function V(e,R){e.options.scales.y={min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}(this.chart)}),this.chart.update()})}}return e.\u0275fac=function(g){return new(g||e)(_.Y36(L.J),_.Y36(E.t))},e.\u0275cmp=_.Xpm({type:e,selectors:[["sb-charts-area"]],viewQuery:function(g,p){if(1&g&&_.Gf(J,5),2&g){let b;_.iGM(b=_.CRH())&&(p.myAreaChart=b.first)}},decls:2,vars:0,consts:[["myAreaChart",""]],template:function(g,p){1&g&&_._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),e})()},6021:(ae,X,m)=>{m.d(X,{e:()=>N});var c=m(829),_=m(1013),L=m(4893),E=m(4267);const J=["myBarChart"];let N=(()=>{class V{constructor(R){this.historiqueService=R}ngOnInit(){}ngAfterViewInit(){var R;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$;let p,g=this.historiqueService;this.chart=new c.kL(this.myBarChart.nativeElement,{type:"bar",plugins:[_.Z],data:{datasets:[]},options:{plugins:{datalabels:{color:"#236be8"}},animation:{onComplete:function(){if(null!=this.data.datasets[1])switch(g.typeselected){case"Production":g.imgBarProd.next(this.toBase64Image()),g.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),g.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":g.imgBarPre.next(this.toBase64Image()),g.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),g.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":g.imgBarRec.next(this.toBase64Image()),g.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),g.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":g.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":g.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":g.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":g.imgBarRecBddRec.next(this.toBase64Image()),g.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),g.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":g.imgBarProdBdd.next(this.toBase64Image()),g.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),g.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}),null!=this.osSelected&&(p=null===(R=this.osSelected)||void 0===R?void 0:R.split("_")),this.historique$.subscribe(b=>{var P,q,B,T,D,C,f=0;if("TOUT"!=this.historiqueService.dateselected_debut&&"TOUT"!=this.historiqueService.dateselected_fin){if(null===(P=this.chart.data.datasets)||void 0===P||P.splice(0,null===(q=this.chart.data.datasets)||void 0===q?void 0:q.length),null===(B=this.chart.data.labels)||void 0===B||B.splice(0,null===(T=this.chart.data.labels)||void 0===T?void 0:T.length),this.chart.data={labels:["Avant","Apr\xe8s"],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]},b.forEach(n=>{var Z,I,w,H,u,W,$,Y,K,z,G,ee,Q=0,A=0,O=0;n.serveurs.forEach(h=>{null!=h.kb_inconnus&&(Q+=h.kb_inconnus),null!=h.kb_failed&&(A+=h.kb_failed),null!=h.kb_manquantes&&(O+=h.kb_manquantes)});let l=new Date(n.date);l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),this.historiqueService.dateselected_debut instanceof Date&&l.getTime()==this.historiqueService.dateselected_debut.getTime()&&(null===(I=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[0].data)||void 0===I||I.push(O),null===(H=null===(w=this.chart.data.datasets)||void 0===w?void 0:w[1].data)||void 0===H||H.push(A),null===(W=null===(u=this.chart.data.datasets)||void 0===u?void 0:u[2].data)||void 0===W||W.push(Q)),this.historiqueService.dateselected_fin instanceof Date&&l.getTime()==this.historiqueService.dateselected_fin.getTime()&&(null===(Y=null===($=this.chart.data.datasets)||void 0===$?void 0:$[0].data)||void 0===Y||Y.push(O),null===(z=null===(K=this.chart.data.datasets)||void 0===K?void 0:K[1].data)||void 0===z||z.push(A),null===(ee=null===(G=this.chart.data.datasets)||void 0===G?void 0:G[2].data)||void 0===ee||ee.push(Q)),Q>=f&&(f=Q),A>=f&&(f=A),O>=f&&(f=O)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*f),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}else{null===(D=this.chart.data.datasets)||void 0===D||D.splice(0,null===(C=this.chart.data.datasets)||void 0===C?void 0:C.length),this.chart.data={labels:[],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]};var S=[];if(b.forEach(n=>{let Z=new Date(n.date).toLocaleString("default",{month:"short"});this.moisInTab(S,Z)||S.push({nom:Z,kb_failed:0,kb_necessaire:0,kb_unkown:0,nbr_histo:0});var I=0,w=0,H=0;n.serveurs.forEach(u=>{null!=p&&p[0].includes("alco")&&p[1].includes("windows")?!(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("alco")&&(null!=u.kb_inconnus&&(I+=u.kb_inconnus),null!=u.kb_failed&&(w+=u.kb_failed),null!=u.kb_manquantes&&(H+=u.kb_manquantes)):null!=p&&p[0].includes("alco")&&p[1].includes("linux")?(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("alco")&&(null!=u.kb_inconnus&&(I+=u.kb_inconnus),null!=u.kb_failed&&(w+=u.kb_failed),null!=u.kb_manquantes&&(H+=u.kb_manquantes)):null!=p&&p[0].includes("heberge")&&p[1].includes("windows")?!(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("heberge")&&(null!=u.kb_inconnus&&(I+=u.kb_inconnus),null!=u.kb_failed&&(w+=u.kb_failed),null!=u.kb_manquantes&&(H+=u.kb_manquantes)):null!=p&&p[0].includes("heberge")&&p[1].includes("linux")?(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("heberge")&&(null!=u.kb_inconnus&&(I+=u.kb_inconnus),null!=u.kb_failed&&(w+=u.kb_failed),null!=u.kb_manquantes&&(H+=u.kb_manquantes)):(null!=u.kb_inconnus&&(I+=u.kb_inconnus),null!=u.kb_failed&&(w+=u.kb_failed),null!=u.kb_manquantes&&(H+=u.kb_manquantes))});for(let u=0;u<S.length;u++)S[u].nom==Z&&(S[u].kb_failed+=w,S[u].kb_necessaire+=H,S[u].kb_unkown+=I)}),S.forEach(n=>{var Z,I,w,H,u,W,$;n.kb_failed=Math.round(n.kb_failed/(n.nbr_histo+1)),n.kb_necessaire=Math.round(n.kb_necessaire/(n.nbr_histo+1)),n.kb_unkown=Math.round(n.kb_unkown/(n.nbr_histo+1)),null===(Z=this.chart.data.labels)||void 0===Z||Z.push(n.nom),null===(w=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[0].data)||void 0===w||w.push(n.kb_necessaire),null===(u=null===(H=this.chart.data.datasets)||void 0===H?void 0:H[1].data)||void 0===u||u.push(n.kb_failed),null===($=null===(W=this.chart.data.datasets)||void 0===W?void 0:W[2].data)||void 0===$||$.push(n.kb_unkown),n.kb_unkown>=f&&(f=n.kb_unkown),n.kb_failed>=f&&(f=n.kb_failed),n.kb_necessaire>=f&&(f=n.kb_necessaire)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*f),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}})}moisInTab(R,g){for(let p=0;p<R.length;p++)if(R[p].nom==g)return R[p].nbr_histo++,!0;return!1}}return V.\u0275fac=function(R){return new(R||V)(L.Y36(E.J))},V.\u0275cmp=L.Xpm({type:V,selectors:[["sb-charts-bar"]],viewQuery:function(R,g){if(1&R&&L.Gf(J,5),2&R){let p;L.iGM(p=L.CRH())&&(g.myBarChart=p.first)}},inputs:{osSelected:"osSelected"},decls:2,vars:0,consts:[["myBarChart",""]],template:function(R,g){1&R&&L._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),V})()},9410:(ae,X,m)=>{m.d(X,{y:()=>g});var c=m(829),_=m(1013),L=m(1135),E=m(4893),J=m(3305),N=m(7979),V=m(757),e=m(4267);const R=["myPieChart"];let g=(()=>{class p{constructor(P,q,B,T){this.serveursService=P,this.route=q,this.userProfilService=B,this.historiqueService=T,this.lesServeurs=new L.X([]),this.kb_verte=0,this.kb_orange=0,this.kb_rouge=0,this.serveurs$=this.serveursService.messerveurs$,this.serveurs$.subscribe(D=>{this.lesServeurs.next(D)})}ngOnChanges(P){this.lesServeurs.next([])}ngOnInit(){var P=this.route;let q=this.historiqueService;this.userProfilService.get_user_profil().subscribe(B=>{this.chart=new c.kL(this.myPieChart.nativeElement,{type:"pie",data:{labels:["Serveurs n\xe9cessitant > "+B.serveursAlerte+" Maj","Serveurs n\xe9cessitant "+B.serveursBon+" \xe0 "+B.serveursAlerte+" Maj","Serveurs n\xe9cessitant < "+B.serveursBon+" Maj"],datasets:[{data:[],backgroundColor:["#dc3545","#ffc107","#28a745"]}]},options:{responsive:!0,aspectRatio:2,animation:{easing:"linear",onComplete:function(){null!=this.data.datasets[0].data[0]&&q.imgPie.next(this.toBase64Image())}}},plugins:[_.Z]}),this.lesServeurs.subscribe(T=>{var D;this.chart.data.datasets[0].data=[];let C,f=T.length;null!=this.osSelected&&(C=null===(D=this.osSelected)||void 0===D?void 0:D.split("_")),null!=C&&C[0].includes("alco")&&C[1].includes("windows")&&(f=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("alco")&&C[1].includes("linux")&&(f=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("heberge")&&C[1].includes("windows")&&(f=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("heberge")&&C[1].includes("linux")&&(f=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),this.chart.data.datasets[0].data.push(this.kb_rouge),this.chart.data.datasets[0].data.push(this.kb_orange),this.chart.data.datasets[0].data.push(this.kb_verte);let S=this.historiqueService;this.chart.options={responsive:!0,aspectRatio:2,plugins:{legend:{position:"right"},datalabels:{color:"black",font:{weight:"bold",size:16},formatter:(n,Z)=>{const w=(n/f*100).toFixed(1);return n/T.length*100<8?null:`${w}%`}},tooltip:{callbacks:{label:function(n){return" "+n.formattedValue+" Serveurs, soit : "+(parseInt(n.formattedValue)/f*100).toFixed(1)+"%"}},displayColors:!1}},elements:{point:{radius:0}},onClick:function(n){P.navigate(["patchManagement/serveurs/Alco_Windows"])},animation:{easing:"linear",onComplete:function(){S.imgPie.next(this.toBase64Image())}}},this.chart.update(),this.chart.resize()})})}ngAfterViewChecked(){}}return p.\u0275fac=function(P){return new(P||p)(E.Y36(J.t),E.Y36(N.F0),E.Y36(V.gb),E.Y36(e.J))},p.\u0275cmp=E.Xpm({type:p,selectors:[["sb-charts-pie"]],viewQuery:function(P,q){if(1&P&&E.Gf(R,5),2&P){let B;E.iGM(B=E.CRH())&&(q.myPieChart=B.first)}},inputs:{osSelected:"osSelected"},features:[E.TTD],decls:2,vars:0,consts:[["myPieChart",""]],template:function(P,q){1&P&&E._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),p})()},3678:(ae,X,m)=>{m.d(X,{L:()=>e});var c=m(7751),_=m(4893),L=m(4267),E=m(2382),J=m(9444);function N(R,g){if(1&R){const p=_.EpF();_.TgZ(0,"span",14),_.NdJ("mouseenter",function(){const q=_.CHM(p).$implicit;return _.oxw().hoveredDate=q})("mouseleave",function(){return _.CHM(p),_.oxw().hoveredDate=null}),_._uU(1),_.qZA()}if(2&R){const p=g.$implicit,b=g.focused,P=_.oxw();_.ekj("focused",b)("range",P.isRange(p))("faded",P.isHovered(p)||P.isInside(p)),_.xp6(1),_.hij(" ",p.day," ")}}const V=function(){return["fas","table"]};let e=(()=>{class R{constructor(p,b,P){this.calendar=p,this.formatter=b,this.historiqueService=P,this.hoveredDate=null,this.fromDate=null,this.toDate=null}onDateSelection(p){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&p&&p.after(this.fromDate)?this.toDate=p:(this.toDate=null,this.fromDate=p):this.fromDate=p}isHovered(p){return this.fromDate&&!this.toDate&&this.hoveredDate&&p.after(this.fromDate)&&p.before(this.hoveredDate)}isInside(p){return this.toDate&&p.after(this.fromDate)&&p.before(this.toDate)}isRange(p){return p.equals(this.fromDate)||this.toDate&&p.equals(this.toDate)||this.isInside(p)||this.isHovered(p)}validateInput(p,b){const P=this.formatter.parse(b);return P&&this.calendar.isValid(c.qj.from(P))?c.qj.from(P):p}eventChange(){this.historiqueService.dateSelected_debut=null==this.fromDate?null:new Date(this.fromDate.year,this.fromDate.month-1,this.fromDate.day),this.historiqueService.dateSelected_fin=null==this.toDate?null:new Date(this.toDate.year,this.toDate.month-1,this.toDate.day)}ngOnInit(){}}return R.\u0275fac=function(p){return new(p||R)(_.Y36(c.vL),_.Y36(c.NG),_.Y36(L.J))},R.\u0275cmp=_.Xpm({type:R,selectors:[["app-date-picker"]],decls:19,vars:8,consts:[[1,"form-inline"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"autoClose","displayMonths","dayTemplate","startDate","dateSelect"],["datepicker","ngbDatepicker"],["t",""],[1,"input-group","mr-2"],["placeholder","D\xe9but","name","dpFromDate",1,"form-control",3,"value","input"],["dpFromDate",""],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[1,"mr-1",3,"icon"],["placeholder","Fin","name","dpToDate",1,"form-control",3,"value","input"],["dpToDate",""],["type","button",1,"btn","btn-outline-primary","ml-2",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(p,b){if(1&p){const P=_.EpF();_.TgZ(0,"form",0)(1,"div")(2,"div",1)(3,"div",2)(4,"input",3,4),_.NdJ("dateSelect",function(B){return b.onDateSelection(B),b.eventChange()}),_.qZA(),_.YNc(6,N,2,7,"ng-template",null,5,_.W1O),_.qZA()(),_.TgZ(8,"div",6)(9,"input",7,8),_.NdJ("input",function(){_.CHM(P);const B=_.MAs(10);return b.fromDate=b.validateInput(b.fromDate,B.value)}),_.qZA(),_.TgZ(11,"button",9),_.NdJ("click",function(){return _.CHM(P),_.MAs(5).toggle()}),_._UZ(12,"fa-icon",10),_.qZA()()(),_.TgZ(13,"div")(14,"div",2)(15,"input",11,12),_.NdJ("input",function(){_.CHM(P);const B=_.MAs(16);return b.toDate=b.validateInput(b.toDate,B.value)}),_.qZA(),_.TgZ(17,"button",13),_.NdJ("click",function(){return b.fromDate=null,b.toDate=null,b.eventChange()}),_._uU(18,"Reset"),_.qZA()()()()}if(2&p){const P=_.MAs(7);_.xp6(4),_.Q6J("autoClose","outside")("displayMonths",1)("dayTemplate",P)("startDate",b.fromDate),_.xp6(5),_.Q6J("value",b.formatter.format(b.fromDate)),_.xp6(3),_.Q6J("icon",_.DdM(7,V)),_.xp6(3),_.Q6J("value",b.formatter.format(b.toDate))}},directives:[E._Y,E.JL,E.F,c.J4,J.BN],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]}),R})()},4850:(ae,X,m)=>{m.d(X,{p:()=>Q});var c=m(7751),_=m(1135),L=m(3177),E=m(6021),J=m(9410),N=m(3678),e=m(4893),R=m(4267),g=m(3154),p=m(7979),b=m(2382),P=m(5212),q=m(6333),B=m(9444),T=m(9808);function D(A,O){if(1&A){const l=e.EpF();e.TgZ(0,"div",24)(1,"h4",25),e._uU(2,"Generation Du Rapport"),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){return e.CHM(l).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",27)(5,"form",28)(6,"p"),e._uU(7,"Veuillez S\xe9l\xe9ctionner le nombre de jours \xe0 prendre en compte pour le rapport."),e.qZA(),e.TgZ(8,"input",29),e.NdJ("ngModelChange",function(x){return e.CHM(l),e.oxw().joursRapport=x}),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Choisissez l'environnement:"),e.qZA(),e.TgZ(11,"select",30),e.NdJ("ngModelChange",function(x){return e.CHM(l),e.oxw().environnement=x}),e.TgZ(12,"option",31),e._uU(13,"Production"),e.qZA(),e.TgZ(14,"option",32),e._uU(15,"Recette-Formation"),e.qZA()(),e.TgZ(16,"label",33)(17,"input",34),e.NdJ("ngModelChange",function(x){return e.CHM(l),e.oxw().bdd_checked=x}),e.qZA(),e._uU(18," Avec BDD "),e.qZA(),e.TgZ(19,"div")(20,"label",35),e._uU(21,"Entrez votre email"),e.qZA(),e.TgZ(22,"input",36),e.NdJ("ngModelChange",function(x){return e.CHM(l),e.oxw().email=x}),e.qZA(),e.TgZ(23,"div",37),e._uU(24," Attention email obligatoire "),e.qZA()()()(),e.TgZ(25,"div",38)(26,"button",39),e.NdJ("click",function(){return e.CHM(l).$implicit.dismiss("cancel click")}),e._uU(27,"Annuler"),e.qZA(),e.TgZ(28,"button",40),e.NdJ("click",function(){const j=e.CHM(l).$implicit,F=e.oxw();return j.close("Ok click"),F.genereRapport()}),e._uU(29,"G\xe9n\xe9rer"),e.qZA()()}if(2&A){const l=e.oxw();e.xp6(8),e.Q6J("min",1)("ngModel",l.joursRapport),e.xp6(3),e.Q6J("ngModel",l.environnement),e.xp6(6),e.Q6J("ngModel",l.bdd_checked),e.xp6(5),e.Q6J("ngModel",l.email)}}const C=function(){return["fab","windows"]};function f(A,O){if(1&A){const l=e.EpF();e.TgZ(0,"div",45)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Windows "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Production"}),e._uU(7,"Prod"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Pre-production"}),e._uU(9,"Pre-Prod"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Recette-Formation"}),e._uU(11,"Rec-Form"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD"}),e._uU(13,"BDD"),e.qZA(),e.TgZ(14,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-Recette"}),e._uU(15,"BDD-Rec"),e.qZA(),e.TgZ(16,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="DMZ"}),e._uU(17,"DMZ"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,C)))}function S(A,O){if(1&A){const l=e.EpF();e.TgZ(0,"div",48)(1,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Production,Pre-production,BDD"}),e._uU(2,"Production + BDD"),e.qZA(),e.TgZ(3,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Recette-Formation,BDD-Recette"}),e._uU(4,"Rec-Form + BDD-Rec"),e.qZA()()}}const n=function(){return["fab","linux"]};function Z(A,O){if(1&A){const l=e.EpF();e.TgZ(0,"div",49)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Linux "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-PRODPRE"}),e._uU(7,"BDD-ProPre"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-RECFOR"}),e._uU(9,"BDD-RECFOR"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="PROD-PRE"}),e._uU(11,"PROD-PRE"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="REC-FOR"}),e._uU(13,"REC-FOR"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,n)))}function I(A,O){if(1&A&&(e.TgZ(0,"div",41),e.YNc(1,f,18,2,"div",42),e.YNc(2,S,5,0,"div",43),e.YNc(3,Z,14,2,"div",44),e.qZA()),2&A){const l=O.ngIf;e.xp6(1),e.Q6J("ngIf","Alco_Windows"==l),e.xp6(1),e.Q6J("ngIf","Alco_Windows"==l),e.xp6(1),e.Q6J("ngIf","Alco_Linux"==l)}}function w(A,O){if(1&A&&(e.TgZ(0,"span",17),e._uU(1,"Total historiques: "),e.TgZ(2,"span",50),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&A){const l=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,l.historiqueService.total$))}}const H=function(){return["fas","xmark"]};function u(A,O){if(1&A){const l=e.EpF();e.TgZ(0,"li",51),e._uU(1),e.TgZ(2,"span",52),e.NdJ("click",function(){const j=e.CHM(l).$implicit;return e.oxw().deleteItem(j)}),e._UZ(3,"fa-icon",7),e.qZA()()}if(2&A){const l=O.$implicit;e.xp6(1),e.Oqu(l),e.xp6(2),e.Q6J("icon",e.DdM(2,H))}}function W(A,O){if(1&A&&(e.TgZ(0,"div",53)(1,"div",54),e._uU(2),e.qZA()()),2&A){const l=e.oxw();e.xp6(1),e.Udp("width",l.progress,"%"),e.xp6(1),e.hij(" ",l.progress,"% Complete ")}}function $(A,O){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function Y(A,O){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const l=O.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",l,"h")}}function K(A,O){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function z(A,O){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const l=O.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",l,"h")}}const G=function(){return["fas","search"]},ee=function(){return["fas","chart-area"]};let Q=(()=>{class A{constructor(l,h,x,j,F){this.historiqueService=l,this.horaireMajService=h,this.route=x,this.modalService=j,this.viewContainerRef=F,this.pageSize=4,this.maRecherche=Array(),this.search="",this.title="Nombres de patchs /mois",this.horaireMaj=new _.X(""),this.osSelected=new _.X("All"),this.joursRapport=1,this.loading_rapport=new _.X(!1),this.progress=0,this.environnement="Prod",this.bdd_checked=!0,this.email=""}ngOnDestroy(){this.search="",this.maRecherche.splice(0,this.maRecherche.length),this.historiqueService.serveursselected=[]}ngOnInit(){this.horaireMajService.getHoraireMaj().subscribe(l=>{console.log("horaire: "+l),this.horaireMaj.next(l)}),this.route.params.subscribe(l=>{null!=l.OSSelected&&(this.osSelected.next(l.OSSelected),this.osSelected.subscribe(h=>{this.historiqueService.OSSelected=h}))})}RemoveElementFromArray(l){this.maRecherche.forEach((h,x)=>{h==l&&this.maRecherche.splice(x,1)})}deleteItem(l){this.RemoveElementFromArray(l);var h=this.historiqueService.serveursselected;h.forEach((x,j)=>{x==l&&h.splice(j,1)}),this.historiqueService.serveursselected=h}ajout(){this.maRecherche.push(this.search);var l=this.historiqueService.serveursselected;l.push(this.search),this.historiqueService.serveursselected=l}open(l){this.modalService.open(l,{centered:!0}).result.then(h=>{this.closeResult=`Closed with: ${h}`},h=>{this.closeResult=`Dismissed ${this.getDismissReason(h)}`})}getDismissReason(l){return l===c.If.ESC?"by pressing ESC":l===c.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${l}`}genereRapport(){this.loading_rapport.next(!0);const l=new Date;l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0);const h=new Date(l);h.setDate(h.getDate()-this.joursRapport),h.setHours(0),h.setMinutes(0),h.setSeconds(0),h.setMilliseconds(0),this.historiqueService.dateSelected_fin=l,this.historiqueService.dateSelected_debut=h,this.historiqueService.imgAreaProd.next(" "),this.historiqueService.imgAreaPre.next(" "),this.historiqueService.imgAreaBdd.next(" "),this.historiqueService.imgAreaProdBdd.next(" "),this.historiqueService.imgAreaRec.next(" "),this.historiqueService.imgAreaBddRec.next(" "),this.historiqueService.imgAreaRecBddRec.next(" "),this.historiqueService.imgBarProd.next(" "),this.historiqueService.imgBarPre.next(" "),this.historiqueService.imgBarBdd.next(" "),this.historiqueService.imgBarProdBdd.next(" "),this.historiqueService.imgBarRec.next(" "),this.historiqueService.imgBarBddRec.next(" "),this.historiqueService.imgBarRecBddRec.next(" "),this.historiqueService.imgPie.next(" "),this.historiqueService.majAvProdAppli.next(" "),this.historiqueService.majApProdAppli.next(" "),this.historiqueService.majAvProdBdd.next(" "),this.historiqueService.majApProdBdd.next(" "),this.historiqueService.majAvRecAppli.next(" "),this.historiqueService.majApRecAppli.next(" "),this.historiqueService.majAvRecBdd.next(" "),this.historiqueService.majApRecBdd.next(" "),this.progress=10;const x=this.viewContainerRef.createComponent(J.y);if(x.instance.osSelected="alco_windows","Prod"==this.environnement){let j=this.historiqueService.loading$.subscribe(F=>{0==F&&setTimeout(()=>{" "!=this.historiqueService.imgAreaProd.getValue()&&" "!=this.historiqueService.imgAreaPre.getValue()&&" "!=this.historiqueService.imgBarProd.getValue()&&" "!=this.historiqueService.imgBarPre.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBdd.getValue()&&" "!=this.historiqueService.imgAreaProdBdd.getValue()&&" "!=this.historiqueService.imgBarBdd.getValue()&&" "!=this.historiqueService.imgBarProdBdd.getValue()?(j.unsubscribe(),x.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!0,this.email).subscribe(ie=>{this.progress=100,this.loading_rapport.next(!1),alert(ie)})):" "==this.historiqueService.imgAreaBdd.getValue()||" "==this.historiqueService.imgBarBdd.getValue()?(this.progress=70,this.historiqueService.typeselected="BDD"):(this.progress=90,this.historiqueService.typeselected="Production,Pre-production,BDD"):(this.progress=75,j.unsubscribe(),x.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!1,this.email).subscribe(ie=>{this.progress=100,this.loading_rapport.next(!1),alert(ie)})):" "==this.historiqueService.imgAreaProd.getValue()||" "==this.historiqueService.imgBarProd.getValue()?(this.progress=25,this.historiqueService.typeselected="Production"):(" "==this.historiqueService.imgAreaPre.getValue()||" "==this.historiqueService.imgBarPre.getValue())&&(this.progress=40,this.historiqueService.typeselected="Pre-production")},1e4)})}else if("Rec"==this.environnement){let j=this.historiqueService.loading$.subscribe(F=>{0==F&&setTimeout(()=>{" "!=this.historiqueService.imgAreaRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBddRec.getValue()&&" "!=this.historiqueService.imgAreaRecBddRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()&&" "!=this.historiqueService.imgBarRecBddRec.getValue()?(j.unsubscribe(),x.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!0,this.email).subscribe(ie=>{this.progress=100,this.loading_rapport.next(!1),alert(ie)})):" "==this.historiqueService.imgAreaBddRec.getValue()||" "==this.historiqueService.imgBarRec.getValue()?(this.progress=50,this.historiqueService.typeselected="BDD-Recette"):(this.progress=70,this.historiqueService.typeselected="Recette-Formation,BDD-Recette"):(this.progress=80,j.unsubscribe(),x.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!1,this.email).subscribe(ie=>{this.progress=100,this.loading_rapport.next(!1),alert(ie)})):(" "==this.historiqueService.imgAreaRec.getValue()||" "==this.historiqueService.imgBarRec.getValue())&&(this.progress=25,this.historiqueService.typeselected="Recette-Formation")},1e4)})}}}return A.\u0275fac=function(l){return new(l||A)(e.Y36(R.J),e.Y36(g.w),e.Y36(p.gz),e.Y36(c.FF),e.Y36(e.s_b))},A.\u0275cmp=e.Xpm({type:A,selectors:[["app-historique"]],inputs:{pageSize:"pageSize"},decls:54,vars:31,consts:[["content",""],["title","Historique",3,"hideBreadcrumbs"],[1,"card-body"],[1,"form-group","form-inline"],["type","text","name","searchTerm",1,"form-control","ml-1",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],["class","ml-2 btn-toolbar","role","toolbar","aria-label","Toolbar with button groups",4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3","list-group","list-group-horizontal"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","progress",4,"ngIf"],[1,"row"],[1,"col-lg-6"],[1,"card-header","form-inline"],[1,"mr-1",3,"icon"],[1,"ml-3"],["class","progress ml-1",4,"ngIf"],[1,"card-footer","small","text-muted","d-flex","d-flex","justify-content-between"],["class","ml-auto",4,"ngIf"],["id","#title"],[1,"ml-0",2,"visibility","hidden"],[1,"card-footer","small","text-muted","d-flex","mb-0"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",1,"needs-validation"],["type","number","name","input-jour",1,"form-control","ml-1",3,"min","ngModel","ngModelChange"],["name","select_env",1,"browser-default","custom-select",3,"ngModel","ngModelChange"],["value","Prod"],["value","Rec"],[1,"form-check-label","mt-1"],["type","checkbox","value","bdd_checked","name","check_bdd","checked","",3,"ngModel","ngModelChange"],["for","form9"],["type","email","id","exampleInputEmail1","aria-describedby","emailHelp","placeholder","Enter email","name","email","required","",1,"form-control","is-invalid",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["class","btn-group me-2","role","group","aria-label","First group",4,"ngIf"],["class","btn-group me-2 ml-1","role","group","aria-label","Second group",4,"ngIf"],["class","btn-group me-2 ml-2","role","group","aria-label","Third group",4,"ngIf"],["role","group","aria-label","First group",1,"btn-group","me-2"],[1,"btn"],["type","button",1,"btn","btn-outline-info","button_perso",3,"click"],["role","group","aria-label","Second group",1,"btn-group","me-2","ml-1"],["role","group","aria-label","Third group",1,"btn-group","me-2","ml-2"],[1,"font-weight-bold"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ml-3",3,"click"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-success"],[1,"progress","ml-1"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","100%"],[1,"ml-auto"]],template:function(l,h){if(1&l){const x=e.EpF();e.YNc(0,D,30,5,"ng-template",null,0,e.W1O),e._UZ(2,"sb-dashboard-head",1),e.TgZ(3,"sb-card")(4,"div",2)(5,"form")(6,"div",3),e._uU(7,"Recherche: "),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function(F){return h.search=F}),e.qZA(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return h.ajout()}),e._UZ(11,"fa-icon",7),e.qZA()(),e.YNc(12,I,4,3,"div",8),e.ALo(13,"async"),e.YNc(14,w,5,3,"span",9),e.ALo(15,"async"),e.TgZ(16,"ul",10),e.YNc(17,u,4,3,"li",11),e.qZA(),e.TgZ(18,"button",6),e.NdJ("click",function(){e.CHM(x);const F=e.MAs(1);return h.open(F)}),e._uU(19,"G\xe9n\xe9rer rapport"),e.qZA()()(),e.YNc(20,W,3,3,"div",12),e.ALo(21,"async"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"sb-card")(25,"div",15),e._UZ(26,"fa-icon",16),e.TgZ(27,"span"),e._uU(28,"Intervalle: "),e.qZA(),e._UZ(29,"app-date-picker",17),e.qZA(),e.TgZ(30,"div",2),e.YNc(31,$,3,0,"div",18),e.ALo(32,"async"),e._UZ(33,"sb-charts-area"),e.qZA(),e.TgZ(34,"div",19),e._uU(35,"Mise \xe0 jour /jour "),e.YNc(36,Y,2,1,"p",20),e.ALo(37,"async"),e.qZA()()(),e.TgZ(38,"div",14)(39,"sb-card")(40,"div",15),e._UZ(41,"fa-icon",16),e.TgZ(42,"span",21),e._uU(43),e.qZA(),e._UZ(44,"app-date-picker",22),e.qZA(),e.TgZ(45,"div",2),e.YNc(46,K,3,0,"div",18),e.ALo(47,"async"),e._UZ(48,"sb-charts-bar"),e.qZA(),e.TgZ(49,"div",23)(50,"p"),e._uU(51,"Mise \xe0 jour /mois (moyenne)"),e.qZA(),e.YNc(52,z,2,1,"p",20),e.ALo(53,"async"),e.qZA()()()()}2&l&&(e.xp6(2),e.Q6J("hideBreadcrumbs",!1),e.xp6(6),e.Q6J("ngModel",h.search),e.xp6(3),e.Q6J("icon",e.DdM(28,G)),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,14,h.osSelected)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,16,h.historiqueService.total$)),e.xp6(3),e.Q6J("ngForOf",h.maRecherche),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,18,h.loading_rapport)),e.xp6(6),e.Q6J("icon",e.DdM(29,ee)),e.xp6(5),e.Q6J("ngIf",e.lcZ(32,20,h.historiqueService.loading$)),e.xp6(5),e.Q6J("ngIf",e.lcZ(37,22,h.horaireMaj)),e.xp6(5),e.Q6J("icon",e.DdM(30,ee)),e.xp6(2),e.Oqu(h.title),e.xp6(3),e.Q6J("ngIf",e.lcZ(47,24,h.historiqueService.loading$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(53,26,h.horaireMaj)))},directives:[b._Y,b.JL,b.F,b.qQ,b.wV,b.Fj,b.JJ,b.On,b.EJ,b.YN,b.Kr,b.Wl,b.Q7,P.T,q.A,B.BN,T.O5,T.sg,N.L,L.m,E.e],pipes:[T.Ov],styles:[".button_perso[_ngcontent-%COMP%]:focus{color:#fff;background-color:#17a2b8;box-shadow:none}.button_perso[_ngcontent-%COMP%]{border:.5px solid #17a2b8!important}"],changeDetection:0}),A})()},9136:(ae,X,m)=>{m.d(X,{e:()=>P});var c=m(9808),_=m(7979),L=m(2382),E=m(2539),J=m(5592),N=m(4267),V=m(4893);m(4850),m(3177),m(6021),m(9410),m(3678);let P=(()=>{class q{}return q.\u0275fac=function(T){return new(T||q)},q.\u0275mod=V.oAB({type:q}),q.\u0275inj=V.cJS({providers:[c.JJ,...N.u],imports:[[c.ez,_.Bz,L.UX,L.u5,E.n,J.A]]}),q})()},4267:(ae,X,m)=>{m.d(X,{J:()=>B,u:()=>T});var c=m(1135),_=m(7579),L=m(8505),E=m(8372),J=m(3900),N=m(4825),V=m(9646),e=m(4893),R=m(9808),g=m(520);let B=(()=>{class D{constructor(f,S){this.pipe=f,this.http=S,this._loading$=new c.X(!0),this._search$=new _.x,this._mesHisto$=new _.x,this._historique$=new c.X([]),this._total$=new c.X(0),this.imgAreaProd=new c.X(""),this.imgAreaPre=new c.X(""),this.imgAreaBdd=new c.X(""),this.imgAreaProdBdd=new c.X(""),this.imgAreaRec=new c.X(""),this.imgAreaBddRec=new c.X(""),this.imgAreaRecBddRec=new c.X(""),this.imgBarProd=new c.X(""),this.imgBarPre=new c.X(""),this.imgBarBdd=new c.X(""),this.imgBarProdBdd=new c.X(""),this.imgBarRec=new c.X(""),this.imgBarBddRec=new c.X(""),this.imgBarRecBddRec=new c.X(""),this.imgPie=new c.X(""),this.majAvProdAppli=new c.X(""),this.majApProdAppli=new c.X(""),this.majAvPreAppli=new c.X(""),this.majApPreAppli=new c.X(""),this.majAvProdBdd=new c.X(""),this.majApProdBdd=new c.X(""),this.majAvRecAppli=new c.X(""),this.majApRecAppli=new c.X(""),this.majAvRecBdd=new c.X(""),this.majApRecBdd=new c.X(""),this.baseURL="https://172.17.2.130/",this._state={dateSelected_debut:"TOUT",dateSelected_fin:"TOUT",typeSelected:"Tous",serveursSelected:[],OSSelected:"Alco_Windows"},this._search$.pipe((0,L.b)(()=>this._loading$.next(!0)),(0,E.b)(120),(0,J.w)(()=>this.get_historiques()),(0,N.g)(120)).subscribe(n=>{this._mesHisto$.next(n)}),this._mesHisto$.pipe((0,E.b)(120),(0,J.w)(n=>this._search(n)),(0,N.g)(120),(0,L.b)(()=>this._loading$.next(!1))).subscribe(n=>{this._historique$.next(n.historiques),this._total$.next(n.total)}),this._search$.next()}get meshistorique$(){return this._mesHisto$.asObservable()}get historique$(){return this._historique$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get dateselected_debut(){return this._state.dateSelected_debut}get dateselected_fin(){return this._state.dateSelected_fin}set dateSelected_debut(f){this._set(null==f?{dateSelected_debut:"TOUT"}:{dateSelected_debut:f}),console.log("DATEEE: "+f)}set dateSelected_fin(f){this._set(null==f?{dateSelected_fin:"TOUT"}:{dateSelected_fin:f})}get typeselected(){return this._state.typeSelected}set typeselected(f){this._set({typeSelected:f})}get serveursselected(){return this._state.serveursSelected}set serveursselected(f){this._set({serveursSelected:f})}set OSSelected(f){this._set({OSSelected:f})}_set(f){Object.assign(this._state,f),this._search$.next()}_search(f){const{dateSelected_debut:S,dateSelected_fin:n,typeSelected:Z,serveursSelected:I}=this._state;let w=f;return w=w.filter(u=>function P(D,C,f){let S=new Date(D.date);if(S.setHours(0),"TOUT"==C&&"TOUT"==f)return!0;if("TOUT"==C&&f instanceof Date)return S.getTime()===f.getTime();if(C instanceof Date&&"TOUT"==f)return S.getTime()===C.getTime();if(C instanceof Date&&f instanceof Date)return S.getTime()>=C.getTime()&&S.getTime()<=f.getTime();throw console.error("Erreur Date type")}(u,S,n)),w.forEach(u=>{u.serveurs=u.serveurs.filter(W=>function p(D,C){let f=C.split(",");return"Tous"==f[0]||f.includes(D.type)}(W,Z))}),w.forEach(u=>{u.serveurs=u.serveurs.filter(W=>function b(D,C,f){if(0==C.length)return!0;let S=!1;return C.forEach(n=>{1==function q(D,C,f){return D.name.toLowerCase().includes(C.toLowerCase())||D.type.toLowerCase().includes(C.toLowerCase())||D.ip.toLowerCase().includes(C.toLowerCase())||D.OS.toLowerCase().includes(C.toLowerCase())||D.description.toLowerCase().includes(C.toLowerCase())||f.transform(D.kb_manquantes).includes(C)||f.transform(D.kb_failed).includes(C)||f.transform(D.kb_inconnus).includes(C)||D.date_dernier_update.toLocaleLowerCase().includes(C.toLocaleLowerCase())||D.date_last_rapport.toLowerCase().includes(C.toLowerCase())}(D,n,f)&&(S=!0)}),S}(W,I,this.pipe))}),w=w.filter(u=>u.serveurs.length>0),(0,V.of)({historiques:w,total:w.length})}get_historiques(){try{return this.http.get(this.baseURL+"servNode/historiques/"+this._state.OSSelected,{withCredentials:!0})}catch(f){throw{msg:"Erreur get_serveurs(): "+f}}}generateRapport(f,S,n,Z){try{return"Prod"==S?1==n?this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/true/"+this.majAvProdBdd.getValue()+"/"+this.majApProdBdd.getValue(),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),areaBdd:this.imgAreaBdd.getValue(),areaProdBdd:this.imgAreaProdBdd.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),barBdd:this.imgBarBdd.getValue(),barProdBdd:this.imgBarProdBdd.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/false/"+(parseInt(this.majAvProdAppli.getValue())+parseInt(this.majAvPreAppli.getValue()))+"/"+(parseInt(this.majApProdAppli.getValue())+parseInt(this.majApPreAppli.getValue())),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):1==n?this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/true/"+this.majAvRecBdd.getValue()+"/"+this.majApRecBdd.getValue(),{areaRec:this.imgAreaRec.getValue(),areaBddRec:this.imgAreaBddRec.getValue(),areaRecBddRec:this.imgAreaRecBddRec.getValue(),barRec:this.imgBarRec.getValue(),barBddRec:this.imgBarBddRec.getValue(),barRecBddRec:this.imgBarRecBddRec.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/false/"+this.majAvRecAppli.getValue()+"/"+this.majApRecAppli.getValue(),{areaRec:this.imgAreaRec.getValue(),barRec:this.imgBarRec.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0})}catch(I){throw{msg:"Erreur get_serveurs(): "+I}}}}return D.\u0275fac=function(f){return new(f||D)(e.LFG(R.JJ),e.LFG(g.eN))},D.\u0275prov=e.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();const T=[B]},1013:(ae,X,m)=>{m.d(X,{Z:()=>me});var c=m(5081),_=m(829),L=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),E_textSize=function(t,r,i){var v,a=[].concat(r),s=a.length,o=t.font,d=0;for(t.font=i.string,v=0;v<s;++v)d=Math.max(t.measureText(a[v]).width,d);return t.font=o,{height:s*i.lineHeight,width:d}};function J(t,r){var i=r.x,a=r.y;if(null===i)return{x:0,y:-1};if(null===a)return{x:1,y:0};var s=t.x-i,o=t.y-a,d=Math.sqrt(s*s+o*o);return{x:d?s/d:0,y:d?o/d:-1}}function b(t,r,i){var a=0;return t<i.left?a|=1:t>i.right&&(a|=2),r<i.top?a|=8:r>i.bottom&&(a|=4),a}function q(t,r){var s,o,i=r.anchor,a=t;return r.clamp&&(a=function P(t,r){for(var y,k,M,i=t.x0,a=t.y0,s=t.x1,o=t.y1,d=b(i,a,r),v=b(s,o,r);d|v&&!(d&v);)8&(y=d||v)?(k=i+(s-i)*(r.top-a)/(o-a),M=r.top):4&y?(k=i+(s-i)*(r.bottom-a)/(o-a),M=r.bottom):2&y?(M=a+(o-a)*(r.right-i)/(s-i),k=r.right):1&y&&(M=a+(o-a)*(r.left-i)/(s-i),k=r.left),y===d?d=b(i=k,a=M,r):v=b(s=k,o=M,r);return{x0:i,x1:s,y0:a,y1:o}}(a,r.area)),"start"===i?(s=a.x0,o=a.y0):"end"===i?(s=a.x1,o=a.y1):(s=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function N(t,r,i,a,s){switch(s){case"center":i=a=0;break;case"bottom":i=0,a=1;break;case"right":i=1,a=0;break;case"left":i=-1,a=0;break;case"top":i=0,a=-1;break;case"start":i=-i,a=-a;break;case"end":break;default:s*=Math.PI/180,i=Math.cos(s),a=Math.sin(s)}return{x:t,y:r,vx:i,vy:a}}(s,o,t.vx,t.vy,r.align)}var B={arc:function(t,r){var i=(t.startAngle+t.endAngle)/2,a=Math.cos(i),s=Math.sin(i),o=t.innerRadius,d=t.outerRadius;return q({x0:t.x+a*o,y0:t.y+s*o,x1:t.x+a*d,y1:t.y+s*d,vx:a,vy:s},r)},point:function(t,r){var i=J(t,r.origin),a=i.x*t.options.radius,s=i.y*t.options.radius;return q({x0:t.x-a,y0:t.y-s,x1:t.x+a,y1:t.y+s,vx:i.x,vy:i.y},r)},bar:function(t,r){var i=J(t,r.origin),a=t.x,s=t.y,o=0,d=0;return t.horizontal?(a=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(s=Math.min(t.y,t.base),d=Math.abs(t.base-t.y)),q({x0:a,y0:s+d,x1:a+o,y1:s,vx:i.x,vy:i.y},r)},fallback:function(t,r){var i=J(t,r.origin);return q({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},r)}},T=function(t){return Math.round(t*L)/L};function C(t,r){var i=r.chart.getDatasetMeta(r.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var a=i.getBasePixel();return t.horizontal?{x:a,y:null}:{x:null,y:a}}function f(t){return t instanceof _.qi?B.arc:t instanceof _.od?B.point:t instanceof _.ZL?B.bar:B.fallback}function I(t,r,i){var a=t.shadowBlur,s=i.stroked,o=T(i.x),d=T(i.y),v=T(i.w);s&&t.strokeText(r,o,d,v),i.filled&&(a&&s&&(t.shadowBlur=0),t.fillText(r,o,d,v),a&&s&&(t.shadowBlur=a))}var H=function(t,r,i,a){var s=this;s._config=t,s._index=a,s._model=null,s._rects=null,s._ctx=r,s._el=i};(0,c.a2)(H.prototype,{_modelize:function(t,r,i,a){var s=this,o=s._index,d=(0,c.Z)((0,c.a)([i.font,{}],a,o)),v=(0,c.a)([i.color,_.ce.color],a,o);return{align:(0,c.a)([i.align,"center"],a,o),anchor:(0,c.a)([i.anchor,"center"],a,o),area:a.chart.chartArea,backgroundColor:(0,c.a)([i.backgroundColor,null],a,o),borderColor:(0,c.a)([i.borderColor,null],a,o),borderRadius:(0,c.a)([i.borderRadius,0],a,o),borderWidth:(0,c.a)([i.borderWidth,0],a,o),clamp:(0,c.a)([i.clamp,!1],a,o),clip:(0,c.a)([i.clip,!1],a,o),color:v,display:t,font:d,lines:r,offset:(0,c.a)([i.offset,0],a,o),opacity:(0,c.a)([i.opacity,1],a,o),origin:C(s._el,a),padding:(0,c.C)((0,c.a)([i.padding,0],a,o)),positioner:f(s._el),rotation:(0,c.a)([i.rotation,0],a,o)*(Math.PI/180),size:E_textSize(s._ctx,r,d),textAlign:(0,c.a)([i.textAlign,"start"],a,o),textShadowBlur:(0,c.a)([i.textShadowBlur,0],a,o),textShadowColor:(0,c.a)([i.textShadowColor,v],a,o),textStrokeColor:(0,c.a)([i.textStrokeColor,v],a,o),textStrokeWidth:(0,c.a)([i.textStrokeWidth,0],a,o)}},update:function(t){var d,v,y,r=this,i=null,a=null,s=r._index,o=r._config,k=(0,c.a)([o.display,!0],t,s);k&&(v=(0,c.v)((0,c.O)(o.formatter,[d=t.dataset.data[s],t]),d),(y=(0,c.k)(v)?[]:function(t){var i,r=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?r.unshift.apply(r,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):(0,c.k)(t)||r.unshift(""+i);return r}(v)).length&&(a=function D(t){var r=t.borderWidth||0,i=t.padding,a=t.size.height,s=t.size.width,o=-s/2,d=-a/2;return{frame:{x:o-i.left-r,y:d-i.top-r,w:s+i.width+2*r,h:a+i.height+2*r},text:{x:o,y:d,w:s,h:a}}}(i=r._modelize(k,y,o,t)))),r._model=i,r._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,r){var d,a=t.ctx,s=this._model,o=this._rects;!this.visible()||(a.save(),s.clip&&(d=s.area,a.beginPath(),a.rect(d.left,d.top,d.right-d.left,d.bottom-d.top),a.clip()),a.globalAlpha=function(t,r,i){return Math.max(t,Math.min(r,i))}(0,s.opacity,1),a.translate(T(r.x),T(r.y)),a.rotate(s.rotation),function n(t,r,i){var a=i.backgroundColor,s=i.borderColor,o=i.borderWidth;!a&&(!s||!o)||(t.beginPath(),function S(t,r,i,a,s,o){var d=Math.PI/2;if(o){var v=Math.min(o,s/2,a/2),y=r+v,k=i+v,M=r+a-v,U=i+s-v;t.moveTo(r,k),y<M&&k<U?(t.arc(y,k,v,-Math.PI,-d),t.arc(M,k,v,-d,0),t.arc(M,U,v,0,d),t.arc(y,U,v,d,Math.PI)):y<M?(t.moveTo(y,i),t.arc(M,k,v,-d,d),t.arc(y,k,v,d,Math.PI+d)):k<U?(t.arc(y,k,v,-Math.PI,0),t.arc(y,U,v,0,Math.PI)):t.arc(y,k,v,-Math.PI,Math.PI),t.closePath(),t.moveTo(r,i)}else t.rect(r,i,a,s)}(t,T(r.x)+o/2,T(r.y)+o/2,T(r.w)-o,T(r.h)-o,i.borderRadius),t.closePath(),a&&(t.fillStyle=a,t.fill()),s&&o&&(t.strokeStyle=s,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}(a,o.frame,s),function w(t,r,i,a){var te,s=a.textAlign,o=a.color,d=!!o,v=a.font,y=r.length,k=a.textStrokeColor,M=a.textStrokeWidth,U=k&&M;if(y&&(d||U))for(i=function Z(t,r,i){var a=i.lineHeight,s=t.w,o=t.x;return"center"===r?o+=s/2:("end"===r||"right"===r)&&(o+=s),{h:a,w:s,x:o,y:t.y+a/2}}(i,s,v),t.font=v.string,t.textAlign=s,t.textBaseline="middle",t.shadowBlur=a.textShadowBlur,t.shadowColor=a.textShadowColor,d&&(t.fillStyle=o),U&&(t.lineJoin="round",t.lineWidth=M,t.strokeStyle=k),te=0,y=r.length;te<y;++te)I(t,r[te],{stroked:U,filled:d,w:i.w,x:i.x,y:i.y+i.h*te})}(a,s.lines,o.text,s),a.restore())}});var u=Number.MIN_SAFE_INTEGER||-9007199254740991,W=Number.MAX_SAFE_INTEGER||9007199254740991;function $(t,r,i){var a=Math.cos(i),s=Math.sin(i),o=r.x,d=r.y;return{x:o+a*(t.x-o)-s*(t.y-d),y:d+s*(t.x-o)+a*(t.y-d)}}function Y(t,r){var o,d,k,i=W,a=u,s=r.origin;for(o=0;o<t.length;++o)k=r.vx*((d=t[o]).x-s.x)+r.vy*(d.y-s.y),i=Math.min(i,k),a=Math.max(a,k);return{min:i,max:a}}function K(t,r){var i=r.x-t.x,a=r.y-t.y,s=Math.sqrt(i*i+a*a);return{vx:(r.x-t.x)/s,vy:(r.y-t.y)/s,origin:t,ln:s}}var z=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function G(t,r,i){var a=r.positioner(t,r),s=a.vx,o=a.vy;if(!s&&!o)return{x:a.x,y:a.y};var d=i.w,v=i.h,y=r.rotation,k=Math.abs(d/2*Math.cos(y))+Math.abs(v/2*Math.sin(y)),M=Math.abs(d/2*Math.sin(y))+Math.abs(v/2*Math.cos(y)),U=1/Math.max(Math.abs(s),Math.abs(o));return k*=s*U,M*=o*U,{x:a.x+(k+=r.offset*s),y:a.y+(M+=r.offset*o)}}(0,c.a2)(z.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,r,i){this._rotation=i,this._rect={x:r.x+t.x,y:r.y+t.y,w:r.w,h:r.h}},contains:function(t){var r=this,a=r._rect;return!((t=$(t,r.center(),-r._rotation)).x<a.x-1||t.y<a.y-1||t.x>a.x+a.w+2||t.y>a.y+a.h+2)},intersects:function(t){var s,o,d,r=this._points(),i=t._points(),a=[K(r[0],r[1]),K(r[0],r[3])];for(this._rotation!==t._rotation&&a.push(K(i[0],i[1]),K(i[0],i[3])),s=0;s<a.length;++s)if(o=Y(r,a[s]),d=Y(i,a[s]),o.max<d.min||d.max<o.min)return!1;return!0},_points:function(){var t=this,r=t._rect,i=t._rotation,a=t.center();return[$({x:r.x,y:r.y},a,i),$({x:r.x+r.w,y:r.y},a,i),$({x:r.x+r.w,y:r.y+r.h},a,i),$({x:r.x,y:r.y+r.h},a,i)]}});var A={prepare:function(t){var i,a,s,o,d,r=[];for(i=0,s=t.length;i<s;++i)for(a=0,o=t[i].length;a<o;++a)r.push(d=t[i][a]),d.$layout={_box:new z,_hidable:!1,_visible:!0,_set:i,_idx:a};return r.sort(function(v,y){var k=v.$layout,M=y.$layout;return k._idx===M._idx?M._set-k._set:M._idx-k._idx}),this.update(r),r},update:function(t){var i,a,s,o,d,r=!1;for(i=0,a=t.length;i<a;++i)o=(s=t[i]).model(),(d=s.$layout)._hidable=o&&"auto"===o.display,d._visible=s.visible(),r|=d._hidable;r&&function Q(t){var r,i,a,s,o,d,v;for(r=0,i=t.length;r<i;++r)(s=(a=t[r]).$layout)._visible&&(v=new Proxy(a._el,{get:(y,k)=>y.getProps([k],!0)[k]}),o=a.geometry(),d=G(v,a.model(),o),s._box.update(d,o,a.rotation()));(function ee(t,r){var i,a,s,o;for(i=t.length-1;i>=0;--i)for(s=t[i].$layout,a=i-1;a>=0&&s._visible;--a)(o=t[a].$layout)._visible&&s._box.intersects(o._box)&&r(s,o)})(t,function(y,k){var M=y._hidable,U=k._hidable;M&&U||U?k._visible=!1:M&&(y._visible=!1)})}(t)},lookup:function(t,r){var i,a;for(i=t.length-1;i>=0;--i)if((a=t[i].$layout)&&a._visible&&a._box.contains(r))return t[i];return null},draw:function(t,r){var i,a,s,o,d,v;for(i=0,a=r.length;i<a;++i)(o=(s=r[i]).$layout)._visible&&(d=s.geometry(),v=G(s._el,s.model(),d),o._box.update(v,d,s.rotation()),s.draw(t,v))}},h="$datalabels",x="$default";function F(t,r,i){if(r){var o,a=i.$context,s=i.$groups;!r[s._set]||(o=r[s._set][s._key])&&!0===(0,c.O)(o,[a])&&(t[h]._dirty=!0,i.update(a))}}const me={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,c.k)(t))return null;var i,a,s,r=t;if((0,c.i)(t))if((0,c.k)(t.label))if((0,c.k)(t.r))for(r="",s=0,a=(i=Object.keys(t)).length;s<a;++s)r+=(0!==s?", ":"")+i[s]+": "+t[i[s]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[h]={_actives:[]}},beforeUpdate:function(t){var r=t[h];r._listened=!1,r._listeners={},r._datasets=[],r._labels=[]},afterDatasetUpdate:function(t,r,i){var U,te,le,ue,oe,ce,se,re,a=r.index,s=t[h],o=s._datasets[a]=[],d=t.isDatasetVisible(a),v=t.data.datasets[a],y=function j(t,r){var o,d,i=t.datalabels,a={},s=[];return!1===i?null:(!0===i&&(i={}),r=(0,c.a2)({},[r,i]),o=r.labels||{},d=Object.keys(o),delete r.labels,d.length?d.forEach(function(v){o[v]&&s.push((0,c.a2)({},[r,o[v],{_key:v}]))}):s.push(r),a=s.reduce(function(v,y){return(0,c.D)(y.listeners||{},function(k,M){v[M]=v[M]||{},v[M][y._key||x]=k}),delete y.listeners,v},{}),{labels:s,listeners:a})}(v,i),k=r.meta.data||[],M=t.ctx;for(M.save(),U=0,le=k.length;U<le;++U)if((se=k[U])[h]=[],d&&se&&t.getDataVisibility(U)&&!se.skip)for(te=0,ue=y.labels.length;te<ue;++te)ce=(oe=y.labels[te])._key,(re=new H(oe,M,se,U)).$groups={_set:a,_key:ce||x},re.$context={active:!1,chart:t,dataIndex:U,dataset:v,datasetIndex:a},re.update(re.$context),se[h].push(re),o.push(re);M.restore(),(0,c.a2)(s._listeners,y.listeners,{merger:function(ne,de,fe){de[ne]=de[ne]||{},de[ne][r.index]=fe[ne],s._listened=!0}})},afterUpdate:function(t,r){t[h]._labels=A.prepare(t[h]._datasets,r)},afterDatasetsDraw:function(t){A.draw(t,t[h]._labels)},beforeEvent:function(t,r){if(t[h]._listened){var i=r.event;switch(i.type){case"mousemove":case"mouseout":!function he(t,r){var s,o,i=t[h],a=i._listeners;if(a.enter||a.leave){if("mousemove"===r.type)o=A.lookup(i._labels,r);else if("mouseout"!==r.type)return;s=i._hovered,i._hovered=o,function ie(t,r,i,a){var s,o;!i&&!a||(i?a?i!==a&&(o=s=!0):o=!0:s=!0,o&&F(t,r.leave,i),s&&F(t,r.enter,a))}(t,a,s,o)}}(t,i);break;case"click":!function _e(t,r){var i=t[h],a=i._listeners.click,s=a&&A.lookup(i._labels,r);s&&F(t,a,s)}(t,i)}}},afterEvent:function(t){var o,d,v,y,k,M,U,r=t[h],s=function(t,r){var s,o,d,v,i=t.slice(),a=[];for(s=0,d=r.length;s<d;++s)-1===(o=i.indexOf(v=r[s]))?a.push([v,1]):i.splice(o,1);for(s=0,d=i.length;s<d;++s)a.push([i[s],-1]);return a}(r._actives,r._actives=t.getActiveElements());for(o=0,d=s.length;o<d;++o)if((k=s[o])[1])for(v=0,y=(U=k[0].element[h]||[]).length;v<y;++v)(M=U[v]).$context.active=1===k[1],M.update(M.$context);(r._dirty||s.length)&&(A.update(r._labels),t.render()),delete r._dirty}}}}]);