"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[136],{3177:(ae,Q,p)=>{p.d(Q,{m:()=>J});var g=p(4274),d=p(5e3),L=p(9524),E=p(4267),W=p(3305);const N=["myAreaChart"];let J=(()=>{class S{constructor(c,f,y){this.exclusionsService=c,this.historiqueService=f,this.serv=y}ngOnInit(){}ngAfterViewInit(){let c=this.historiqueService;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new g.Z(this.myAreaChart.nativeElement,{type:"line",data:{labels:[],datasets:[{label:"Maj necessaires",borderWidth:1,tension:.3,fill:!0,backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",pointRadius:5,pointBackgroundColor:"rgba(179,0,102,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(179,0,102,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj \xe9chou\xe9es",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",pointRadius:5,pointBackgroundColor:"rgba(210,7,7,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(210,7,7,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj inconnues",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",pointRadius:5,pointBackgroundColor:"rgba(103,114,105,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(103,114,105,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj serveurs exclus",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(39,114,245,0.2)",borderColor:"rgba(39,114,245,1)",pointRadius:5,pointBackgroundColor:"rgba(39,114,245,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(39,114,245,1)",pointHitRadius:50,pointBorderWidth:2,data:[]}]},options:{scales:{xAxes:{time:{unit:"day"},grid:{display:!1},ticks:{autoSkip:!0,maxRotation:45,minRotation:45,maxTicksLimit:20}},y:{min:0,grid:{color:"rgba(0, 0, 0, .125)"}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(c.typeselected){case"Production":c.imgAreaProd.next(this.toBase64Image());break;case"Pre-production":c.imgAreaPre.next(this.toBase64Image());break;case"Recette-Formation":c.imgAreaRec.next(this.toBase64Image());break;case"BDD":c.imgAreaBdd.next(this.toBase64Image());break;case"BDD-Recette":c.imgAreaBddRec.next(this.toBase64Image());break;case"Production,BDD":case"Production,Pre-production,BDD":c.imgAreaProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":c.imgAreaRecBddRec.next(this.toBase64Image())}}}}}),this.chart.hide(2),this.exclusionsService.getExclusions().subscribe(f=>{this.serveurs_exclu=f,this.historique$.subscribe(y=>{var M,k,q,V,I,x,D,s,P,T,O,U,_,F,Z,X,Y,ee;null===(k=null===(M=this.chart.data.datasets)||void 0===M?void 0:M[0].data)||void 0===k||k.splice(0,null===(V=null===(q=this.chart.data.datasets)||void 0===q?void 0:q[0].data)||void 0===V?void 0:V.length),null===(x=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[1].data)||void 0===x||x.splice(0,null===(s=null===(D=this.chart.data.datasets)||void 0===D?void 0:D[1].data)||void 0===s?void 0:s.length),null===(T=null===(P=this.chart.data.datasets)||void 0===P?void 0:P[2].data)||void 0===T||T.splice(0,null===(U=null===(O=this.chart.data.datasets)||void 0===O?void 0:O[2].data)||void 0===U?void 0:U.length),null===(F=null===(_=this.chart.data.datasets)||void 0===_?void 0:_[3].data)||void 0===F||F.splice(0,null===(X=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[3].data)||void 0===X?void 0:X.length),null===(Y=this.chart.data.labels)||void 0===Y||Y.splice(0,null===(ee=this.chart.data.labels)||void 0===ee?void 0:ee.length);var K=0;y.forEach(te=>{var z,A,j,u,h,v,w,$,G;null===(z=this.chart.data.labels)||void 0===z||z.push(te.date);var se=0,ne=0,oe=0,le=0;console.log("TAILLE: "+te.serveurs.length),te.serveurs.forEach(t=>{se+=t.kb_inconnus,ne+=t.kb_failed,oe+=t.kb_manquantes,1==this.checkExclu(t)&&(le+=t.kb_manquantes)}),null===(j=null===(A=this.chart.data.datasets)||void 0===A?void 0:A[0].data)||void 0===j||j.push(oe),null===(h=null===(u=this.chart.data.datasets)||void 0===u?void 0:u[1].data)||void 0===h||h.push(ne),null===(w=null===(v=this.chart.data.datasets)||void 0===v?void 0:v[2].data)||void 0===w||w.push(se),null===(G=null===($=this.chart.data.datasets)||void 0===$?void 0:$[3].data)||void 0===G||G.push(le),se>=K&&(K=se),ne>=K&&(K=ne),oe>=K&&(K=oe),function e(S,b){S.options.scales.y={min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}(this.chart)}),this.chart.update()})})}checkExclu(c){return null!=this.serveurs_exclu.find(f=>f.name.match(c.fullName))}}return S.\u0275fac=function(c){return new(c||S)(d.Y36(L.z),d.Y36(E.J),d.Y36(W.t))},S.\u0275cmp=d.Xpm({type:S,selectors:[["sb-charts-area"]],viewQuery:function(c,f){if(1&c&&d.Gf(N,5),2&c){let y;d.iGM(y=d.CRH())&&(f.myAreaChart=y.first)}},decls:2,vars:0,consts:[["myAreaChart",""]],template:function(c,f){1&c&&d._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),S})()},6021:(ae,Q,p)=>{p.d(Q,{e:()=>N});var g=p(829),d=p(1013),L=p(5e3),E=p(4267);const W=["myBarChart"];let N=(()=>{class J{constructor(S){this.historiqueService=S}ngOnInit(){}ngAfterViewInit(){var S;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$;let c,b=this.historiqueService;this.chart=new g.kL(this.myBarChart.nativeElement,{type:"bar",plugins:[d.Z],data:{datasets:[]},options:{plugins:{datalabels:{color:"#236be8"}},animation:{onComplete:function(){if(null!=this.data.datasets[1])switch(b.typeselected){case"Production":b.imgBarProd.next(this.toBase64Image()),b.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),b.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":b.imgBarPre.next(this.toBase64Image()),b.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),b.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":b.imgBarRec.next(this.toBase64Image()),b.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),b.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":b.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":b.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":b.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":b.imgBarRecBddRec.next(this.toBase64Image()),b.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),b.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":b.imgBarProdBdd.next(this.toBase64Image()),b.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),b.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}),null!=this.osSelected&&(c=null===(S=this.osSelected)||void 0===S?void 0:S.split("_")),this.historique$.subscribe(f=>{var y,M,k,q,V,I,x=0;if("TOUT"!=this.historiqueService.dateselected_debut&&"TOUT"!=this.historiqueService.dateselected_fin){if(null===(y=this.chart.data.datasets)||void 0===y||y.splice(0,null===(M=this.chart.data.datasets)||void 0===M?void 0:M.length),null===(k=this.chart.data.labels)||void 0===k||k.splice(0,null===(q=this.chart.data.labels)||void 0===q?void 0:q.length),this.chart.data={labels:["Avant","Apr\xe8s"],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]},f.forEach(s=>{var P,T,O,U,_,F,Z,X,Y,ee,K,te,z=0,A=0,j=0;s.serveurs.forEach(h=>{null!=h.kb_inconnus&&(z+=h.kb_inconnus),null!=h.kb_failed&&(A+=h.kb_failed),null!=h.kb_manquantes&&(j+=h.kb_manquantes)});let u=new Date(s.date);u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),this.historiqueService.dateselected_debut instanceof Date&&u.getTime()==this.historiqueService.dateselected_debut.getTime()&&(null===(T=null===(P=this.chart.data.datasets)||void 0===P?void 0:P[0].data)||void 0===T||T.push(j),null===(U=null===(O=this.chart.data.datasets)||void 0===O?void 0:O[1].data)||void 0===U||U.push(A),null===(F=null===(_=this.chart.data.datasets)||void 0===_?void 0:_[2].data)||void 0===F||F.push(z)),this.historiqueService.dateselected_fin instanceof Date&&u.getTime()==this.historiqueService.dateselected_fin.getTime()&&(null===(X=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[0].data)||void 0===X||X.push(j),null===(ee=null===(Y=this.chart.data.datasets)||void 0===Y?void 0:Y[1].data)||void 0===ee||ee.push(A),null===(te=null===(K=this.chart.data.datasets)||void 0===K?void 0:K[2].data)||void 0===te||te.push(z)),z>=x&&(x=z),A>=x&&(x=A),j>=x&&(x=j)}),null==this.chart.options.scales){let s=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*x),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(s.typeselected){case"Production":s.imgBarProd.next(this.toBase64Image()),s.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":s.imgBarPre.next(this.toBase64Image()),s.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":s.imgBarRec.next(this.toBase64Image()),s.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":s.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":s.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":s.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":s.imgBarRecBddRec.next(this.toBase64Image()),s.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":s.imgBarProdBdd.next(this.toBase64Image()),s.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}else{null===(V=this.chart.data.datasets)||void 0===V||V.splice(0,null===(I=this.chart.data.datasets)||void 0===I?void 0:I.length),this.chart.data={labels:[],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]};var D=[];if(f.forEach(s=>{let P=new Date(s.date).toLocaleString("default",{month:"short"});this.moisInTab(D,P)||D.push({nom:P,kb_failed:0,kb_necessaire:0,kb_unkown:0,nbr_histo:0});var T=0,O=0,U=0;s.serveurs.forEach(_=>{null!=c&&c[0].includes("alco")&&c[1].includes("windows")?!(_.OS.includes("Linux")||_.OS.includes("CentOS")||_.OS.includes("VMware Photon")||_.os_quick.includes("linux"))&&_.position.includes("alco")&&(null!=_.kb_inconnus&&(T+=_.kb_inconnus),null!=_.kb_failed&&(O+=_.kb_failed),null!=_.kb_manquantes&&(U+=_.kb_manquantes)):null!=c&&c[0].includes("alco")&&c[1].includes("linux")?(_.OS.includes("Linux")||_.OS.includes("CentOS")||_.OS.includes("VMware Photon")||_.os_quick.includes("linux"))&&_.position.includes("alco")&&(null!=_.kb_inconnus&&(T+=_.kb_inconnus),null!=_.kb_failed&&(O+=_.kb_failed),null!=_.kb_manquantes&&(U+=_.kb_manquantes)):null!=c&&c[0].includes("heberge")&&c[1].includes("windows")?!(_.OS.includes("Linux")||_.OS.includes("CentOS")||_.OS.includes("VMware Photon")||_.os_quick.includes("linux"))&&_.position.includes("heberge")&&(null!=_.kb_inconnus&&(T+=_.kb_inconnus),null!=_.kb_failed&&(O+=_.kb_failed),null!=_.kb_manquantes&&(U+=_.kb_manquantes)):null!=c&&c[0].includes("heberge")&&c[1].includes("linux")?(_.OS.includes("Linux")||_.OS.includes("CentOS")||_.OS.includes("VMware Photon")||_.os_quick.includes("linux"))&&_.position.includes("heberge")&&(null!=_.kb_inconnus&&(T+=_.kb_inconnus),null!=_.kb_failed&&(O+=_.kb_failed),null!=_.kb_manquantes&&(U+=_.kb_manquantes)):(null!=_.kb_inconnus&&(T+=_.kb_inconnus),null!=_.kb_failed&&(O+=_.kb_failed),null!=_.kb_manquantes&&(U+=_.kb_manquantes))});for(let _=0;_<D.length;_++)D[_].nom==P&&(D[_].kb_failed+=O,D[_].kb_necessaire+=U,D[_].kb_unkown+=T)}),D.forEach(s=>{var P,T,O,U,_,F,Z;s.kb_failed=Math.round(s.kb_failed/(s.nbr_histo+1)),s.kb_necessaire=Math.round(s.kb_necessaire/(s.nbr_histo+1)),s.kb_unkown=Math.round(s.kb_unkown/(s.nbr_histo+1)),null===(P=this.chart.data.labels)||void 0===P||P.push(s.nom),null===(O=null===(T=this.chart.data.datasets)||void 0===T?void 0:T[0].data)||void 0===O||O.push(s.kb_necessaire),null===(_=null===(U=this.chart.data.datasets)||void 0===U?void 0:U[1].data)||void 0===_||_.push(s.kb_failed),null===(Z=null===(F=this.chart.data.datasets)||void 0===F?void 0:F[2].data)||void 0===Z||Z.push(s.kb_unkown),s.kb_unkown>=x&&(x=s.kb_unkown),s.kb_failed>=x&&(x=s.kb_failed),s.kb_necessaire>=x&&(x=s.kb_necessaire)}),null==this.chart.options.scales){let s=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*x),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(s.typeselected){case"Production":s.imgBarProd.next(this.toBase64Image()),s.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":s.imgBarPre.next(this.toBase64Image()),s.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":s.imgBarRec.next(this.toBase64Image()),s.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":s.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":s.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":s.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":s.imgBarRecBddRec.next(this.toBase64Image()),s.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":s.imgBarProdBdd.next(this.toBase64Image()),s.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),s.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}})}moisInTab(S,b){for(let c=0;c<S.length;c++)if(S[c].nom==b)return S[c].nbr_histo++,!0;return!1}}return J.\u0275fac=function(S){return new(S||J)(L.Y36(E.J))},J.\u0275cmp=L.Xpm({type:J,selectors:[["sb-charts-bar"]],viewQuery:function(S,b){if(1&S&&L.Gf(W,5),2&S){let c;L.iGM(c=L.CRH())&&(b.myBarChart=c.first)}},inputs:{osSelected:"osSelected"},decls:2,vars:0,consts:[["myBarChart",""]],template:function(S,b){1&S&&L._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),J})()},9410:(ae,Q,p)=>{p.d(Q,{y:()=>b});var g=p(829),d=p(1013),L=p(1135),E=p(5e3),W=p(3305),N=p(6952),J=p(757),e=p(4267);const S=["myPieChart"];let b=(()=>{class c{constructor(y,M,k,q){this.serveursService=y,this.route=M,this.userProfilService=k,this.historiqueService=q,this.lesServeurs=new L.X([]),this.kb_verte=0,this.kb_orange=0,this.kb_rouge=0,this.serveurs$=this.serveursService.messerveurs$,this.serveurs$.subscribe(V=>{this.lesServeurs.next(V)})}ngOnChanges(y){this.lesServeurs.next([])}ngOnInit(){var y=this.route;let M=this.historiqueService;this.userProfilService.get_user_profil().subscribe(k=>{this.chart=new g.kL(this.myPieChart.nativeElement,{type:"pie",data:{labels:["Serveurs n\xe9cessitant > "+k.serveursAlerte+" Maj","Serveurs n\xe9cessitant "+k.serveursBon+" \xe0 "+k.serveursAlerte+" Maj","Serveurs n\xe9cessitant < "+k.serveursBon+" Maj"],datasets:[{data:[],backgroundColor:["#dc3545","#ffc107","#28a745"]}]},options:{responsive:!0,aspectRatio:2,animation:{easing:"linear",onComplete:function(){null!=this.data.datasets[0].data[0]&&M.imgPie.next(this.toBase64Image())}}},plugins:[d.Z]}),this.lesServeurs.subscribe(q=>{var V;this.chart.data.datasets[0].data=[];let I,x=q.length;null!=this.osSelected&&(I=null===(V=this.osSelected)||void 0===V?void 0:V.split("_")),null!=I&&I[0].includes("alco")&&I[1].includes("windows")&&(x=0,q.forEach(s=>{!(s.OS.includes("Linux")||s.OS.includes("CentOS")||s.OS.includes("VMware Photon")||s.os_quick.includes("linux"))&&s.position.includes("alco")&&(s.kb_manquantes<k.serveursBon?this.kb_verte+=1:s.kb_manquantes>=k.serveursBon&&s.kb_manquantes<k.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=I&&I[0].includes("alco")&&I[1].includes("linux")&&(x=0,q.forEach(s=>{(s.OS.includes("Linux")||s.OS.includes("CentOS")||s.OS.includes("VMware Photon")||s.os_quick.includes("linux"))&&s.position.includes("alco")&&(s.kb_manquantes<k.serveursBon?this.kb_verte+=1:s.kb_manquantes>=k.serveursBon&&s.kb_manquantes<k.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=I&&I[0].includes("heberge")&&I[1].includes("windows")&&(x=0,q.forEach(s=>{!(s.OS.includes("Linux")||s.OS.includes("CentOS")||s.OS.includes("VMware Photon")||s.os_quick.includes("linux"))&&s.position.includes("heberge")&&(s.kb_manquantes<k.serveursBon?this.kb_verte+=1:s.kb_manquantes>=k.serveursBon&&s.kb_manquantes<k.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=I&&I[0].includes("heberge")&&I[1].includes("linux")&&(x=0,q.forEach(s=>{(s.OS.includes("Linux")||s.OS.includes("CentOS")||s.OS.includes("VMware Photon")||s.os_quick.includes("linux"))&&s.position.includes("heberge")&&(s.kb_manquantes<k.serveursBon?this.kb_verte+=1:s.kb_manquantes>=k.serveursBon&&s.kb_manquantes<k.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),this.chart.data.datasets[0].data.push(this.kb_rouge),this.chart.data.datasets[0].data.push(this.kb_orange),this.chart.data.datasets[0].data.push(this.kb_verte);let D=this.historiqueService;this.chart.options={responsive:!0,aspectRatio:2,plugins:{legend:{position:"right"},datalabels:{color:"black",font:{weight:"bold",size:16},formatter:(s,P)=>{const O=(s/x*100).toFixed(1);return s/q.length*100<8?null:`${O}%`}},tooltip:{callbacks:{label:function(s){return" "+s.formattedValue+" Serveurs, soit : "+(parseInt(s.formattedValue)/x*100).toFixed(1)+"%"}},displayColors:!1}},elements:{point:{radius:0}},onClick:function(s){y.navigate(["patchManagement/serveurs/Alco_Windows"])},animation:{easing:"linear",onComplete:function(){D.imgPie.next(this.toBase64Image())}}},this.chart.update(),this.chart.resize()})})}ngAfterViewChecked(){}}return c.\u0275fac=function(y){return new(y||c)(E.Y36(W.t),E.Y36(N.F0),E.Y36(J.gb),E.Y36(e.J))},c.\u0275cmp=E.Xpm({type:c,selectors:[["sb-charts-pie"]],viewQuery:function(y,M){if(1&y&&E.Gf(S,5),2&y){let k;E.iGM(k=E.CRH())&&(M.myPieChart=k.first)}},inputs:{osSelected:"osSelected"},features:[E.TTD],decls:2,vars:0,consts:[["myPieChart",""]],template:function(y,M){1&y&&E._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),c})()},3678:(ae,Q,p)=>{p.d(Q,{L:()=>e});var g=p(7751),d=p(5e3),L=p(4267),E=p(2382),W=p(9444);function N(S,b){if(1&S){const c=d.EpF();d.TgZ(0,"span",14),d.NdJ("mouseenter",function(){const M=d.CHM(c).$implicit;return d.oxw().hoveredDate=M})("mouseleave",function(){return d.CHM(c),d.oxw().hoveredDate=null}),d._uU(1),d.qZA()}if(2&S){const c=b.$implicit,f=b.focused,y=d.oxw();d.ekj("focused",f)("range",y.isRange(c))("faded",y.isHovered(c)||y.isInside(c)),d.xp6(1),d.hij(" ",c.day," ")}}const J=function(){return["fas","table"]};let e=(()=>{class S{constructor(c,f,y){this.calendar=c,this.formatter=f,this.historiqueService=y,this.hoveredDate=null,this.fromDate=null,this.toDate=null}onDateSelection(c){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&c&&c.after(this.fromDate)?this.toDate=c:(this.toDate=null,this.fromDate=c):this.fromDate=c}isHovered(c){return this.fromDate&&!this.toDate&&this.hoveredDate&&c.after(this.fromDate)&&c.before(this.hoveredDate)}isInside(c){return this.toDate&&c.after(this.fromDate)&&c.before(this.toDate)}isRange(c){return c.equals(this.fromDate)||this.toDate&&c.equals(this.toDate)||this.isInside(c)||this.isHovered(c)}validateInput(c,f){const y=this.formatter.parse(f);return y&&this.calendar.isValid(g.qj.from(y))?g.qj.from(y):c}eventChange(){this.historiqueService.dateSelected_debut=null==this.fromDate?null:new Date(this.fromDate.year,this.fromDate.month-1,this.fromDate.day),this.historiqueService.dateSelected_fin=null==this.toDate?null:new Date(this.toDate.year,this.toDate.month-1,this.toDate.day)}ngOnInit(){}}return S.\u0275fac=function(c){return new(c||S)(d.Y36(g.vL),d.Y36(g.NG),d.Y36(L.J))},S.\u0275cmp=d.Xpm({type:S,selectors:[["app-date-picker"]],decls:19,vars:8,consts:[[1,"form-inline"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"autoClose","displayMonths","dayTemplate","startDate","dateSelect"],["datepicker","ngbDatepicker"],["t",""],[1,"input-group","mr-2"],["placeholder","D\xe9but","name","dpFromDate",1,"form-control",3,"value","input"],["dpFromDate",""],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[1,"mr-1",3,"icon"],["placeholder","Fin","name","dpToDate",1,"form-control",3,"value","input"],["dpToDate",""],["type","button",1,"btn","btn-outline-primary","ml-2",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(c,f){if(1&c){const y=d.EpF();d.TgZ(0,"form",0)(1,"div")(2,"div",1)(3,"div",2)(4,"input",3,4),d.NdJ("dateSelect",function(k){return f.onDateSelection(k),f.eventChange()}),d.qZA(),d.YNc(6,N,2,7,"ng-template",null,5,d.W1O),d.qZA()(),d.TgZ(8,"div",6)(9,"input",7,8),d.NdJ("input",function(){d.CHM(y);const k=d.MAs(10);return f.fromDate=f.validateInput(f.fromDate,k.value)}),d.qZA(),d.TgZ(11,"button",9),d.NdJ("click",function(){return d.CHM(y),d.MAs(5).toggle()}),d._UZ(12,"fa-icon",10),d.qZA()()(),d.TgZ(13,"div")(14,"div",2)(15,"input",11,12),d.NdJ("input",function(){d.CHM(y);const k=d.MAs(16);return f.toDate=f.validateInput(f.toDate,k.value)}),d.qZA(),d.TgZ(17,"button",13),d.NdJ("click",function(){return f.fromDate=null,f.toDate=null,f.eventChange()}),d._uU(18,"Reset"),d.qZA()()()()}if(2&c){const y=d.MAs(7);d.xp6(4),d.Q6J("autoClose","outside")("displayMonths",1)("dayTemplate",y)("startDate",f.fromDate),d.xp6(5),d.Q6J("value",f.formatter.format(f.fromDate)),d.xp6(3),d.Q6J("icon",d.DdM(7,J)),d.xp6(3),d.Q6J("value",f.formatter.format(f.toDate))}},directives:[E._Y,E.JL,E.F,g.J4,W.BN],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]}),S})()},4850:(ae,Q,p)=>{p.d(Q,{p:()=>z});var g=p(7751),d=p(1135),L=p(3177),E=p(6021),W=p(9410),N=p(3678),e=p(5e3),S=p(4267),b=p(3154),c=p(6952),f=p(2382),y=p(5212),M=p(6333),k=p(9444),q=p(9808);function V(A,j){if(1&A){const u=e.EpF();e.TgZ(0,"div",24)(1,"h4",25),e._uU(2,"Generation Du Rapport"),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){return e.CHM(u).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",27)(5,"form",28)(6,"p"),e._uU(7,"Veuillez S\xe9l\xe9ctionner le nombre de jours \xe0 prendre en compte pour le rapport."),e.qZA(),e.TgZ(8,"input",29),e.NdJ("ngModelChange",function(v){return e.CHM(u),e.oxw().joursRapport=v}),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Choisissez l'environnement:"),e.qZA(),e.TgZ(11,"select",30),e.NdJ("ngModelChange",function(v){return e.CHM(u),e.oxw().environnement=v}),e.TgZ(12,"option",31),e._uU(13,"Production"),e.qZA(),e.TgZ(14,"option",32),e._uU(15,"Recette-Formation"),e.qZA()(),e.TgZ(16,"label",33)(17,"input",34),e.NdJ("ngModelChange",function(v){return e.CHM(u),e.oxw().bdd_checked=v}),e.qZA(),e._uU(18," Avec BDD "),e.qZA(),e.TgZ(19,"div")(20,"label",35),e._uU(21,"Entrez votre email"),e.qZA(),e.TgZ(22,"input",36),e.NdJ("ngModelChange",function(v){return e.CHM(u),e.oxw().email=v}),e.qZA(),e.TgZ(23,"div",37),e._uU(24," Attention email obligatoire "),e.qZA()()()(),e.TgZ(25,"div",38)(26,"button",39),e.NdJ("click",function(){return e.CHM(u).$implicit.dismiss("cancel click")}),e._uU(27,"Annuler"),e.qZA(),e.TgZ(28,"button",40),e.NdJ("click",function(){const w=e.CHM(u).$implicit,$=e.oxw();return w.close("Ok click"),$.genereRapport()}),e._uU(29,"G\xe9n\xe9rer"),e.qZA()()}if(2&A){const u=e.oxw();e.xp6(8),e.Q6J("min",1)("ngModel",u.joursRapport),e.xp6(3),e.Q6J("ngModel",u.environnement),e.xp6(6),e.Q6J("ngModel",u.bdd_checked),e.xp6(5),e.Q6J("ngModel",u.email)}}const I=function(){return["fab","windows"]};function x(A,j){if(1&A){const u=e.EpF();e.TgZ(0,"div",45)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Windows "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Production"}),e._uU(7,"Prod"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Pre-production"}),e._uU(9,"Pre-Prod"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Recette-Formation"}),e._uU(11,"Rec-Form"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="BDD"}),e._uU(13,"BDD"),e.qZA(),e.TgZ(14,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="BDD-Recette"}),e._uU(15,"BDD-Rec"),e.qZA(),e.TgZ(16,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="DMZ"}),e._uU(17,"DMZ"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,I)))}function D(A,j){if(1&A){const u=e.EpF();e.TgZ(0,"div",48)(1,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Production,Pre-production,BDD"}),e._uU(2,"Production + BDD"),e.qZA(),e.TgZ(3,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Recette-Formation,BDD-Recette"}),e._uU(4,"Rec-Form + BDD-Rec"),e.qZA()()}}const s=function(){return["fab","linux"]};function P(A,j){if(1&A){const u=e.EpF();e.TgZ(0,"div",49)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Linux "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="BDD-PRODPRE"}),e._uU(7,"BDD-ProPre"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="BDD-RECFOR"}),e._uU(9,"BDD-RECFOR"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="PROD-PRE"}),e._uU(11,"PROD-PRE"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(u),e.oxw(2).historiqueService.typeselected="REC-FOR"}),e._uU(13,"REC-FOR"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,s)))}function T(A,j){if(1&A&&(e.TgZ(0,"div",41),e.YNc(1,x,18,2,"div",42),e.YNc(2,D,5,0,"div",43),e.YNc(3,P,14,2,"div",44),e.qZA()),2&A){const u=j.ngIf;e.xp6(1),e.Q6J("ngIf","Alco_Windows"==u),e.xp6(1),e.Q6J("ngIf","Alco_Windows"==u),e.xp6(1),e.Q6J("ngIf","Alco_Linux"==u)}}function O(A,j){if(1&A&&(e.TgZ(0,"span",17),e._uU(1,"Total historiques: "),e.TgZ(2,"span",50),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&A){const u=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,u.historiqueService.total$))}}const U=function(){return["fas","xmark"]};function _(A,j){if(1&A){const u=e.EpF();e.TgZ(0,"li",51),e._uU(1),e.TgZ(2,"span",52),e.NdJ("click",function(){const w=e.CHM(u).$implicit;return e.oxw().deleteItem(w)}),e._UZ(3,"fa-icon",7),e.qZA()()}if(2&A){const u=j.$implicit;e.xp6(1),e.Oqu(u),e.xp6(2),e.Q6J("icon",e.DdM(2,U))}}function F(A,j){if(1&A&&(e.TgZ(0,"div",53)(1,"div",54),e._uU(2),e.qZA()()),2&A){const u=e.oxw();e.xp6(1),e.Udp("width",u.progress,"%"),e.xp6(1),e.hij(" ",u.progress,"% Complete ")}}function Z(A,j){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function X(A,j){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const u=j.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",u,"h")}}function Y(A,j){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function ee(A,j){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const u=j.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",u,"h")}}const K=function(){return["fas","search"]},te=function(){return["fas","chart-area"]};let z=(()=>{class A{constructor(u,h,v,w,$){this.historiqueService=u,this.horaireMajService=h,this.route=v,this.modalService=w,this.viewContainerRef=$,this.pageSize=4,this.maRecherche=Array(),this.search="",this.title="Nombres de patchs /mois",this.horaireMaj=new d.X(""),this.osSelected=new d.X("All"),this.joursRapport=1,this.loading_rapport=new d.X(!1),this.progress=0,this.environnement="Prod",this.bdd_checked=!0,this.email=""}ngOnDestroy(){this.search="",this.maRecherche.splice(0,this.maRecherche.length),this.historiqueService.serveursselected=[]}ngOnInit(){this.horaireMajService.getHoraireMaj().subscribe(u=>{console.log("horaire: "+u),this.horaireMaj.next(u)}),this.route.params.subscribe(u=>{null!=u.OSSelected&&(this.osSelected.next(u.OSSelected),this.osSelected.subscribe(h=>{this.historiqueService.OSSelected=h}))})}RemoveElementFromArray(u){this.maRecherche.forEach((h,v)=>{h==u&&this.maRecherche.splice(v,1)})}deleteItem(u){this.RemoveElementFromArray(u);var h=this.historiqueService.serveursselected;h.forEach((v,w)=>{v==u&&h.splice(w,1)}),this.historiqueService.serveursselected=h}ajout(){this.maRecherche.push(this.search);var u=this.historiqueService.serveursselected;u.push(this.search),this.historiqueService.serveursselected=u}open(u){this.modalService.open(u,{centered:!0}).result.then(h=>{this.closeResult=`Closed with: ${h}`},h=>{this.closeResult=`Dismissed ${this.getDismissReason(h)}`})}getDismissReason(u){return u===g.If.ESC?"by pressing ESC":u===g.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${u}`}genereRapport(){this.loading_rapport.next(!0);const u=new Date;u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0);const h=new Date(u);h.setDate(h.getDate()-this.joursRapport),h.setHours(0),h.setMinutes(0),h.setSeconds(0),h.setMilliseconds(0),this.historiqueService.dateSelected_fin=u,this.historiqueService.dateSelected_debut=h,this.historiqueService.imgAreaProd.next(" "),this.historiqueService.imgAreaPre.next(" "),this.historiqueService.imgAreaBdd.next(" "),this.historiqueService.imgAreaProdBdd.next(" "),this.historiqueService.imgAreaRec.next(" "),this.historiqueService.imgAreaBddRec.next(" "),this.historiqueService.imgAreaRecBddRec.next(" "),this.historiqueService.imgBarProd.next(" "),this.historiqueService.imgBarPre.next(" "),this.historiqueService.imgBarBdd.next(" "),this.historiqueService.imgBarProdBdd.next(" "),this.historiqueService.imgBarRec.next(" "),this.historiqueService.imgBarBddRec.next(" "),this.historiqueService.imgBarRecBddRec.next(" "),this.historiqueService.imgPie.next(" "),this.historiqueService.majAvProdAppli.next(" "),this.historiqueService.majApProdAppli.next(" "),this.historiqueService.majAvProdBdd.next(" "),this.historiqueService.majApProdBdd.next(" "),this.historiqueService.majAvRecAppli.next(" "),this.historiqueService.majApRecAppli.next(" "),this.historiqueService.majAvRecBdd.next(" "),this.historiqueService.majApRecBdd.next(" "),this.progress=10;const v=this.viewContainerRef.createComponent(W.y);if(v.instance.osSelected="alco_windows","Prod"==this.environnement){let w=this.historiqueService.loading$.subscribe($=>{0==$&&setTimeout(()=>{" "!=this.historiqueService.imgAreaProd.getValue()&&" "!=this.historiqueService.imgAreaPre.getValue()&&" "!=this.historiqueService.imgBarProd.getValue()&&" "!=this.historiqueService.imgBarPre.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBdd.getValue()&&" "!=this.historiqueService.imgAreaProdBdd.getValue()&&" "!=this.historiqueService.imgBarBdd.getValue()&&" "!=this.historiqueService.imgBarProdBdd.getValue()?(w.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!0,this.email).subscribe(G=>{this.progress=100,this.loading_rapport.next(!1),alert(G)})):" "==this.historiqueService.imgAreaBdd.getValue()||" "==this.historiqueService.imgBarBdd.getValue()?(this.progress=70,this.historiqueService.typeselected="BDD"):(this.progress=90,this.historiqueService.typeselected="Production,Pre-production,BDD"):(this.progress=75,w.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!1,this.email).subscribe(G=>{this.progress=100,this.loading_rapport.next(!1),alert(G)})):" "==this.historiqueService.imgAreaProd.getValue()||" "==this.historiqueService.imgBarProd.getValue()?(this.progress=25,this.historiqueService.typeselected="Production"):(" "==this.historiqueService.imgAreaPre.getValue()||" "==this.historiqueService.imgBarPre.getValue())&&(this.progress=40,this.historiqueService.typeselected="Pre-production")},1e4)})}else if("Rec"==this.environnement){let w=this.historiqueService.loading$.subscribe($=>{0==$&&setTimeout(()=>{" "!=this.historiqueService.imgAreaRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBddRec.getValue()&&" "!=this.historiqueService.imgAreaRecBddRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()&&" "!=this.historiqueService.imgBarRecBddRec.getValue()?(w.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!0,this.email).subscribe(G=>{this.progress=100,this.loading_rapport.next(!1),alert(G)})):" "==this.historiqueService.imgAreaBddRec.getValue()||" "==this.historiqueService.imgBarRec.getValue()?(this.progress=50,this.historiqueService.typeselected="BDD-Recette"):(this.progress=70,this.historiqueService.typeselected="Recette-Formation,BDD-Recette"):(this.progress=80,w.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!1,this.email).subscribe(G=>{this.progress=100,this.loading_rapport.next(!1),alert(G)})):(" "==this.historiqueService.imgAreaRec.getValue()||" "==this.historiqueService.imgBarRec.getValue())&&(this.progress=25,this.historiqueService.typeselected="Recette-Formation")},1e4)})}}}return A.\u0275fac=function(u){return new(u||A)(e.Y36(S.J),e.Y36(b.w),e.Y36(c.gz),e.Y36(g.FF),e.Y36(e.s_b))},A.\u0275cmp=e.Xpm({type:A,selectors:[["app-historique"]],inputs:{pageSize:"pageSize"},decls:54,vars:31,consts:[["content",""],["title","Historique",3,"hideBreadcrumbs"],[1,"card-body"],[1,"form-group","form-inline"],["type","text","name","searchTerm",1,"form-control","ml-1","col-1",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],["class","ml-2 btn-toolbar","role","toolbar","aria-label","Toolbar with button groups",4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3","list-group","list-group-horizontal"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","progress",4,"ngIf"],[1,"row"],[1,"col-lg-6"],[1,"card-header","form-inline"],[1,"mr-1",3,"icon"],[1,"ml-3"],["class","progress ml-1",4,"ngIf"],[1,"card-footer","small","text-muted","d-flex","d-flex","justify-content-between"],["class","ml-auto",4,"ngIf"],["id","#title"],[1,"ml-0",2,"visibility","hidden"],[1,"card-footer","small","text-muted","d-flex","mb-0"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",1,"needs-validation"],["type","number","name","input-jour",1,"form-control","ml-1",3,"min","ngModel","ngModelChange"],["name","select_env",1,"browser-default","custom-select",3,"ngModel","ngModelChange"],["value","Prod"],["value","Rec"],[1,"form-check-label","mt-1"],["type","checkbox","value","bdd_checked","name","check_bdd","checked","",3,"ngModel","ngModelChange"],["for","form9"],["type","email","id","exampleInputEmail1","aria-describedby","emailHelp","placeholder","Enter email","name","email","required","",1,"form-control","is-invalid",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["class","btn-group me-2","role","group","aria-label","First group",4,"ngIf"],["class","btn-group me-2 ml-1","role","group","aria-label","Second group",4,"ngIf"],["class","btn-group me-2 ml-2","role","group","aria-label","Third group",4,"ngIf"],["role","group","aria-label","First group",1,"btn-group","me-2"],[1,"btn"],["type","button",1,"btn","btn-outline-info","button_perso",3,"click"],["role","group","aria-label","Second group",1,"btn-group","me-2","ml-1"],["role","group","aria-label","Third group",1,"btn-group","me-2","ml-2"],[1,"font-weight-bold"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ml-3",3,"click"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-success"],[1,"progress","ml-1"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","100%"],[1,"ml-auto"]],template:function(u,h){if(1&u){const v=e.EpF();e.YNc(0,V,30,5,"ng-template",null,0,e.W1O),e._UZ(2,"sb-dashboard-head",1),e.TgZ(3,"sb-card")(4,"div",2)(5,"form")(6,"div",3),e._uU(7,"Recherche: "),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function($){return h.search=$}),e.qZA(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return h.ajout()}),e._UZ(11,"fa-icon",7),e.qZA()(),e.YNc(12,T,4,3,"div",8),e.ALo(13,"async"),e.YNc(14,O,5,3,"span",9),e.ALo(15,"async"),e.TgZ(16,"ul",10),e.YNc(17,_,4,3,"li",11),e.qZA(),e.TgZ(18,"button",6),e.NdJ("click",function(){e.CHM(v);const $=e.MAs(1);return h.open($)}),e._uU(19,"G\xe9n\xe9rer rapport"),e.qZA()()(),e.YNc(20,F,3,3,"div",12),e.ALo(21,"async"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"sb-card")(25,"div",15),e._UZ(26,"fa-icon",16),e.TgZ(27,"span"),e._uU(28,"Intervalle: "),e.qZA(),e._UZ(29,"app-date-picker",17),e.qZA(),e.TgZ(30,"div",2),e.YNc(31,Z,3,0,"div",18),e.ALo(32,"async"),e._UZ(33,"sb-charts-area"),e.qZA(),e.TgZ(34,"div",19),e._uU(35,"Mise \xe0 jour /jour "),e.YNc(36,X,2,1,"p",20),e.ALo(37,"async"),e.qZA()()(),e.TgZ(38,"div",14)(39,"sb-card")(40,"div",15),e._UZ(41,"fa-icon",16),e.TgZ(42,"span",21),e._uU(43),e.qZA(),e._UZ(44,"app-date-picker",22),e.qZA(),e.TgZ(45,"div",2),e.YNc(46,Y,3,0,"div",18),e.ALo(47,"async"),e._UZ(48,"sb-charts-bar"),e.qZA(),e.TgZ(49,"div",23)(50,"p"),e._uU(51,"Mise \xe0 jour /mois (moyenne)"),e.qZA(),e.YNc(52,ee,2,1,"p",20),e.ALo(53,"async"),e.qZA()()()()}2&u&&(e.xp6(2),e.Q6J("hideBreadcrumbs",!1),e.xp6(6),e.Q6J("ngModel",h.search),e.xp6(3),e.Q6J("icon",e.DdM(28,K)),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,14,h.osSelected)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,16,h.historiqueService.total$)),e.xp6(3),e.Q6J("ngForOf",h.maRecherche),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,18,h.loading_rapport)),e.xp6(6),e.Q6J("icon",e.DdM(29,te)),e.xp6(5),e.Q6J("ngIf",e.lcZ(32,20,h.historiqueService.loading$)),e.xp6(5),e.Q6J("ngIf",e.lcZ(37,22,h.horaireMaj)),e.xp6(5),e.Q6J("icon",e.DdM(30,te)),e.xp6(2),e.Oqu(h.title),e.xp6(3),e.Q6J("ngIf",e.lcZ(47,24,h.historiqueService.loading$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(53,26,h.horaireMaj)))},directives:[f._Y,f.JL,f.F,f.qQ,f.wV,f.Fj,f.JJ,f.On,f.EJ,f.YN,f.Kr,f.Wl,f.Q7,y.T,M.A,k.BN,q.O5,q.sg,N.L,L.m,E.e],pipes:[q.Ov],styles:[".button_perso[_ngcontent-%COMP%]:focus{color:#fff;background-color:#17a2b8;box-shadow:none}.button_perso[_ngcontent-%COMP%]{border:.5px solid #17a2b8!important}"],changeDetection:0}),A})()},9136:(ae,Q,p)=>{p.d(Q,{e:()=>y});var g=p(9808),d=p(6952),L=p(2382),E=p(2539),W=p(5592),N=p(4267),J=p(5e3);p(4850),p(3177),p(6021),p(9410),p(3678);let y=(()=>{class M{}return M.\u0275fac=function(q){return new(q||M)},M.\u0275mod=J.oAB({type:M}),M.\u0275inj=J.cJS({providers:[g.JJ,...N.u],imports:[[g.ez,d.Bz,L.UX,L.u5,E.n,W.A]]}),M})()},4267:(ae,Q,p)=>{p.d(Q,{J:()=>V,u:()=>I});var g=p(520),d=p(1135),L=p(7579),E=p(8505),W=p(8372),N=p(3900),J=p(4825),e=p(9646),S=p(1438),b=p(5e3),c=p(9808);const f={headers:new g.WM({"Access-Control-Allow-Methods":"GET,POST,PUT,DELETE","Access-Control-Allow-Headers":"Content-type","Content-Type":"application/json","Access-Control-Allow-Origin":"*"}),withCredentials:!0};let V=(()=>{class x{constructor(s,P){this.pipe=s,this.http=P,this._loading$=new d.X(!0),this._search$=new L.x,this._mesHisto$=new L.x,this._historique$=new d.X([]),this._total$=new d.X(0),this.imgAreaProd=new d.X(""),this.imgAreaPre=new d.X(""),this.imgAreaBdd=new d.X(""),this.imgAreaProdBdd=new d.X(""),this.imgAreaRec=new d.X(""),this.imgAreaBddRec=new d.X(""),this.imgAreaRecBddRec=new d.X(""),this.imgBarProd=new d.X(""),this.imgBarPre=new d.X(""),this.imgBarBdd=new d.X(""),this.imgBarProdBdd=new d.X(""),this.imgBarRec=new d.X(""),this.imgBarBddRec=new d.X(""),this.imgBarRecBddRec=new d.X(""),this.imgPie=new d.X(""),this.majAvProdAppli=new d.X(""),this.majApProdAppli=new d.X(""),this.majAvPreAppli=new d.X(""),this.majApPreAppli=new d.X(""),this.majAvProdBdd=new d.X(""),this.majApProdBdd=new d.X(""),this.majAvRecAppli=new d.X(""),this.majApRecAppli=new d.X(""),this.majAvRecBdd=new d.X(""),this.majApRecBdd=new d.X(""),this.baseURL="https://"+S.F+"/",this._state={dateSelected_debut:"TOUT",dateSelected_fin:"TOUT",typeSelected:"Tous",serveursSelected:[],OSSelected:"Alco_Windows"},this._search$.pipe((0,E.b)(()=>this._loading$.next(!0)),(0,W.b)(120),(0,N.w)(()=>this.get_historiques()),(0,J.g)(120)).subscribe(T=>{this._mesHisto$.next(T)}),this._mesHisto$.pipe((0,W.b)(120),(0,N.w)(T=>this._search(T)),(0,J.g)(120),(0,E.b)(()=>this._loading$.next(!1))).subscribe(T=>{this._historique$.next(T.historiques),this._total$.next(T.total)}),this._search$.next()}get meshistorique$(){return this._mesHisto$.asObservable()}get historique$(){return this._historique$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get dateselected_debut(){return this._state.dateSelected_debut}get dateselected_fin(){return this._state.dateSelected_fin}set dateSelected_debut(s){this._set(null==s?{dateSelected_debut:"TOUT"}:{dateSelected_debut:s}),console.log("DATEEE: "+s)}set dateSelected_fin(s){this._set(null==s?{dateSelected_fin:"TOUT"}:{dateSelected_fin:s})}get typeselected(){return this._state.typeSelected}set typeselected(s){this._set({typeSelected:s})}get serveursselected(){return this._state.serveursSelected}set serveursselected(s){this._set({serveursSelected:s})}set OSSelected(s){this._set({OSSelected:s})}_set(s){Object.assign(this._state,s),this._search$.next()}_search(s){const{dateSelected_debut:P,dateSelected_fin:T,typeSelected:O,serveursSelected:U}=this._state;let _=s;return _=_.filter(Z=>function k(x,D,s){let P=new Date(x.date);if(P.setHours(0),"TOUT"==D&&"TOUT"==s)return!0;if("TOUT"==D&&s instanceof Date)return P.getTime()===s.getTime();if(D instanceof Date&&"TOUT"==s)return P.getTime()===D.getTime();if(D instanceof Date&&s instanceof Date)return P.getTime()>=D.getTime()&&P.getTime()<=s.getTime();throw console.error("Erreur Date type")}(Z,P,T)),_.forEach(Z=>{Z.serveurs=Z.serveurs.filter(X=>function y(x,D){let s=D.split(",");return"Tous"==s[0]||s.includes(x.type)}(X,O))}),_.forEach(Z=>{Z.serveurs=Z.serveurs.filter(X=>function M(x,D,s){if(0==D.length)return!0;let P=!1;return D.forEach(T=>{1==function q(x,D,s){return x.name.toLowerCase().includes(D.toLowerCase())||x.type.toLowerCase().includes(D.toLowerCase())||x.ip.toLowerCase().includes(D.toLowerCase())||x.OS.toLowerCase().includes(D.toLowerCase())||x.description.toLowerCase().includes(D.toLowerCase())||s.transform(x.kb_manquantes).includes(D)||s.transform(x.kb_failed).includes(D)||s.transform(x.kb_inconnus).includes(D)||x.date_dernier_update.toLocaleLowerCase().includes(D.toLocaleLowerCase())||x.date_last_rapport.toLowerCase().includes(D.toLowerCase())}(x,T,s)&&(P=!0)}),P}(X,U,this.pipe))}),_=_.filter(Z=>Z.serveurs.length>0),(0,e.of)({historiques:_,total:_.length})}get_historiques(){try{return this.http.get(this.baseURL+"servNode/historiques/"+this._state.OSSelected,f)}catch(s){throw{msg:"Erreur get_serveurs(): "+s}}}generateRapport(s,P,T,O){try{return"Prod"==P?1==T?this.http.put(this.baseURL+"servNode/historiques_rapport/"+P+"/"+O+"/true/"+this.majAvProdBdd.getValue()+"/"+this.majApProdBdd.getValue(),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),areaBdd:this.imgAreaBdd.getValue(),areaProdBdd:this.imgAreaProdBdd.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),barBdd:this.imgBarBdd.getValue(),barProdBdd:this.imgBarProdBdd.getValue(),pie:this.imgPie.getValue()},f):this.http.put(this.baseURL+"servNode/historiques_rapport/"+P+"/"+O+"/false/"+(parseInt(this.majAvProdAppli.getValue())+parseInt(this.majAvPreAppli.getValue()))+"/"+(parseInt(this.majApProdAppli.getValue())+parseInt(this.majApPreAppli.getValue())),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),pie:this.imgPie.getValue()},f):1==T?this.http.put(this.baseURL+"servNode/historiques_rapport/"+P+"/"+O+"/true/"+this.majAvRecBdd.getValue()+"/"+this.majApRecBdd.getValue(),{areaRec:this.imgAreaRec.getValue(),areaBddRec:this.imgAreaBddRec.getValue(),areaRecBddRec:this.imgAreaRecBddRec.getValue(),barRec:this.imgBarRec.getValue(),barBddRec:this.imgBarBddRec.getValue(),barRecBddRec:this.imgBarRecBddRec.getValue(),pie:this.imgPie.getValue()},f):this.http.put(this.baseURL+"servNode/historiques_rapport/"+P+"/"+O+"/false/"+this.majAvRecAppli.getValue()+"/"+this.majApRecAppli.getValue(),{areaRec:this.imgAreaRec.getValue(),barRec:this.imgBarRec.getValue(),pie:this.imgPie.getValue()},f)}catch(U){throw{msg:"Erreur get_serveurs(): "+U}}}}return x.\u0275fac=function(s){return new(s||x)(b.LFG(c.JJ),b.LFG(g.eN))},x.\u0275prov=b.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})();const I=[V]},1013:(ae,Q,p)=>{p.d(Q,{Z:()=>le});var g=p(5081),d=p(829),L=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),E_textSize=function(t,r,i){var m,a=[].concat(r),n=a.length,o=t.font,l=0;for(t.font=i.string,m=0;m<n;++m)l=Math.max(t.measureText(a[m]).width,l);return t.font=o,{height:n*i.lineHeight,width:l}};function W(t,r){var i=r.x,a=r.y;if(null===i)return{x:0,y:-1};if(null===a)return{x:1,y:0};var n=t.x-i,o=t.y-a,l=Math.sqrt(n*n+o*o);return{x:l?n/l:0,y:l?o/l:-1}}function f(t,r,i){var a=0;return t<i.left?a|=1:t>i.right&&(a|=2),r<i.top?a|=8:r>i.bottom&&(a|=4),a}function M(t,r){var n,o,i=r.anchor,a=t;return r.clamp&&(a=function y(t,r){for(var B,C,R,i=t.x0,a=t.y0,n=t.x1,o=t.y1,l=f(i,a,r),m=f(n,o,r);l|m&&!(l&m);)8&(B=l||m)?(C=i+(n-i)*(r.top-a)/(o-a),R=r.top):4&B?(C=i+(n-i)*(r.bottom-a)/(o-a),R=r.bottom):2&B?(R=a+(o-a)*(r.right-i)/(n-i),C=r.right):1&B&&(R=a+(o-a)*(r.left-i)/(n-i),C=r.left),B===l?l=f(i=C,a=R,r):m=f(n=C,o=R,r);return{x0:i,x1:n,y0:a,y1:o}}(a,r.area)),"start"===i?(n=a.x0,o=a.y0):"end"===i?(n=a.x1,o=a.y1):(n=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function N(t,r,i,a,n){switch(n){case"center":i=a=0;break;case"bottom":i=0,a=1;break;case"right":i=1,a=0;break;case"left":i=-1,a=0;break;case"top":i=0,a=-1;break;case"start":i=-i,a=-a;break;case"end":break;default:n*=Math.PI/180,i=Math.cos(n),a=Math.sin(n)}return{x:t,y:r,vx:i,vy:a}}(n,o,t.vx,t.vy,r.align)}var k={arc:function(t,r){var i=(t.startAngle+t.endAngle)/2,a=Math.cos(i),n=Math.sin(i),o=t.innerRadius,l=t.outerRadius;return M({x0:t.x+a*o,y0:t.y+n*o,x1:t.x+a*l,y1:t.y+n*l,vx:a,vy:n},r)},point:function(t,r){var i=W(t,r.origin),a=i.x*t.options.radius,n=i.y*t.options.radius;return M({x0:t.x-a,y0:t.y-n,x1:t.x+a,y1:t.y+n,vx:i.x,vy:i.y},r)},bar:function(t,r){var i=W(t,r.origin),a=t.x,n=t.y,o=0,l=0;return t.horizontal?(a=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(n=Math.min(t.y,t.base),l=Math.abs(t.base-t.y)),M({x0:a,y0:n+l,x1:a+o,y1:n,vx:i.x,vy:i.y},r)},fallback:function(t,r){var i=W(t,r.origin);return M({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},r)}},q=function(t){return Math.round(t*L)/L};function I(t,r){var i=r.chart.getDatasetMeta(r.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var a=i.getBasePixel();return t.horizontal?{x:a,y:null}:{x:null,y:a}}function x(t){return t instanceof d.qi?k.arc:t instanceof d.od?k.point:t instanceof d.ZL?k.bar:k.fallback}function T(t,r,i){var a=t.shadowBlur,n=i.stroked,o=q(i.x),l=q(i.y),m=q(i.w);n&&t.strokeText(r,o,l,m),i.filled&&(a&&n&&(t.shadowBlur=0),t.fillText(r,o,l,m),a&&n&&(t.shadowBlur=a))}var U=function(t,r,i,a){var n=this;n._config=t,n._index=a,n._model=null,n._rects=null,n._ctx=r,n._el=i};(0,g.a2)(U.prototype,{_modelize:function(t,r,i,a){var n=this,o=n._index,l=(0,g.Z)((0,g.a)([i.font,{}],a,o)),m=(0,g.a)([i.color,d.ce.color],a,o);return{align:(0,g.a)([i.align,"center"],a,o),anchor:(0,g.a)([i.anchor,"center"],a,o),area:a.chart.chartArea,backgroundColor:(0,g.a)([i.backgroundColor,null],a,o),borderColor:(0,g.a)([i.borderColor,null],a,o),borderRadius:(0,g.a)([i.borderRadius,0],a,o),borderWidth:(0,g.a)([i.borderWidth,0],a,o),clamp:(0,g.a)([i.clamp,!1],a,o),clip:(0,g.a)([i.clip,!1],a,o),color:m,display:t,font:l,lines:r,offset:(0,g.a)([i.offset,0],a,o),opacity:(0,g.a)([i.opacity,1],a,o),origin:I(n._el,a),padding:(0,g.C)((0,g.a)([i.padding,0],a,o)),positioner:x(n._el),rotation:(0,g.a)([i.rotation,0],a,o)*(Math.PI/180),size:E_textSize(n._ctx,r,l),textAlign:(0,g.a)([i.textAlign,"start"],a,o),textShadowBlur:(0,g.a)([i.textShadowBlur,0],a,o),textShadowColor:(0,g.a)([i.textShadowColor,m],a,o),textStrokeColor:(0,g.a)([i.textStrokeColor,m],a,o),textStrokeWidth:(0,g.a)([i.textStrokeWidth,0],a,o)}},update:function(t){var l,m,B,r=this,i=null,a=null,n=r._index,o=r._config,C=(0,g.a)([o.display,!0],t,n);C&&(m=(0,g.v)((0,g.O)(o.formatter,[l=t.dataset.data[n],t]),l),(B=(0,g.k)(m)?[]:function(t){var i,r=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?r.unshift.apply(r,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):(0,g.k)(t)||r.unshift(""+i);return r}(m)).length&&(a=function V(t){var r=t.borderWidth||0,i=t.padding,a=t.size.height,n=t.size.width,o=-n/2,l=-a/2;return{frame:{x:o-i.left-r,y:l-i.top-r,w:n+i.width+2*r,h:a+i.height+2*r},text:{x:o,y:l,w:n,h:a}}}(i=r._modelize(C,B,o,t)))),r._model=i,r._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,r){var l,a=t.ctx,n=this._model,o=this._rects;!this.visible()||(a.save(),n.clip&&(l=n.area,a.beginPath(),a.rect(l.left,l.top,l.right-l.left,l.bottom-l.top),a.clip()),a.globalAlpha=function(t,r,i){return Math.max(t,Math.min(r,i))}(0,n.opacity,1),a.translate(q(r.x),q(r.y)),a.rotate(n.rotation),function s(t,r,i){var a=i.backgroundColor,n=i.borderColor,o=i.borderWidth;!a&&(!n||!o)||(t.beginPath(),function D(t,r,i,a,n,o){var l=Math.PI/2;if(o){var m=Math.min(o,n/2,a/2),B=r+m,C=i+m,R=r+a-m,H=i+n-m;t.moveTo(r,C),B<R&&C<H?(t.arc(B,C,m,-Math.PI,-l),t.arc(R,C,m,-l,0),t.arc(R,H,m,0,l),t.arc(B,H,m,l,Math.PI)):B<R?(t.moveTo(B,i),t.arc(R,C,m,-l,l),t.arc(B,C,m,l,Math.PI+l)):C<H?(t.arc(B,C,m,-Math.PI,0),t.arc(B,H,m,0,Math.PI)):t.arc(B,C,m,-Math.PI,Math.PI),t.closePath(),t.moveTo(r,i)}else t.rect(r,i,a,n)}(t,q(r.x)+o/2,q(r.y)+o/2,q(r.w)-o,q(r.h)-o,i.borderRadius),t.closePath(),a&&(t.fillStyle=a,t.fill()),n&&o&&(t.strokeStyle=n,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}(a,o.frame,n),function O(t,r,i,a){var ie,n=a.textAlign,o=a.color,l=!!o,m=a.font,B=r.length,C=a.textStrokeColor,R=a.textStrokeWidth,H=C&&R;if(B&&(l||H))for(i=function P(t,r,i){var a=i.lineHeight,n=t.w,o=t.x;return"center"===r?o+=n/2:("end"===r||"right"===r)&&(o+=n),{h:a,w:n,x:o,y:t.y+a/2}}(i,n,m),t.font=m.string,t.textAlign=n,t.textBaseline="middle",t.shadowBlur=a.textShadowBlur,t.shadowColor=a.textShadowColor,l&&(t.fillStyle=o),H&&(t.lineJoin="round",t.lineWidth=R,t.strokeStyle=C),ie=0,B=r.length;ie<B;++ie)T(t,r[ie],{stroked:H,filled:l,w:i.w,x:i.x,y:i.y+i.h*ie})}(a,n.lines,o.text,n),a.restore())}});var _=Number.MIN_SAFE_INTEGER||-9007199254740991,F=Number.MAX_SAFE_INTEGER||9007199254740991;function Z(t,r,i){var a=Math.cos(i),n=Math.sin(i),o=r.x,l=r.y;return{x:o+a*(t.x-o)-n*(t.y-l),y:l+n*(t.x-o)+a*(t.y-l)}}function X(t,r){var o,l,C,i=F,a=_,n=r.origin;for(o=0;o<t.length;++o)C=r.vx*((l=t[o]).x-n.x)+r.vy*(l.y-n.y),i=Math.min(i,C),a=Math.max(a,C);return{min:i,max:a}}function Y(t,r){var i=r.x-t.x,a=r.y-t.y,n=Math.sqrt(i*i+a*a);return{vx:(r.x-t.x)/n,vy:(r.y-t.y)/n,origin:t,ln:n}}var ee=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function K(t,r,i){var a=r.positioner(t,r),n=a.vx,o=a.vy;if(!n&&!o)return{x:a.x,y:a.y};var l=i.w,m=i.h,B=r.rotation,C=Math.abs(l/2*Math.cos(B))+Math.abs(m/2*Math.sin(B)),R=Math.abs(l/2*Math.sin(B))+Math.abs(m/2*Math.cos(B)),H=1/Math.max(Math.abs(n),Math.abs(o));return C*=n*H,R*=o*H,{x:a.x+(C+=r.offset*n),y:a.y+(R+=r.offset*o)}}(0,g.a2)(ee.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,r,i){this._rotation=i,this._rect={x:r.x+t.x,y:r.y+t.y,w:r.w,h:r.h}},contains:function(t){var r=this,a=r._rect;return!((t=Z(t,r.center(),-r._rotation)).x<a.x-1||t.y<a.y-1||t.x>a.x+a.w+2||t.y>a.y+a.h+2)},intersects:function(t){var n,o,l,r=this._points(),i=t._points(),a=[Y(r[0],r[1]),Y(r[0],r[3])];for(this._rotation!==t._rotation&&a.push(Y(i[0],i[1]),Y(i[0],i[3])),n=0;n<a.length;++n)if(o=X(r,a[n]),l=X(i,a[n]),o.max<l.min||l.max<o.min)return!1;return!0},_points:function(){var t=this,r=t._rect,i=t._rotation,a=t.center();return[Z({x:r.x,y:r.y},a,i),Z({x:r.x+r.w,y:r.y},a,i),Z({x:r.x+r.w,y:r.y+r.h},a,i),Z({x:r.x,y:r.y+r.h},a,i)]}});var A={prepare:function(t){var i,a,n,o,l,r=[];for(i=0,n=t.length;i<n;++i)for(a=0,o=t[i].length;a<o;++a)r.push(l=t[i][a]),l.$layout={_box:new ee,_hidable:!1,_visible:!0,_set:i,_idx:a};return r.sort(function(m,B){var C=m.$layout,R=B.$layout;return C._idx===R._idx?R._set-C._set:R._idx-C._idx}),this.update(r),r},update:function(t){var i,a,n,o,l,r=!1;for(i=0,a=t.length;i<a;++i)o=(n=t[i]).model(),(l=n.$layout)._hidable=o&&"auto"===o.display,l._visible=n.visible(),r|=l._hidable;r&&function z(t){var r,i,a,n,o,l,m;for(r=0,i=t.length;r<i;++r)(n=(a=t[r]).$layout)._visible&&(m=new Proxy(a._el,{get:(B,C)=>B.getProps([C],!0)[C]}),o=a.geometry(),l=K(m,a.model(),o),n._box.update(l,o,a.rotation()));(function te(t,r){var i,a,n,o;for(i=t.length-1;i>=0;--i)for(n=t[i].$layout,a=i-1;a>=0&&n._visible;--a)(o=t[a].$layout)._visible&&n._box.intersects(o._box)&&r(n,o)})(t,function(B,C){var R=B._hidable,H=C._hidable;R&&H||H?C._visible=!1:R&&(B._visible=!1)})}(t)},lookup:function(t,r){var i,a;for(i=t.length-1;i>=0;--i)if((a=t[i].$layout)&&a._visible&&a._box.contains(r))return t[i];return null},draw:function(t,r){var i,a,n,o,l,m;for(i=0,a=r.length;i<a;++i)(o=(n=r[i]).$layout)._visible&&(l=n.geometry(),m=K(n._el,n.model(),l),o._box.update(m,l,n.rotation()),n.draw(t,m))}},h="$datalabels",v="$default";function $(t,r,i){if(r){var o,a=i.$context,n=i.$groups;!r[n._set]||(o=r[n._set][n._key])&&!0===(0,g.O)(o,[a])&&(t[h]._dirty=!0,i.update(a))}}const le={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,g.k)(t))return null;var i,a,n,r=t;if((0,g.i)(t))if((0,g.k)(t.label))if((0,g.k)(t.r))for(r="",n=0,a=(i=Object.keys(t)).length;n<a;++n)r+=(0!==n?", ":"")+i[n]+": "+t[i[n]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[h]={_actives:[]}},beforeUpdate:function(t){var r=t[h];r._listened=!1,r._listeners={},r._datasets=[],r._labels=[]},afterDatasetUpdate:function(t,r,i){var H,ie,_e,pe,ce,me,de,re,a=r.index,n=t[h],o=n._datasets[a]=[],l=t.isDatasetVisible(a),m=t.data.datasets[a],B=function w(t,r){var o,l,i=t.datalabels,a={},n=[];return!1===i?null:(!0===i&&(i={}),r=(0,g.a2)({},[r,i]),o=r.labels||{},l=Object.keys(o),delete r.labels,l.length?l.forEach(function(m){o[m]&&n.push((0,g.a2)({},[r,o[m],{_key:m}]))}):n.push(r),a=n.reduce(function(m,B){return(0,g.D)(B.listeners||{},function(C,R){m[R]=m[R]||{},m[R][B._key||v]=C}),delete B.listeners,m},{}),{labels:n,listeners:a})}(m,i),C=r.meta.data||[],R=t.ctx;for(R.save(),H=0,_e=C.length;H<_e;++H)if((de=C[H])[h]=[],l&&de&&t.getDataVisibility(H)&&!de.skip)for(ie=0,pe=B.labels.length;ie<pe;++ie)me=(ce=B.labels[ie])._key,(re=new U(ce,R,de,H)).$groups={_set:a,_key:me||v},re.$context={active:!1,chart:t,dataIndex:H,dataset:m,datasetIndex:a},re.update(re.$context),de[h].push(re),o.push(re);R.restore(),(0,g.a2)(n._listeners,B.listeners,{merger:function(ue,he,fe){he[ue]=he[ue]||{},he[ue][r.index]=fe[ue],n._listened=!0}})},afterUpdate:function(t,r){t[h]._labels=A.prepare(t[h]._datasets,r)},afterDatasetsDraw:function(t){A.draw(t,t[h]._labels)},beforeEvent:function(t,r){if(t[h]._listened){var i=r.event;switch(i.type){case"mousemove":case"mouseout":!function se(t,r){var n,o,i=t[h],a=i._listeners;if(a.enter||a.leave){if("mousemove"===r.type)o=A.lookup(i._labels,r);else if("mouseout"!==r.type)return;n=i._hovered,i._hovered=o,function G(t,r,i,a){var n,o;!i&&!a||(i?a?i!==a&&(o=n=!0):o=!0:n=!0,o&&$(t,r.leave,i),n&&$(t,r.enter,a))}(t,a,n,o)}}(t,i);break;case"click":!function ne(t,r){var i=t[h],a=i._listeners.click,n=a&&A.lookup(i._labels,r);n&&$(t,a,n)}(t,i)}}},afterEvent:function(t){var o,l,m,B,C,R,H,r=t[h],n=function(t,r){var n,o,l,m,i=t.slice(),a=[];for(n=0,l=r.length;n<l;++n)-1===(o=i.indexOf(m=r[n]))?a.push([m,1]):i.splice(o,1);for(n=0,l=i.length;n<l;++n)a.push([i[n],-1]);return a}(r._actives,r._actives=t.getActiveElements());for(o=0,l=n.length;o<l;++o)if((C=n[o])[1])for(m=0,B=(H=C[0].element[h]||[]).length;m<B;++m)(R=H[m]).$context.active=1===C[1],R.update(R.$context);(r._dirty||n.length)&&(A.update(r._labels),t.render()),delete r._dirty}}}}]);