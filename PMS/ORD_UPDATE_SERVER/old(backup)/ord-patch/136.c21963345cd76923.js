"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[136],{3177:(ae,K,m)=>{m.d(K,{m:()=>$});var c=m(4274),p=m(5e3),L=m(9524),w=m(4267),V=m(3305);const F=["myAreaChart"];let $=(()=>{class D{constructor(u,g,P){this.exclusionsService=u,this.historiqueService=g,this.serv=P}ngOnInit(){}ngAfterViewInit(){let u=this.historiqueService;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new c.Z(this.myAreaChart.nativeElement,{type:"line",data:{labels:[],datasets:[{label:"Maj necessaires",borderWidth:1,tension:.3,fill:!0,backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",pointRadius:5,pointBackgroundColor:"rgba(179,0,102,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(179,0,102,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj \xe9chou\xe9es",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",pointRadius:5,pointBackgroundColor:"rgba(210,7,7,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(210,7,7,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj inconnues",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",pointRadius:5,pointBackgroundColor:"rgba(103,114,105,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(103,114,105,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj serveurs exclus",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(39,114,245,0.2)",borderColor:"rgba(39,114,245,1)",pointRadius:5,pointBackgroundColor:"rgba(39,114,245,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(39,114,245,1)",pointHitRadius:50,pointBorderWidth:2,data:[]}]},options:{scales:{xAxes:{time:{unit:"day"},grid:{display:!1},ticks:{autoSkip:!0,maxRotation:45,minRotation:45,maxTicksLimit:20}},y:{min:0,grid:{color:"rgba(0, 0, 0, .125)"}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(u.typeselected){case"Production":u.imgAreaProd.next(this.toBase64Image());break;case"Pre-production":u.imgAreaPre.next(this.toBase64Image());break;case"Recette-Formation":u.imgAreaRec.next(this.toBase64Image());break;case"BDD":u.imgAreaBdd.next(this.toBase64Image());break;case"BDD-Recette":u.imgAreaBddRec.next(this.toBase64Image());break;case"Production,BDD":case"Production,Pre-production,BDD":u.imgAreaProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":u.imgAreaRecBddRec.next(this.toBase64Image())}}}}}),this.chart.hide(2),this.exclusionsService.getExclusions().subscribe(g=>{this.serveurs_exclu=g,this.historique$.subscribe(P=>{var q,B,T,R,C,f,S,n,Z,I,E,H,h,W,N,G,Q,ee;null===(B=null===(q=this.chart.data.datasets)||void 0===q?void 0:q[0].data)||void 0===B||B.splice(0,null===(R=null===(T=this.chart.data.datasets)||void 0===T?void 0:T[0].data)||void 0===R?void 0:R.length),null===(f=null===(C=this.chart.data.datasets)||void 0===C?void 0:C[1].data)||void 0===f||f.splice(0,null===(n=null===(S=this.chart.data.datasets)||void 0===S?void 0:S[1].data)||void 0===n?void 0:n.length),null===(I=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[2].data)||void 0===I||I.splice(0,null===(H=null===(E=this.chart.data.datasets)||void 0===E?void 0:E[2].data)||void 0===H?void 0:H.length),null===(W=null===(h=this.chart.data.datasets)||void 0===h?void 0:h[3].data)||void 0===W||W.splice(0,null===(G=null===(N=this.chart.data.datasets)||void 0===N?void 0:N[3].data)||void 0===G?void 0:G.length),null===(Q=this.chart.data.labels)||void 0===Q||Q.splice(0,null===(ee=this.chart.data.labels)||void 0===ee?void 0:ee.length);var X=0;P.forEach(te=>{var Y,A,j,l,_,b,O,J,z;null===(Y=this.chart.data.labels)||void 0===Y||Y.push(te.date);var se=0,ne=0,oe=0,le=0;te.serveurs.forEach(t=>{se+=t.kb_inconnus,ne+=t.kb_failed,oe+=t.kb_manquantes,1==this.checkExclu(t)&&(le+=t.kb_manquantes)}),null===(j=null===(A=this.chart.data.datasets)||void 0===A?void 0:A[0].data)||void 0===j||j.push(oe),null===(_=null===(l=this.chart.data.datasets)||void 0===l?void 0:l[1].data)||void 0===_||_.push(ne),null===(O=null===(b=this.chart.data.datasets)||void 0===b?void 0:b[2].data)||void 0===O||O.push(se),null===(z=null===(J=this.chart.data.datasets)||void 0===J?void 0:J[3].data)||void 0===z||z.push(le),se>=X&&(X=se),ne>=X&&(X=ne),oe>=X&&(X=oe),function e(D,x){D.options.scales.y={min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}(this.chart)}),this.chart.update()})})}checkExclu(u){return null!=this.serveurs_exclu.find(g=>g.name.match(u.fullName))}}return D.\u0275fac=function(u){return new(u||D)(p.Y36(L.z),p.Y36(w.J),p.Y36(V.t))},D.\u0275cmp=p.Xpm({type:D,selectors:[["sb-charts-area"]],viewQuery:function(u,g){if(1&u&&p.Gf(F,5),2&u){let P;p.iGM(P=p.CRH())&&(g.myAreaChart=P.first)}},decls:2,vars:0,consts:[["myAreaChart",""]],template:function(u,g){1&u&&p._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),D})()},6021:(ae,K,m)=>{m.d(K,{e:()=>F});var c=m(829),p=m(1013),L=m(5e3),w=m(4267);const V=["myBarChart"];let F=(()=>{class ${constructor(D){this.historiqueService=D}ngOnInit(){}ngAfterViewInit(){var D;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$;let u,x=this.historiqueService;this.chart=new c.kL(this.myBarChart.nativeElement,{type:"bar",plugins:[p.Z],data:{datasets:[]},options:{plugins:{datalabels:{color:"#236be8"}},animation:{onComplete:function(){if(null!=this.data.datasets[1])switch(x.typeselected){case"Production":x.imgBarProd.next(this.toBase64Image()),x.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),x.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":x.imgBarPre.next(this.toBase64Image()),x.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),x.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":x.imgBarRec.next(this.toBase64Image()),x.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),x.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":x.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":x.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":x.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":x.imgBarRecBddRec.next(this.toBase64Image()),x.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),x.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":x.imgBarProdBdd.next(this.toBase64Image()),x.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),x.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}),null!=this.osSelected&&(u=null===(D=this.osSelected)||void 0===D?void 0:D.split("_")),this.historique$.subscribe(g=>{var P,q,B,T,R,C,f=0;if("TOUT"!=this.historiqueService.dateselected_debut&&"TOUT"!=this.historiqueService.dateselected_fin){if(null===(P=this.chart.data.datasets)||void 0===P||P.splice(0,null===(q=this.chart.data.datasets)||void 0===q?void 0:q.length),null===(B=this.chart.data.labels)||void 0===B||B.splice(0,null===(T=this.chart.data.labels)||void 0===T?void 0:T.length),this.chart.data={labels:["Avant","Apr\xe8s"],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]},g.forEach(n=>{var Z,I,E,H,h,W,N,G,Q,ee,X,te,Y=0,A=0,j=0;n.serveurs.forEach(_=>{null!=_.kb_inconnus&&(Y+=_.kb_inconnus),null!=_.kb_failed&&(A+=_.kb_failed),null!=_.kb_manquantes&&(j+=_.kb_manquantes)});let l=new Date(n.date);l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),this.historiqueService.dateselected_debut instanceof Date&&l.getTime()==this.historiqueService.dateselected_debut.getTime()&&(null===(I=null===(Z=this.chart.data.datasets)||void 0===Z?void 0:Z[0].data)||void 0===I||I.push(j),null===(H=null===(E=this.chart.data.datasets)||void 0===E?void 0:E[1].data)||void 0===H||H.push(A),null===(W=null===(h=this.chart.data.datasets)||void 0===h?void 0:h[2].data)||void 0===W||W.push(Y)),this.historiqueService.dateselected_fin instanceof Date&&l.getTime()==this.historiqueService.dateselected_fin.getTime()&&(null===(G=null===(N=this.chart.data.datasets)||void 0===N?void 0:N[0].data)||void 0===G||G.push(j),null===(ee=null===(Q=this.chart.data.datasets)||void 0===Q?void 0:Q[1].data)||void 0===ee||ee.push(A),null===(te=null===(X=this.chart.data.datasets)||void 0===X?void 0:X[2].data)||void 0===te||te.push(Y)),Y>=f&&(f=Y),A>=f&&(f=A),j>=f&&(f=j)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*f),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}else{null===(R=this.chart.data.datasets)||void 0===R||R.splice(0,null===(C=this.chart.data.datasets)||void 0===C?void 0:C.length),this.chart.data={labels:[],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]};var S=[];if(g.forEach(n=>{let Z=new Date(n.date).toLocaleString("default",{month:"short"});this.moisInTab(S,Z)||S.push({nom:Z,kb_failed:0,kb_necessaire:0,kb_unkown:0,nbr_histo:0});var I=0,E=0,H=0;n.serveurs.forEach(h=>{null!=u&&u[0].includes("alco")&&u[1].includes("windows")?!(h.OS.includes("Linux")||h.OS.includes("CentOS")||h.OS.includes("VMware Photon")||h.os_quick.includes("linux"))&&h.position.includes("alco")&&(null!=h.kb_inconnus&&(I+=h.kb_inconnus),null!=h.kb_failed&&(E+=h.kb_failed),null!=h.kb_manquantes&&(H+=h.kb_manquantes)):null!=u&&u[0].includes("alco")&&u[1].includes("linux")?(h.OS.includes("Linux")||h.OS.includes("CentOS")||h.OS.includes("VMware Photon")||h.os_quick.includes("linux"))&&h.position.includes("alco")&&(null!=h.kb_inconnus&&(I+=h.kb_inconnus),null!=h.kb_failed&&(E+=h.kb_failed),null!=h.kb_manquantes&&(H+=h.kb_manquantes)):null!=u&&u[0].includes("heberge")&&u[1].includes("windows")?!(h.OS.includes("Linux")||h.OS.includes("CentOS")||h.OS.includes("VMware Photon")||h.os_quick.includes("linux"))&&h.position.includes("heberge")&&(null!=h.kb_inconnus&&(I+=h.kb_inconnus),null!=h.kb_failed&&(E+=h.kb_failed),null!=h.kb_manquantes&&(H+=h.kb_manquantes)):null!=u&&u[0].includes("heberge")&&u[1].includes("linux")?(h.OS.includes("Linux")||h.OS.includes("CentOS")||h.OS.includes("VMware Photon")||h.os_quick.includes("linux"))&&h.position.includes("heberge")&&(null!=h.kb_inconnus&&(I+=h.kb_inconnus),null!=h.kb_failed&&(E+=h.kb_failed),null!=h.kb_manquantes&&(H+=h.kb_manquantes)):(null!=h.kb_inconnus&&(I+=h.kb_inconnus),null!=h.kb_failed&&(E+=h.kb_failed),null!=h.kb_manquantes&&(H+=h.kb_manquantes))});for(let h=0;h<S.length;h++)S[h].nom==Z&&(S[h].kb_failed+=E,S[h].kb_necessaire+=H,S[h].kb_unkown+=I)}),S.forEach(n=>{var Z,I,E,H,h,W,N;n.kb_failed=Math.round(n.kb_failed/(n.nbr_histo+1)),n.kb_necessaire=Math.round(n.kb_necessaire/(n.nbr_histo+1)),n.kb_unkown=Math.round(n.kb_unkown/(n.nbr_histo+1)),null===(Z=this.chart.data.labels)||void 0===Z||Z.push(n.nom),null===(E=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[0].data)||void 0===E||E.push(n.kb_necessaire),null===(h=null===(H=this.chart.data.datasets)||void 0===H?void 0:H[1].data)||void 0===h||h.push(n.kb_failed),null===(N=null===(W=this.chart.data.datasets)||void 0===W?void 0:W[2].data)||void 0===N||N.push(n.kb_unkown),n.kb_unkown>=f&&(f=n.kb_unkown),n.kb_failed>=f&&(f=n.kb_failed),n.kb_necessaire>=f&&(f=n.kb_necessaire)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*f),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}})}moisInTab(D,x){for(let u=0;u<D.length;u++)if(D[u].nom==x)return D[u].nbr_histo++,!0;return!1}}return $.\u0275fac=function(D){return new(D||$)(L.Y36(w.J))},$.\u0275cmp=L.Xpm({type:$,selectors:[["sb-charts-bar"]],viewQuery:function(D,x){if(1&D&&L.Gf(V,5),2&D){let u;L.iGM(u=L.CRH())&&(x.myBarChart=u.first)}},inputs:{osSelected:"osSelected"},decls:2,vars:0,consts:[["myBarChart",""]],template:function(D,x){1&D&&L._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),$})()},9410:(ae,K,m)=>{m.d(K,{y:()=>x});var c=m(829),p=m(1013),L=m(1135),w=m(5e3),V=m(3305),F=m(6952),$=m(757),e=m(4267);const D=["myPieChart"];let x=(()=>{class u{constructor(P,q,B,T){this.serveursService=P,this.route=q,this.userProfilService=B,this.historiqueService=T,this.lesServeurs=new L.X([]),this.kb_verte=0,this.kb_orange=0,this.kb_rouge=0,this.serveurs$=this.serveursService.messerveurs$,this.serveurs$.subscribe(R=>{this.lesServeurs.next(R)})}ngOnChanges(P){this.lesServeurs.next([])}ngOnInit(){var P=this.route;let q=this.historiqueService;this.userProfilService.get_user_profil().subscribe(B=>{this.chart=new c.kL(this.myPieChart.nativeElement,{type:"pie",data:{labels:["Serveurs n\xe9cessitant > "+B.serveursAlerte+" Maj","Serveurs n\xe9cessitant "+B.serveursBon+" \xe0 "+B.serveursAlerte+" Maj","Serveurs n\xe9cessitant < "+B.serveursBon+" Maj"],datasets:[{data:[],backgroundColor:["#dc3545","#ffc107","#28a745"]}]},options:{responsive:!0,aspectRatio:2,animation:{easing:"linear",onComplete:function(){null!=this.data.datasets[0].data[0]&&q.imgPie.next(this.toBase64Image())}}},plugins:[p.Z]}),this.lesServeurs.subscribe(T=>{var R;this.chart.data.datasets[0].data=[];let C,f=T.length;null!=this.osSelected&&(C=null===(R=this.osSelected)||void 0===R?void 0:R.split("_")),null!=C&&C[0].includes("alco")&&C[1].includes("windows")&&(f=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("alco")&&C[1].includes("linux")&&(f=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("heberge")&&C[1].includes("windows")&&(f=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),null!=C&&C[0].includes("heberge")&&C[1].includes("linux")&&(f=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<B.serveursBon?this.kb_verte+=1:n.kb_manquantes>=B.serveursBon&&n.kb_manquantes<B.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,f++)})),this.chart.data.datasets[0].data.push(this.kb_rouge),this.chart.data.datasets[0].data.push(this.kb_orange),this.chart.data.datasets[0].data.push(this.kb_verte);let S=this.historiqueService;this.chart.options={responsive:!0,aspectRatio:2,plugins:{legend:{position:"right"},datalabels:{color:"black",font:{weight:"bold",size:16},formatter:(n,Z)=>{const E=(n/f*100).toFixed(1);return n/T.length*100<8?null:`${E}%`}},tooltip:{callbacks:{label:function(n){return" "+n.formattedValue+" Serveurs, soit : "+(parseInt(n.formattedValue)/f*100).toFixed(1)+"%"}},displayColors:!1}},elements:{point:{radius:0}},onClick:function(n){P.navigate(["patchManagement/serveurs/Alco_Windows"])},animation:{easing:"linear",onComplete:function(){S.imgPie.next(this.toBase64Image())}}},this.chart.update(),this.chart.resize()})})}ngAfterViewChecked(){}}return u.\u0275fac=function(P){return new(P||u)(w.Y36(V.t),w.Y36(F.F0),w.Y36($.gb),w.Y36(e.J))},u.\u0275cmp=w.Xpm({type:u,selectors:[["sb-charts-pie"]],viewQuery:function(P,q){if(1&P&&w.Gf(D,5),2&P){let B;w.iGM(B=w.CRH())&&(q.myPieChart=B.first)}},inputs:{osSelected:"osSelected"},features:[w.TTD],decls:2,vars:0,consts:[["myPieChart",""]],template:function(P,q){1&P&&w._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),u})()},3678:(ae,K,m)=>{m.d(K,{L:()=>e});var c=m(7751),p=m(5e3),L=m(4267),w=m(2382),V=m(9444);function F(D,x){if(1&D){const u=p.EpF();p.TgZ(0,"span",14),p.NdJ("mouseenter",function(){const q=p.CHM(u).$implicit;return p.oxw().hoveredDate=q})("mouseleave",function(){return p.CHM(u),p.oxw().hoveredDate=null}),p._uU(1),p.qZA()}if(2&D){const u=x.$implicit,g=x.focused,P=p.oxw();p.ekj("focused",g)("range",P.isRange(u))("faded",P.isHovered(u)||P.isInside(u)),p.xp6(1),p.hij(" ",u.day," ")}}const $=function(){return["fas","table"]};let e=(()=>{class D{constructor(u,g,P){this.calendar=u,this.formatter=g,this.historiqueService=P,this.hoveredDate=null,this.fromDate=null,this.toDate=null}onDateSelection(u){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&u&&u.after(this.fromDate)?this.toDate=u:(this.toDate=null,this.fromDate=u):this.fromDate=u}isHovered(u){return this.fromDate&&!this.toDate&&this.hoveredDate&&u.after(this.fromDate)&&u.before(this.hoveredDate)}isInside(u){return this.toDate&&u.after(this.fromDate)&&u.before(this.toDate)}isRange(u){return u.equals(this.fromDate)||this.toDate&&u.equals(this.toDate)||this.isInside(u)||this.isHovered(u)}validateInput(u,g){const P=this.formatter.parse(g);return P&&this.calendar.isValid(c.qj.from(P))?c.qj.from(P):u}eventChange(){this.historiqueService.dateSelected_debut=null==this.fromDate?null:new Date(this.fromDate.year,this.fromDate.month-1,this.fromDate.day),this.historiqueService.dateSelected_fin=null==this.toDate?null:new Date(this.toDate.year,this.toDate.month-1,this.toDate.day)}ngOnInit(){}}return D.\u0275fac=function(u){return new(u||D)(p.Y36(c.vL),p.Y36(c.NG),p.Y36(L.J))},D.\u0275cmp=p.Xpm({type:D,selectors:[["app-date-picker"]],decls:19,vars:8,consts:[[1,"form-inline"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"autoClose","displayMonths","dayTemplate","startDate","dateSelect"],["datepicker","ngbDatepicker"],["t",""],[1,"input-group","mr-2"],["placeholder","D\xe9but","name","dpFromDate",1,"form-control",3,"value","input"],["dpFromDate",""],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[1,"mr-1",3,"icon"],["placeholder","Fin","name","dpToDate",1,"form-control",3,"value","input"],["dpToDate",""],["type","button",1,"btn","btn-outline-primary","ml-2",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(u,g){if(1&u){const P=p.EpF();p.TgZ(0,"form",0)(1,"div")(2,"div",1)(3,"div",2)(4,"input",3,4),p.NdJ("dateSelect",function(B){return g.onDateSelection(B),g.eventChange()}),p.qZA(),p.YNc(6,F,2,7,"ng-template",null,5,p.W1O),p.qZA()(),p.TgZ(8,"div",6)(9,"input",7,8),p.NdJ("input",function(){p.CHM(P);const B=p.MAs(10);return g.fromDate=g.validateInput(g.fromDate,B.value)}),p.qZA(),p.TgZ(11,"button",9),p.NdJ("click",function(){return p.CHM(P),p.MAs(5).toggle()}),p._UZ(12,"fa-icon",10),p.qZA()()(),p.TgZ(13,"div")(14,"div",2)(15,"input",11,12),p.NdJ("input",function(){p.CHM(P);const B=p.MAs(16);return g.toDate=g.validateInput(g.toDate,B.value)}),p.qZA(),p.TgZ(17,"button",13),p.NdJ("click",function(){return g.fromDate=null,g.toDate=null,g.eventChange()}),p._uU(18,"Reset"),p.qZA()()()()}if(2&u){const P=p.MAs(7);p.xp6(4),p.Q6J("autoClose","outside")("displayMonths",1)("dayTemplate",P)("startDate",g.fromDate),p.xp6(5),p.Q6J("value",g.formatter.format(g.fromDate)),p.xp6(3),p.Q6J("icon",p.DdM(7,$)),p.xp6(3),p.Q6J("value",g.formatter.format(g.toDate))}},directives:[w._Y,w.JL,w.F,c.J4,V.BN],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]}),D})()},4850:(ae,K,m)=>{m.d(K,{p:()=>Y});var c=m(7751),p=m(1135),L=m(3177),w=m(6021),V=m(9410),F=m(3678),e=m(5e3),D=m(4267),x=m(3154),u=m(6952),g=m(2382),P=m(5212),q=m(6333),B=m(9444),T=m(9808);function R(A,j){if(1&A){const l=e.EpF();e.TgZ(0,"div",24)(1,"h4",25),e._uU(2,"Generation Du Rapport"),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){return e.CHM(l).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",27)(5,"form",28)(6,"p"),e._uU(7,"Veuillez S\xe9l\xe9ctionner le nombre de jours \xe0 prendre en compte pour le rapport."),e.qZA(),e.TgZ(8,"input",29),e.NdJ("ngModelChange",function(b){return e.CHM(l),e.oxw().joursRapport=b}),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Choisissez l'environnement:"),e.qZA(),e.TgZ(11,"select",30),e.NdJ("ngModelChange",function(b){return e.CHM(l),e.oxw().environnement=b}),e.TgZ(12,"option",31),e._uU(13,"Production"),e.qZA(),e.TgZ(14,"option",32),e._uU(15,"Recette-Formation"),e.qZA()(),e.TgZ(16,"label",33)(17,"input",34),e.NdJ("ngModelChange",function(b){return e.CHM(l),e.oxw().bdd_checked=b}),e.qZA(),e._uU(18," Avec BDD "),e.qZA(),e.TgZ(19,"div")(20,"label",35),e._uU(21,"Entrez votre email"),e.qZA(),e.TgZ(22,"input",36),e.NdJ("ngModelChange",function(b){return e.CHM(l),e.oxw().email=b}),e.qZA(),e.TgZ(23,"div",37),e._uU(24," Attention email obligatoire "),e.qZA()()()(),e.TgZ(25,"div",38)(26,"button",39),e.NdJ("click",function(){return e.CHM(l).$implicit.dismiss("cancel click")}),e._uU(27,"Annuler"),e.qZA(),e.TgZ(28,"button",40),e.NdJ("click",function(){const O=e.CHM(l).$implicit,J=e.oxw();return O.close("Ok click"),J.genereRapport()}),e._uU(29,"G\xe9n\xe9rer"),e.qZA()()}if(2&A){const l=e.oxw();e.xp6(8),e.Q6J("min",1)("ngModel",l.joursRapport),e.xp6(3),e.Q6J("ngModel",l.environnement),e.xp6(6),e.Q6J("ngModel",l.bdd_checked),e.xp6(5),e.Q6J("ngModel",l.email)}}const C=function(){return["fab","windows"]};function f(A,j){if(1&A){const l=e.EpF();e.TgZ(0,"div",45)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Windows "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Production"}),e._uU(7,"Prod"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Pre-production"}),e._uU(9,"Pre-Prod"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Recette-Formation"}),e._uU(11,"Rec-Form"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD"}),e._uU(13,"BDD"),e.qZA(),e.TgZ(14,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-Recette"}),e._uU(15,"BDD-Rec"),e.qZA(),e.TgZ(16,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="DMZ"}),e._uU(17,"DMZ"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,C)))}function S(A,j){if(1&A){const l=e.EpF();e.TgZ(0,"div",48)(1,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Production,Pre-production,BDD"}),e._uU(2,"Production + BDD"),e.qZA(),e.TgZ(3,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Recette-Formation,BDD-Recette"}),e._uU(4,"Rec-Form + BDD-Rec"),e.qZA()()}}const n=function(){return["fab","linux"]};function Z(A,j){if(1&A){const l=e.EpF();e.TgZ(0,"div",49)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Linux "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-PRODPRE"}),e._uU(7,"BDD-ProPre"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="BDD-RECFOR"}),e._uU(9,"BDD-RECFOR"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="PROD-PRE"}),e._uU(11,"PROD-PRE"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(l),e.oxw(2).historiqueService.typeselected="REC-FOR"}),e._uU(13,"REC-FOR"),e.qZA()()}2&A&&(e.xp6(2),e.Q6J("icon",e.DdM(1,n)))}function I(A,j){if(1&A&&(e.TgZ(0,"div",41),e.YNc(1,f,18,2,"div",42),e.YNc(2,S,5,0,"div",43),e.YNc(3,Z,14,2,"div",44),e.qZA()),2&A){const l=j.ngIf;e.xp6(1),e.Q6J("ngIf","Alco_Windows"==l),e.xp6(1),e.Q6J("ngIf","Alco_Windows"==l),e.xp6(1),e.Q6J("ngIf","Alco_Linux"==l)}}function E(A,j){if(1&A&&(e.TgZ(0,"span",17),e._uU(1,"Total historiques: "),e.TgZ(2,"span",50),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&A){const l=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,l.historiqueService.total$))}}const H=function(){return["fas","xmark"]};function h(A,j){if(1&A){const l=e.EpF();e.TgZ(0,"li",51),e._uU(1),e.TgZ(2,"span",52),e.NdJ("click",function(){const O=e.CHM(l).$implicit;return e.oxw().deleteItem(O)}),e._UZ(3,"fa-icon",7),e.qZA()()}if(2&A){const l=j.$implicit;e.xp6(1),e.Oqu(l),e.xp6(2),e.Q6J("icon",e.DdM(2,H))}}function W(A,j){if(1&A&&(e.TgZ(0,"div",53)(1,"div",54),e._uU(2),e.qZA()()),2&A){const l=e.oxw();e.xp6(1),e.Udp("width",l.progress,"%"),e.xp6(1),e.hij(" ",l.progress,"% Complete ")}}function N(A,j){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function G(A,j){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const l=j.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",l,"h")}}function Q(A,j){1&A&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function ee(A,j){if(1&A&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&A){const l=j.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",l,"h")}}const X=function(){return["fas","search"]},te=function(){return["fas","chart-area"]};let Y=(()=>{class A{constructor(l,_,b,O,J){this.historiqueService=l,this.horaireMajService=_,this.route=b,this.modalService=O,this.viewContainerRef=J,this.pageSize=4,this.maRecherche=Array(),this.search="",this.title="Nombres de patchs /mois",this.horaireMaj=new p.X(""),this.osSelected=new p.X("All"),this.joursRapport=1,this.loading_rapport=new p.X(!1),this.progress=0,this.environnement="Prod",this.bdd_checked=!0,this.email=""}ngOnDestroy(){this.search="",this.maRecherche.splice(0,this.maRecherche.length),this.historiqueService.serveursselected=[]}ngOnInit(){this.horaireMajService.getHoraireMaj().subscribe(l=>{console.log("horaire: "+l),this.horaireMaj.next(l)}),this.route.params.subscribe(l=>{null!=l.OSSelected&&(this.osSelected.next(l.OSSelected),this.osSelected.subscribe(_=>{this.historiqueService.OSSelected=_}))})}RemoveElementFromArray(l){this.maRecherche.forEach((_,b)=>{_==l&&this.maRecherche.splice(b,1)})}deleteItem(l){this.RemoveElementFromArray(l);var _=this.historiqueService.serveursselected;_.forEach((b,O)=>{b==l&&_.splice(O,1)}),this.historiqueService.serveursselected=_}ajout(){this.maRecherche.push(this.search);var l=this.historiqueService.serveursselected;l.push(this.search),this.historiqueService.serveursselected=l}open(l){this.modalService.open(l,{centered:!0}).result.then(_=>{this.closeResult=`Closed with: ${_}`},_=>{this.closeResult=`Dismissed ${this.getDismissReason(_)}`})}getDismissReason(l){return l===c.If.ESC?"by pressing ESC":l===c.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${l}`}genereRapport(){this.loading_rapport.next(!0);const l=new Date;l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0);const _=new Date(l);_.setDate(_.getDate()-this.joursRapport),_.setHours(0),_.setMinutes(0),_.setSeconds(0),_.setMilliseconds(0),this.historiqueService.dateSelected_fin=l,this.historiqueService.dateSelected_debut=_,this.historiqueService.imgAreaProd.next(" "),this.historiqueService.imgAreaPre.next(" "),this.historiqueService.imgAreaBdd.next(" "),this.historiqueService.imgAreaProdBdd.next(" "),this.historiqueService.imgAreaRec.next(" "),this.historiqueService.imgAreaBddRec.next(" "),this.historiqueService.imgAreaRecBddRec.next(" "),this.historiqueService.imgBarProd.next(" "),this.historiqueService.imgBarPre.next(" "),this.historiqueService.imgBarBdd.next(" "),this.historiqueService.imgBarProdBdd.next(" "),this.historiqueService.imgBarRec.next(" "),this.historiqueService.imgBarBddRec.next(" "),this.historiqueService.imgBarRecBddRec.next(" "),this.historiqueService.imgPie.next(" "),this.historiqueService.majAvProdAppli.next(" "),this.historiqueService.majApProdAppli.next(" "),this.historiqueService.majAvProdBdd.next(" "),this.historiqueService.majApProdBdd.next(" "),this.historiqueService.majAvRecAppli.next(" "),this.historiqueService.majApRecAppli.next(" "),this.historiqueService.majAvRecBdd.next(" "),this.historiqueService.majApRecBdd.next(" "),this.progress=10;const b=this.viewContainerRef.createComponent(V.y);if(b.instance.osSelected="alco_windows","Prod"==this.environnement){let O=this.historiqueService.loading$.subscribe(J=>{0==J&&setTimeout(()=>{" "!=this.historiqueService.imgAreaProd.getValue()&&" "!=this.historiqueService.imgAreaPre.getValue()&&" "!=this.historiqueService.imgBarProd.getValue()&&" "!=this.historiqueService.imgBarPre.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBdd.getValue()&&" "!=this.historiqueService.imgAreaProdBdd.getValue()&&" "!=this.historiqueService.imgBarBdd.getValue()&&" "!=this.historiqueService.imgBarProdBdd.getValue()?(O.unsubscribe(),b.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!0,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaBdd.getValue()||" "==this.historiqueService.imgBarBdd.getValue()?(this.progress=70,this.historiqueService.typeselected="BDD"):(this.progress=90,this.historiqueService.typeselected="Production,Pre-production,BDD"):(this.progress=75,O.unsubscribe(),b.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!1,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaProd.getValue()||" "==this.historiqueService.imgBarProd.getValue()?(this.progress=25,this.historiqueService.typeselected="Production"):(" "==this.historiqueService.imgAreaPre.getValue()||" "==this.historiqueService.imgBarPre.getValue())&&(this.progress=40,this.historiqueService.typeselected="Pre-production")},1e4)})}else if("Rec"==this.environnement){let O=this.historiqueService.loading$.subscribe(J=>{0==J&&setTimeout(()=>{" "!=this.historiqueService.imgAreaRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBddRec.getValue()&&" "!=this.historiqueService.imgAreaRecBddRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()&&" "!=this.historiqueService.imgBarRecBddRec.getValue()?(O.unsubscribe(),b.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!0,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaBddRec.getValue()||" "==this.historiqueService.imgBarRec.getValue()?(this.progress=50,this.historiqueService.typeselected="BDD-Recette"):(this.progress=70,this.historiqueService.typeselected="Recette-Formation,BDD-Recette"):(this.progress=80,O.unsubscribe(),b.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!1,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):(" "==this.historiqueService.imgAreaRec.getValue()||" "==this.historiqueService.imgBarRec.getValue())&&(this.progress=25,this.historiqueService.typeselected="Recette-Formation")},1e4)})}}}return A.\u0275fac=function(l){return new(l||A)(e.Y36(D.J),e.Y36(x.w),e.Y36(u.gz),e.Y36(c.FF),e.Y36(e.s_b))},A.\u0275cmp=e.Xpm({type:A,selectors:[["app-historique"]],inputs:{pageSize:"pageSize"},decls:54,vars:31,consts:[["content",""],["title","Historique",3,"hideBreadcrumbs"],[1,"card-body"],[1,"form-group","form-inline"],["type","text","name","searchTerm",1,"form-control","ml-1","col-1",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],["class","ml-2 btn-toolbar","role","toolbar","aria-label","Toolbar with button groups",4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3","list-group","list-group-horizontal"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","progress",4,"ngIf"],[1,"row"],[1,"col-lg-6"],[1,"card-header","form-inline"],[1,"mr-1",3,"icon"],[1,"ml-3"],["class","progress ml-1",4,"ngIf"],[1,"card-footer","small","text-muted","d-flex","d-flex","justify-content-between"],["class","ml-auto",4,"ngIf"],["id","#title"],[1,"ml-0",2,"visibility","hidden"],[1,"card-footer","small","text-muted","d-flex","mb-0"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",1,"needs-validation"],["type","number","name","input-jour",1,"form-control","ml-1",3,"min","ngModel","ngModelChange"],["name","select_env",1,"browser-default","custom-select",3,"ngModel","ngModelChange"],["value","Prod"],["value","Rec"],[1,"form-check-label","mt-1"],["type","checkbox","value","bdd_checked","name","check_bdd","checked","",3,"ngModel","ngModelChange"],["for","form9"],["type","email","id","exampleInputEmail1","aria-describedby","emailHelp","placeholder","Enter email","name","email","required","",1,"form-control","is-invalid",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["class","btn-group me-2","role","group","aria-label","First group",4,"ngIf"],["class","btn-group me-2 ml-1","role","group","aria-label","Second group",4,"ngIf"],["class","btn-group me-2 ml-2","role","group","aria-label","Third group",4,"ngIf"],["role","group","aria-label","First group",1,"btn-group","me-2"],[1,"btn"],["type","button",1,"btn","btn-outline-info","button_perso",3,"click"],["role","group","aria-label","Second group",1,"btn-group","me-2","ml-1"],["role","group","aria-label","Third group",1,"btn-group","me-2","ml-2"],[1,"font-weight-bold"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ml-3",3,"click"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-success"],[1,"progress","ml-1"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","100%"],[1,"ml-auto"]],template:function(l,_){if(1&l){const b=e.EpF();e.YNc(0,R,30,5,"ng-template",null,0,e.W1O),e._UZ(2,"sb-dashboard-head",1),e.TgZ(3,"sb-card")(4,"div",2)(5,"form")(6,"div",3),e._uU(7,"Recherche: "),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function(J){return _.search=J}),e.qZA(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return _.ajout()}),e._UZ(11,"fa-icon",7),e.qZA()(),e.YNc(12,I,4,3,"div",8),e.ALo(13,"async"),e.YNc(14,E,5,3,"span",9),e.ALo(15,"async"),e.TgZ(16,"ul",10),e.YNc(17,h,4,3,"li",11),e.qZA(),e.TgZ(18,"button",6),e.NdJ("click",function(){e.CHM(b);const J=e.MAs(1);return _.open(J)}),e._uU(19,"G\xe9n\xe9rer rapport"),e.qZA()()(),e.YNc(20,W,3,3,"div",12),e.ALo(21,"async"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"sb-card")(25,"div",15),e._UZ(26,"fa-icon",16),e.TgZ(27,"span"),e._uU(28,"Intervalle: "),e.qZA(),e._UZ(29,"app-date-picker",17),e.qZA(),e.TgZ(30,"div",2),e.YNc(31,N,3,0,"div",18),e.ALo(32,"async"),e._UZ(33,"sb-charts-area"),e.qZA(),e.TgZ(34,"div",19),e._uU(35,"Mise \xe0 jour /jour "),e.YNc(36,G,2,1,"p",20),e.ALo(37,"async"),e.qZA()()(),e.TgZ(38,"div",14)(39,"sb-card")(40,"div",15),e._UZ(41,"fa-icon",16),e.TgZ(42,"span",21),e._uU(43),e.qZA(),e._UZ(44,"app-date-picker",22),e.qZA(),e.TgZ(45,"div",2),e.YNc(46,Q,3,0,"div",18),e.ALo(47,"async"),e._UZ(48,"sb-charts-bar"),e.qZA(),e.TgZ(49,"div",23)(50,"p"),e._uU(51,"Mise \xe0 jour /mois (moyenne)"),e.qZA(),e.YNc(52,ee,2,1,"p",20),e.ALo(53,"async"),e.qZA()()()()}2&l&&(e.xp6(2),e.Q6J("hideBreadcrumbs",!1),e.xp6(6),e.Q6J("ngModel",_.search),e.xp6(3),e.Q6J("icon",e.DdM(28,X)),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,14,_.osSelected)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,16,_.historiqueService.total$)),e.xp6(3),e.Q6J("ngForOf",_.maRecherche),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,18,_.loading_rapport)),e.xp6(6),e.Q6J("icon",e.DdM(29,te)),e.xp6(5),e.Q6J("ngIf",e.lcZ(32,20,_.historiqueService.loading$)),e.xp6(5),e.Q6J("ngIf",e.lcZ(37,22,_.horaireMaj)),e.xp6(5),e.Q6J("icon",e.DdM(30,te)),e.xp6(2),e.Oqu(_.title),e.xp6(3),e.Q6J("ngIf",e.lcZ(47,24,_.historiqueService.loading$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(53,26,_.horaireMaj)))},directives:[g._Y,g.JL,g.F,g.qQ,g.wV,g.Fj,g.JJ,g.On,g.EJ,g.YN,g.Kr,g.Wl,g.Q7,P.T,q.A,B.BN,T.O5,T.sg,F.L,L.m,w.e],pipes:[T.Ov],styles:[".button_perso[_ngcontent-%COMP%]:focus{color:#fff;background-color:#17a2b8;box-shadow:none}.button_perso[_ngcontent-%COMP%]{border:.5px solid #17a2b8!important}"],changeDetection:0}),A})()},9136:(ae,K,m)=>{m.d(K,{e:()=>P});var c=m(9808),p=m(6952),L=m(2382),w=m(2539),V=m(5592),F=m(4267),$=m(5e3);m(4850),m(3177),m(6021),m(9410),m(3678);let P=(()=>{class q{}return q.\u0275fac=function(T){return new(T||q)},q.\u0275mod=$.oAB({type:q}),q.\u0275inj=$.cJS({providers:[c.JJ,...F.u],imports:[[c.ez,p.Bz,L.UX,L.u5,w.n,V.A]]}),q})()},4267:(ae,K,m)=>{m.d(K,{J:()=>B,u:()=>T});var c=m(1135),p=m(7579),L=m(8505),w=m(8372),V=m(3900),F=m(4825),$=m(9646),e=m(5e3),D=m(9808),x=m(520);let B=(()=>{class R{constructor(f,S){this.pipe=f,this.http=S,this._loading$=new c.X(!0),this._search$=new p.x,this._mesHisto$=new p.x,this._historique$=new c.X([]),this._total$=new c.X(0),this.imgAreaProd=new c.X(""),this.imgAreaPre=new c.X(""),this.imgAreaBdd=new c.X(""),this.imgAreaProdBdd=new c.X(""),this.imgAreaRec=new c.X(""),this.imgAreaBddRec=new c.X(""),this.imgAreaRecBddRec=new c.X(""),this.imgBarProd=new c.X(""),this.imgBarPre=new c.X(""),this.imgBarBdd=new c.X(""),this.imgBarProdBdd=new c.X(""),this.imgBarRec=new c.X(""),this.imgBarBddRec=new c.X(""),this.imgBarRecBddRec=new c.X(""),this.imgPie=new c.X(""),this.majAvProdAppli=new c.X(""),this.majApProdAppli=new c.X(""),this.majAvPreAppli=new c.X(""),this.majApPreAppli=new c.X(""),this.majAvProdBdd=new c.X(""),this.majApProdBdd=new c.X(""),this.majAvRecAppli=new c.X(""),this.majApRecAppli=new c.X(""),this.majAvRecBdd=new c.X(""),this.majApRecBdd=new c.X(""),this.baseURL="https://172.17.2.130/",this._state={dateSelected_debut:"TOUT",dateSelected_fin:"TOUT",typeSelected:"Tous",serveursSelected:[],OSSelected:"Alco_Windows"},this._search$.pipe((0,L.b)(()=>this._loading$.next(!0)),(0,w.b)(120),(0,V.w)(()=>this.get_historiques()),(0,F.g)(120)).subscribe(n=>{this._mesHisto$.next(n)}),this._mesHisto$.pipe((0,w.b)(120),(0,V.w)(n=>this._search(n)),(0,F.g)(120),(0,L.b)(()=>this._loading$.next(!1))).subscribe(n=>{this._historique$.next(n.historiques),this._total$.next(n.total)}),this._search$.next()}get meshistorique$(){return this._mesHisto$.asObservable()}get historique$(){return this._historique$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get dateselected_debut(){return this._state.dateSelected_debut}get dateselected_fin(){return this._state.dateSelected_fin}set dateSelected_debut(f){this._set(null==f?{dateSelected_debut:"TOUT"}:{dateSelected_debut:f}),console.log("DATEEE: "+f)}set dateSelected_fin(f){this._set(null==f?{dateSelected_fin:"TOUT"}:{dateSelected_fin:f})}get typeselected(){return this._state.typeSelected}set typeselected(f){this._set({typeSelected:f})}get serveursselected(){return this._state.serveursSelected}set serveursselected(f){this._set({serveursSelected:f})}set OSSelected(f){this._set({OSSelected:f})}_set(f){Object.assign(this._state,f),this._search$.next()}_search(f){const{dateSelected_debut:S,dateSelected_fin:n,typeSelected:Z,serveursSelected:I}=this._state;let E=f;return E=E.filter(h=>function P(R,C,f){let S=new Date(R.date);if(S.setHours(0),"TOUT"==C&&"TOUT"==f)return!0;if("TOUT"==C&&f instanceof Date)return S.getTime()===f.getTime();if(C instanceof Date&&"TOUT"==f)return S.getTime()===C.getTime();if(C instanceof Date&&f instanceof Date)return S.getTime()>=C.getTime()&&S.getTime()<=f.getTime();throw console.error("Erreur Date type")}(h,S,n)),E.forEach(h=>{h.serveurs=h.serveurs.filter(W=>function u(R,C){let f=C.split(",");return"Tous"==f[0]||f.includes(R.type)}(W,Z))}),E.forEach(h=>{h.serveurs=h.serveurs.filter(W=>function g(R,C,f){if(0==C.length)return!0;let S=!1;return C.forEach(n=>{1==function q(R,C,f){return R.name.toLowerCase().includes(C.toLowerCase())||R.type.toLowerCase().includes(C.toLowerCase())||R.ip.toLowerCase().includes(C.toLowerCase())||R.OS.toLowerCase().includes(C.toLowerCase())||R.description.toLowerCase().includes(C.toLowerCase())||f.transform(R.kb_manquantes).includes(C)||f.transform(R.kb_failed).includes(C)||f.transform(R.kb_inconnus).includes(C)||R.date_dernier_update.toLocaleLowerCase().includes(C.toLocaleLowerCase())||R.date_last_rapport.toLowerCase().includes(C.toLowerCase())}(R,n,f)&&(S=!0)}),S}(W,I,this.pipe))}),E=E.filter(h=>h.serveurs.length>0),(0,$.of)({historiques:E,total:E.length})}get_historiques(){try{return this.http.get(this.baseURL+"servNode/historiques/"+this._state.OSSelected,{withCredentials:!0})}catch(f){throw{msg:"Erreur get_serveurs(): "+f}}}generateRapport(f,S,n,Z){try{return"Prod"==S?1==n?this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/true/"+this.majAvProdBdd.getValue()+"/"+this.majApProdBdd.getValue(),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),areaBdd:this.imgAreaBdd.getValue(),areaProdBdd:this.imgAreaProdBdd.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),barBdd:this.imgBarBdd.getValue(),barProdBdd:this.imgBarProdBdd.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/false/"+(parseInt(this.majAvProdAppli.getValue())+parseInt(this.majAvPreAppli.getValue()))+"/"+(parseInt(this.majApProdAppli.getValue())+parseInt(this.majApPreAppli.getValue())),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):1==n?this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/true/"+this.majAvRecBdd.getValue()+"/"+this.majApRecBdd.getValue(),{areaRec:this.imgAreaRec.getValue(),areaBddRec:this.imgAreaBddRec.getValue(),areaRecBddRec:this.imgAreaRecBddRec.getValue(),barRec:this.imgBarRec.getValue(),barBddRec:this.imgBarBddRec.getValue(),barRecBddRec:this.imgBarRecBddRec.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0}):this.http.put(this.baseURL+"servNode/historiques_rapport/"+S+"/"+Z+"/false/"+this.majAvRecAppli.getValue()+"/"+this.majApRecAppli.getValue(),{areaRec:this.imgAreaRec.getValue(),barRec:this.imgBarRec.getValue(),pie:this.imgPie.getValue()},{withCredentials:!0})}catch(I){throw{msg:"Erreur get_serveurs(): "+I}}}}return R.\u0275fac=function(f){return new(f||R)(e.LFG(D.JJ),e.LFG(x.eN))},R.\u0275prov=e.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();const T=[B]},1013:(ae,K,m)=>{m.d(K,{Z:()=>le});var c=m(5081),p=m(829),L=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),w_textSize=function(t,r,i){var v,a=[].concat(r),s=a.length,o=t.font,d=0;for(t.font=i.string,v=0;v<s;++v)d=Math.max(t.measureText(a[v]).width,d);return t.font=o,{height:s*i.lineHeight,width:d}};function V(t,r){var i=r.x,a=r.y;if(null===i)return{x:0,y:-1};if(null===a)return{x:1,y:0};var s=t.x-i,o=t.y-a,d=Math.sqrt(s*s+o*o);return{x:d?s/d:0,y:d?o/d:-1}}function g(t,r,i){var a=0;return t<i.left?a|=1:t>i.right&&(a|=2),r<i.top?a|=8:r>i.bottom&&(a|=4),a}function q(t,r){var s,o,i=r.anchor,a=t;return r.clamp&&(a=function P(t,r){for(var k,y,M,i=t.x0,a=t.y0,s=t.x1,o=t.y1,d=g(i,a,r),v=g(s,o,r);d|v&&!(d&v);)8&(k=d||v)?(y=i+(s-i)*(r.top-a)/(o-a),M=r.top):4&k?(y=i+(s-i)*(r.bottom-a)/(o-a),M=r.bottom):2&k?(M=a+(o-a)*(r.right-i)/(s-i),y=r.right):1&k&&(M=a+(o-a)*(r.left-i)/(s-i),y=r.left),k===d?d=g(i=y,a=M,r):v=g(s=y,o=M,r);return{x0:i,x1:s,y0:a,y1:o}}(a,r.area)),"start"===i?(s=a.x0,o=a.y0):"end"===i?(s=a.x1,o=a.y1):(s=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function F(t,r,i,a,s){switch(s){case"center":i=a=0;break;case"bottom":i=0,a=1;break;case"right":i=1,a=0;break;case"left":i=-1,a=0;break;case"top":i=0,a=-1;break;case"start":i=-i,a=-a;break;case"end":break;default:s*=Math.PI/180,i=Math.cos(s),a=Math.sin(s)}return{x:t,y:r,vx:i,vy:a}}(s,o,t.vx,t.vy,r.align)}var B={arc:function(t,r){var i=(t.startAngle+t.endAngle)/2,a=Math.cos(i),s=Math.sin(i),o=t.innerRadius,d=t.outerRadius;return q({x0:t.x+a*o,y0:t.y+s*o,x1:t.x+a*d,y1:t.y+s*d,vx:a,vy:s},r)},point:function(t,r){var i=V(t,r.origin),a=i.x*t.options.radius,s=i.y*t.options.radius;return q({x0:t.x-a,y0:t.y-s,x1:t.x+a,y1:t.y+s,vx:i.x,vy:i.y},r)},bar:function(t,r){var i=V(t,r.origin),a=t.x,s=t.y,o=0,d=0;return t.horizontal?(a=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(s=Math.min(t.y,t.base),d=Math.abs(t.base-t.y)),q({x0:a,y0:s+d,x1:a+o,y1:s,vx:i.x,vy:i.y},r)},fallback:function(t,r){var i=V(t,r.origin);return q({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},r)}},T=function(t){return Math.round(t*L)/L};function C(t,r){var i=r.chart.getDatasetMeta(r.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var a=i.getBasePixel();return t.horizontal?{x:a,y:null}:{x:null,y:a}}function f(t){return t instanceof p.qi?B.arc:t instanceof p.od?B.point:t instanceof p.ZL?B.bar:B.fallback}function I(t,r,i){var a=t.shadowBlur,s=i.stroked,o=T(i.x),d=T(i.y),v=T(i.w);s&&t.strokeText(r,o,d,v),i.filled&&(a&&s&&(t.shadowBlur=0),t.fillText(r,o,d,v),a&&s&&(t.shadowBlur=a))}var H=function(t,r,i,a){var s=this;s._config=t,s._index=a,s._model=null,s._rects=null,s._ctx=r,s._el=i};(0,c.a2)(H.prototype,{_modelize:function(t,r,i,a){var s=this,o=s._index,d=(0,c.Z)((0,c.a)([i.font,{}],a,o)),v=(0,c.a)([i.color,p.ce.color],a,o);return{align:(0,c.a)([i.align,"center"],a,o),anchor:(0,c.a)([i.anchor,"center"],a,o),area:a.chart.chartArea,backgroundColor:(0,c.a)([i.backgroundColor,null],a,o),borderColor:(0,c.a)([i.borderColor,null],a,o),borderRadius:(0,c.a)([i.borderRadius,0],a,o),borderWidth:(0,c.a)([i.borderWidth,0],a,o),clamp:(0,c.a)([i.clamp,!1],a,o),clip:(0,c.a)([i.clip,!1],a,o),color:v,display:t,font:d,lines:r,offset:(0,c.a)([i.offset,0],a,o),opacity:(0,c.a)([i.opacity,1],a,o),origin:C(s._el,a),padding:(0,c.C)((0,c.a)([i.padding,0],a,o)),positioner:f(s._el),rotation:(0,c.a)([i.rotation,0],a,o)*(Math.PI/180),size:w_textSize(s._ctx,r,d),textAlign:(0,c.a)([i.textAlign,"start"],a,o),textShadowBlur:(0,c.a)([i.textShadowBlur,0],a,o),textShadowColor:(0,c.a)([i.textShadowColor,v],a,o),textStrokeColor:(0,c.a)([i.textStrokeColor,v],a,o),textStrokeWidth:(0,c.a)([i.textStrokeWidth,0],a,o)}},update:function(t){var d,v,k,r=this,i=null,a=null,s=r._index,o=r._config,y=(0,c.a)([o.display,!0],t,s);y&&(v=(0,c.v)((0,c.O)(o.formatter,[d=t.dataset.data[s],t]),d),(k=(0,c.k)(v)?[]:function(t){var i,r=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?r.unshift.apply(r,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):(0,c.k)(t)||r.unshift(""+i);return r}(v)).length&&(a=function R(t){var r=t.borderWidth||0,i=t.padding,a=t.size.height,s=t.size.width,o=-s/2,d=-a/2;return{frame:{x:o-i.left-r,y:d-i.top-r,w:s+i.width+2*r,h:a+i.height+2*r},text:{x:o,y:d,w:s,h:a}}}(i=r._modelize(y,k,o,t)))),r._model=i,r._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,r){var d,a=t.ctx,s=this._model,o=this._rects;!this.visible()||(a.save(),s.clip&&(d=s.area,a.beginPath(),a.rect(d.left,d.top,d.right-d.left,d.bottom-d.top),a.clip()),a.globalAlpha=function(t,r,i){return Math.max(t,Math.min(r,i))}(0,s.opacity,1),a.translate(T(r.x),T(r.y)),a.rotate(s.rotation),function n(t,r,i){var a=i.backgroundColor,s=i.borderColor,o=i.borderWidth;!a&&(!s||!o)||(t.beginPath(),function S(t,r,i,a,s,o){var d=Math.PI/2;if(o){var v=Math.min(o,s/2,a/2),k=r+v,y=i+v,M=r+a-v,U=i+s-v;t.moveTo(r,y),k<M&&y<U?(t.arc(k,y,v,-Math.PI,-d),t.arc(M,y,v,-d,0),t.arc(M,U,v,0,d),t.arc(k,U,v,d,Math.PI)):k<M?(t.moveTo(k,i),t.arc(M,y,v,-d,d),t.arc(k,y,v,d,Math.PI+d)):y<U?(t.arc(k,y,v,-Math.PI,0),t.arc(k,U,v,0,Math.PI)):t.arc(k,y,v,-Math.PI,Math.PI),t.closePath(),t.moveTo(r,i)}else t.rect(r,i,a,s)}(t,T(r.x)+o/2,T(r.y)+o/2,T(r.w)-o,T(r.h)-o,i.borderRadius),t.closePath(),a&&(t.fillStyle=a,t.fill()),s&&o&&(t.strokeStyle=s,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}(a,o.frame,s),function E(t,r,i,a){var ie,s=a.textAlign,o=a.color,d=!!o,v=a.font,k=r.length,y=a.textStrokeColor,M=a.textStrokeWidth,U=y&&M;if(k&&(d||U))for(i=function Z(t,r,i){var a=i.lineHeight,s=t.w,o=t.x;return"center"===r?o+=s/2:("end"===r||"right"===r)&&(o+=s),{h:a,w:s,x:o,y:t.y+a/2}}(i,s,v),t.font=v.string,t.textAlign=s,t.textBaseline="middle",t.shadowBlur=a.textShadowBlur,t.shadowColor=a.textShadowColor,d&&(t.fillStyle=o),U&&(t.lineJoin="round",t.lineWidth=M,t.strokeStyle=y),ie=0,k=r.length;ie<k;++ie)I(t,r[ie],{stroked:U,filled:d,w:i.w,x:i.x,y:i.y+i.h*ie})}(a,s.lines,o.text,s),a.restore())}});var h=Number.MIN_SAFE_INTEGER||-9007199254740991,W=Number.MAX_SAFE_INTEGER||9007199254740991;function N(t,r,i){var a=Math.cos(i),s=Math.sin(i),o=r.x,d=r.y;return{x:o+a*(t.x-o)-s*(t.y-d),y:d+s*(t.x-o)+a*(t.y-d)}}function G(t,r){var o,d,y,i=W,a=h,s=r.origin;for(o=0;o<t.length;++o)y=r.vx*((d=t[o]).x-s.x)+r.vy*(d.y-s.y),i=Math.min(i,y),a=Math.max(a,y);return{min:i,max:a}}function Q(t,r){var i=r.x-t.x,a=r.y-t.y,s=Math.sqrt(i*i+a*a);return{vx:(r.x-t.x)/s,vy:(r.y-t.y)/s,origin:t,ln:s}}var ee=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function X(t,r,i){var a=r.positioner(t,r),s=a.vx,o=a.vy;if(!s&&!o)return{x:a.x,y:a.y};var d=i.w,v=i.h,k=r.rotation,y=Math.abs(d/2*Math.cos(k))+Math.abs(v/2*Math.sin(k)),M=Math.abs(d/2*Math.sin(k))+Math.abs(v/2*Math.cos(k)),U=1/Math.max(Math.abs(s),Math.abs(o));return y*=s*U,M*=o*U,{x:a.x+(y+=r.offset*s),y:a.y+(M+=r.offset*o)}}(0,c.a2)(ee.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,r,i){this._rotation=i,this._rect={x:r.x+t.x,y:r.y+t.y,w:r.w,h:r.h}},contains:function(t){var r=this,a=r._rect;return!((t=N(t,r.center(),-r._rotation)).x<a.x-1||t.y<a.y-1||t.x>a.x+a.w+2||t.y>a.y+a.h+2)},intersects:function(t){var s,o,d,r=this._points(),i=t._points(),a=[Q(r[0],r[1]),Q(r[0],r[3])];for(this._rotation!==t._rotation&&a.push(Q(i[0],i[1]),Q(i[0],i[3])),s=0;s<a.length;++s)if(o=G(r,a[s]),d=G(i,a[s]),o.max<d.min||d.max<o.min)return!1;return!0},_points:function(){var t=this,r=t._rect,i=t._rotation,a=t.center();return[N({x:r.x,y:r.y},a,i),N({x:r.x+r.w,y:r.y},a,i),N({x:r.x+r.w,y:r.y+r.h},a,i),N({x:r.x,y:r.y+r.h},a,i)]}});var A={prepare:function(t){var i,a,s,o,d,r=[];for(i=0,s=t.length;i<s;++i)for(a=0,o=t[i].length;a<o;++a)r.push(d=t[i][a]),d.$layout={_box:new ee,_hidable:!1,_visible:!0,_set:i,_idx:a};return r.sort(function(v,k){var y=v.$layout,M=k.$layout;return y._idx===M._idx?M._set-y._set:M._idx-y._idx}),this.update(r),r},update:function(t){var i,a,s,o,d,r=!1;for(i=0,a=t.length;i<a;++i)o=(s=t[i]).model(),(d=s.$layout)._hidable=o&&"auto"===o.display,d._visible=s.visible(),r|=d._hidable;r&&function Y(t){var r,i,a,s,o,d,v;for(r=0,i=t.length;r<i;++r)(s=(a=t[r]).$layout)._visible&&(v=new Proxy(a._el,{get:(k,y)=>k.getProps([y],!0)[y]}),o=a.geometry(),d=X(v,a.model(),o),s._box.update(d,o,a.rotation()));(function te(t,r){var i,a,s,o;for(i=t.length-1;i>=0;--i)for(s=t[i].$layout,a=i-1;a>=0&&s._visible;--a)(o=t[a].$layout)._visible&&s._box.intersects(o._box)&&r(s,o)})(t,function(k,y){var M=k._hidable,U=y._hidable;M&&U||U?y._visible=!1:M&&(k._visible=!1)})}(t)},lookup:function(t,r){var i,a;for(i=t.length-1;i>=0;--i)if((a=t[i].$layout)&&a._visible&&a._box.contains(r))return t[i];return null},draw:function(t,r){var i,a,s,o,d,v;for(i=0,a=r.length;i<a;++i)(o=(s=r[i]).$layout)._visible&&(d=s.geometry(),v=X(s._el,s.model(),d),o._box.update(v,d,s.rotation()),s.draw(t,v))}},_="$datalabels",b="$default";function J(t,r,i){if(r){var o,a=i.$context,s=i.$groups;!r[s._set]||(o=r[s._set][s._key])&&!0===(0,c.O)(o,[a])&&(t[_]._dirty=!0,i.update(a))}}const le={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,c.k)(t))return null;var i,a,s,r=t;if((0,c.i)(t))if((0,c.k)(t.label))if((0,c.k)(t.r))for(r="",s=0,a=(i=Object.keys(t)).length;s<a;++s)r+=(0!==s?", ":"")+i[s]+": "+t[i[s]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[_]={_actives:[]}},beforeUpdate:function(t){var r=t[_];r._listened=!1,r._listeners={},r._datasets=[],r._labels=[]},afterDatasetUpdate:function(t,r,i){var U,ie,_e,pe,ce,me,de,re,a=r.index,s=t[_],o=s._datasets[a]=[],d=t.isDatasetVisible(a),v=t.data.datasets[a],k=function O(t,r){var o,d,i=t.datalabels,a={},s=[];return!1===i?null:(!0===i&&(i={}),r=(0,c.a2)({},[r,i]),o=r.labels||{},d=Object.keys(o),delete r.labels,d.length?d.forEach(function(v){o[v]&&s.push((0,c.a2)({},[r,o[v],{_key:v}]))}):s.push(r),a=s.reduce(function(v,k){return(0,c.D)(k.listeners||{},function(y,M){v[M]=v[M]||{},v[M][k._key||b]=y}),delete k.listeners,v},{}),{labels:s,listeners:a})}(v,i),y=r.meta.data||[],M=t.ctx;for(M.save(),U=0,_e=y.length;U<_e;++U)if((de=y[U])[_]=[],d&&de&&t.getDataVisibility(U)&&!de.skip)for(ie=0,pe=k.labels.length;ie<pe;++ie)me=(ce=k.labels[ie])._key,(re=new H(ce,M,de,U)).$groups={_set:a,_key:me||b},re.$context={active:!1,chart:t,dataIndex:U,dataset:v,datasetIndex:a},re.update(re.$context),de[_].push(re),o.push(re);M.restore(),(0,c.a2)(s._listeners,k.listeners,{merger:function(ue,he,fe){he[ue]=he[ue]||{},he[ue][r.index]=fe[ue],s._listened=!0}})},afterUpdate:function(t,r){t[_]._labels=A.prepare(t[_]._datasets,r)},afterDatasetsDraw:function(t){A.draw(t,t[_]._labels)},beforeEvent:function(t,r){if(t[_]._listened){var i=r.event;switch(i.type){case"mousemove":case"mouseout":!function se(t,r){var s,o,i=t[_],a=i._listeners;if(a.enter||a.leave){if("mousemove"===r.type)o=A.lookup(i._labels,r);else if("mouseout"!==r.type)return;s=i._hovered,i._hovered=o,function z(t,r,i,a){var s,o;!i&&!a||(i?a?i!==a&&(o=s=!0):o=!0:s=!0,o&&J(t,r.leave,i),s&&J(t,r.enter,a))}(t,a,s,o)}}(t,i);break;case"click":!function ne(t,r){var i=t[_],a=i._listeners.click,s=a&&A.lookup(i._labels,r);s&&J(t,a,s)}(t,i)}}},afterEvent:function(t){var o,d,v,k,y,M,U,r=t[_],s=function(t,r){var s,o,d,v,i=t.slice(),a=[];for(s=0,d=r.length;s<d;++s)-1===(o=i.indexOf(v=r[s]))?a.push([v,1]):i.splice(o,1);for(s=0,d=i.length;s<d;++s)a.push([i[s],-1]);return a}(r._actives,r._actives=t.getActiveElements());for(o=0,d=s.length;o<d;++o)if((y=s[o])[1])for(v=0,k=(U=y[0].element[_]||[]).length;v<k;++v)(M=U[v]).$context.active=1===y[1],M.update(M.$context);(r._dirty||s.length)&&(A.update(r._labels),t.render()),delete r._dirty}}}}]);