"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[136],{3177:(G,F,d)=>{d.d(F,{m:()=>K});var h=d(4274),e=d(4893),Z=d(4267),q=d(3305);const J=["myAreaChart"];let K=(()=>{class L{constructor(C,_){this.historiqueService=C,this.serv=_}ngOnInit(){}ngAfterViewInit(){this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new h.Z(this.myAreaChart.nativeElement,{type:"line",data:{labels:[],datasets:[{label:"Maj necessaires",borderWidth:1,tension:.3,fill:!0,backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",pointRadius:5,pointBackgroundColor:"rgba(179,0,102,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(179,0,102,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj \xe9chou\xe9s",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",pointRadius:5,pointBackgroundColor:"rgba(210,7,7,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(210,7,7,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj inconnus",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",pointRadius:5,pointBackgroundColor:"rgba(103,114,105,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(103,114,105,1)",pointHitRadius:50,pointBorderWidth:2,data:[]}]},options:{scales:{xAxes:{time:{unit:"day"},grid:{display:!1},ticks:{autoSkip:!0,maxRotation:45,minRotation:45,maxTicksLimit:20}},y:{min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}}}),this.historique$.subscribe(C=>{var _,v,p,T,P,S,x,l,b,m,A,U,B,w;null===(v=null===(_=this.chart.data.datasets)||void 0===_?void 0:_[0].data)||void 0===v||v.splice(0,null===(T=null===(p=this.chart.data.datasets)||void 0===p?void 0:p[0].data)||void 0===T?void 0:T.length),null===(S=null===(P=this.chart.data.datasets)||void 0===P?void 0:P[1].data)||void 0===S||S.splice(0,null===(l=null===(x=this.chart.data.datasets)||void 0===x?void 0:x[1].data)||void 0===l?void 0:l.length),null===(m=null===(b=this.chart.data.datasets)||void 0===b?void 0:b[2].data)||void 0===m||m.splice(0,null===(U=null===(A=this.chart.data.datasets)||void 0===A?void 0:A[2].data)||void 0===U?void 0:U.length),null===(B=this.chart.data.labels)||void 0===B||B.splice(0,null===(w=this.chart.data.labels)||void 0===w?void 0:w.length);var u=0;C.forEach(H=>{var j,N,Y,E,I,f,k;null===(j=this.chart.data.labels)||void 0===j||j.push(H.date);var D=0,W=0,X=0;H.serveurs.forEach(z=>{D+=z.kb_inconnus,W+=z.kb_failed,X+=z.kb_manquantes}),null===(Y=null===(N=this.chart.data.datasets)||void 0===N?void 0:N[0].data)||void 0===Y||Y.push(X),null===(I=null===(E=this.chart.data.datasets)||void 0===E?void 0:E[1].data)||void 0===I||I.push(W),null===(k=null===(f=this.chart.data.datasets)||void 0===f?void 0:f[2].data)||void 0===k||k.push(D),D>=u&&(u=D),W>=u&&(u=W),X>=u&&(u=X),function $(L,M){L.options.scales.y={min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}(this.chart)}),this.chart.update()})}}return L.\u0275fac=function(C){return new(C||L)(e.Y36(Z.J),e.Y36(q.t))},L.\u0275cmp=e.Xpm({type:L,selectors:[["sb-charts-area"]],viewQuery:function(C,_){if(1&C&&e.Gf(J,5),2&C){let v;e.iGM(v=e.CRH())&&(_.myAreaChart=v.first)}},decls:2,vars:0,consts:[["myAreaChart",""]],template:function(C,_){1&C&&e._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),L})()},6021:(G,F,d)=>{d.d(F,{e:()=>K});var h=d(829),e=d(1013),Z=d(4893),q=d(4267);const J=["myBarChart"];let K=(()=>{class ${constructor(M){this.historiqueService=M}ngOnInit(){}ngAfterViewInit(){var M;let C;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new h.kL(this.myBarChart.nativeElement,{type:"bar",plugins:[e.Z],data:{datasets:[]},options:{plugins:{datalabels:{color:"#236be8"}}}}),null!=this.osSelected&&(C=null===(M=this.osSelected)||void 0===M?void 0:M.split("_")),this.historique$.subscribe(_=>{var v,p,T,P,S,x,l=0;if("TOUT"!=this.historiqueService.dateselected_debut&&"TOUT"!=this.historiqueService.dateselected_fin)null===(v=this.chart.data.datasets)||void 0===v||v.splice(0,null===(p=this.chart.data.datasets)||void 0===p?void 0:p.length),null===(T=this.chart.data.labels)||void 0===T||T.splice(0,null===(P=this.chart.data.labels)||void 0===P?void 0:P.length),this.chart.data={labels:["Avant","Apr\xe8s"],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9s",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnus",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]},_.forEach(m=>{var A,U,B,w,u,H,j,N,Y,E,I,f,k=0,D=0,W=0;m.serveurs.forEach(z=>{null!=z.kb_inconnus&&(k+=z.kb_inconnus),null!=z.kb_failed&&(D+=z.kb_failed),null!=z.kb_manquantes&&(W+=z.kb_manquantes)});let X=new Date(m.date);X.setHours(0),this.historiqueService.dateselected_debut instanceof Date&&X.getTime()==this.historiqueService.dateselected_debut.getTime()&&(null===(U=null===(A=this.chart.data.datasets)||void 0===A?void 0:A[0].data)||void 0===U||U.push(W),null===(w=null===(B=this.chart.data.datasets)||void 0===B?void 0:B[1].data)||void 0===w||w.push(D),null===(H=null===(u=this.chart.data.datasets)||void 0===u?void 0:u[2].data)||void 0===H||H.push(k)),this.historiqueService.dateselected_fin instanceof Date&&X.getTime()==this.historiqueService.dateselected_fin.getTime()&&(null===(N=null===(j=this.chart.data.datasets)||void 0===j?void 0:j[0].data)||void 0===N||N.push(W),null===(E=null===(Y=this.chart.data.datasets)||void 0===Y?void 0:Y[1].data)||void 0===E||E.push(D),null===(f=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[2].data)||void 0===f||f.push(k)),k>=l&&(l=k),D>=l&&(l=D),W>=l&&(l=W)}),null==this.chart.options.scales&&(this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*l),grid:{display:!0}}}}),this.chart.update();else{null===(S=this.chart.data.datasets)||void 0===S||S.splice(0,null===(x=this.chart.data.datasets)||void 0===x?void 0:x.length),this.chart.data={labels:[],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9s",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnus",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]};var b=[];_.forEach(m=>{let A=new Date(m.date).toLocaleString("default",{month:"short"});this.moisInTab(b,A)||b.push({nom:A,kb_failed:0,kb_necessaire:0,kb_unkown:0,nbr_histo:0});var U=0,B=0,w=0;m.serveurs.forEach(u=>{null!=C&&C[0].includes("alco")&&C[1].includes("windows")?!(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("alco")&&(null!=u.kb_inconnus&&(U+=u.kb_inconnus),null!=u.kb_failed&&(B+=u.kb_failed),null!=u.kb_manquantes&&(w+=u.kb_manquantes)):null!=C&&C[0].includes("alco")&&C[1].includes("linux")?(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("alco")&&(null!=u.kb_inconnus&&(U+=u.kb_inconnus),null!=u.kb_failed&&(B+=u.kb_failed),null!=u.kb_manquantes&&(w+=u.kb_manquantes)):null!=C&&C[0].includes("heberge")&&C[1].includes("windows")?!(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("heberge")&&(null!=u.kb_inconnus&&(U+=u.kb_inconnus),null!=u.kb_failed&&(B+=u.kb_failed),null!=u.kb_manquantes&&(w+=u.kb_manquantes)):null!=C&&C[0].includes("heberge")&&C[1].includes("linux")?(u.OS.includes("Linux")||u.OS.includes("CentOS")||u.OS.includes("VMware Photon")||u.os_quick.includes("linux"))&&u.position.includes("heberge")&&(null!=u.kb_inconnus&&(U+=u.kb_inconnus),null!=u.kb_failed&&(B+=u.kb_failed),null!=u.kb_manquantes&&(w+=u.kb_manquantes)):(null!=u.kb_inconnus&&(U+=u.kb_inconnus),null!=u.kb_failed&&(B+=u.kb_failed),null!=u.kb_manquantes&&(w+=u.kb_manquantes))});for(let u=0;u<b.length;u++)b[u].nom==A&&(b[u].kb_failed+=B,b[u].kb_necessaire+=w,b[u].kb_unkown+=U)}),b.forEach(m=>{var A,U,B,w,u,H,j;m.kb_failed=Math.round(m.kb_failed/(m.nbr_histo+1)),m.kb_necessaire=Math.round(m.kb_necessaire/(m.nbr_histo+1)),m.kb_unkown=Math.round(m.kb_unkown/(m.nbr_histo+1)),null===(A=this.chart.data.labels)||void 0===A||A.push(m.nom),null===(B=null===(U=this.chart.data.datasets)||void 0===U?void 0:U[0].data)||void 0===B||B.push(m.kb_necessaire),null===(u=null===(w=this.chart.data.datasets)||void 0===w?void 0:w[1].data)||void 0===u||u.push(m.kb_failed),null===(j=null===(H=this.chart.data.datasets)||void 0===H?void 0:H[2].data)||void 0===j||j.push(m.kb_unkown),m.kb_unkown>=l&&(l=m.kb_unkown),m.kb_failed>=l&&(l=m.kb_failed),m.kb_necessaire>=l&&(l=m.kb_necessaire)}),null==this.chart.options.scales&&(this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*l),grid:{display:!0}}}}),this.chart.update()}})}moisInTab(M,C){for(let _=0;_<M.length;_++)if(M[_].nom==C)return M[_].nbr_histo++,!0;return!1}}return $.\u0275fac=function(M){return new(M||$)(Z.Y36(q.J))},$.\u0275cmp=Z.Xpm({type:$,selectors:[["sb-charts-bar"]],viewQuery:function(M,C){if(1&M&&Z.Gf(J,5),2&M){let _;Z.iGM(_=Z.CRH())&&(C.myBarChart=_.first)}},inputs:{osSelected:"osSelected"},decls:2,vars:0,consts:[["myBarChart",""]],template:function(M,C){1&M&&Z._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),$})()},9410:(G,F,d)=>{d.d(F,{y:()=>M});var h=d(829),e=d(1013),Z=d(1135),q=d(4893),J=d(3305),K=d(7979),$=d(757);const L=["myPieChart"];let M=(()=>{class C{constructor(v,p,T){this.serveursService=v,this.route=p,this.userProfilService=T,this.lesServeurs=new Z.X([]),this.kb_verte=0,this.kb_orange=0,this.kb_rouge=0,this.serveurs$=this.serveursService.messerveurs$,this.serveurs$.subscribe(P=>{this.lesServeurs.next(P)})}ngOnChanges(v){this.lesServeurs.next([])}ngOnInit(){}ngAfterViewChecked(){var v=this.route;this.userProfilService.get_user_profil().subscribe(p=>{this.chart=new h.kL(this.myPieChart.nativeElement,{type:"pie",data:{labels:["Serveurs n\xe9c\xe9ssitant > "+p.serveursAlerte+" Maj","Serveurs n\xe9c\xe9ssitant "+p.serveursBon+" \xe0 "+p.serveursAlerte+" Maj","Serveurs n\xe9c\xe9ssitant < "+p.serveursBon+" Maj"],datasets:[{data:[],backgroundColor:["#dc3545","#ffc107","#28a745"]}]},options:{responsive:!0,aspectRatio:2,animation:{easing:"linear"}},plugins:[e.Z]}),this.lesServeurs.subscribe(T=>{var P;this.chart.data.datasets[0].data=[];let S,x=T.length;null!=this.osSelected&&(S=null===(P=this.osSelected)||void 0===P?void 0:P.split("_")),null!=S&&S[0].includes("alco")&&S[1].includes("windows")&&(x=0,T.forEach(l=>{!(l.OS.includes("Linux")||l.OS.includes("CentOS")||l.OS.includes("VMware Photon")||l.os_quick.includes("linux"))&&l.position.includes("alco")&&(l.kb_manquantes<p.serveursBon?this.kb_verte+=1:l.kb_manquantes>=p.serveursBon&&l.kb_manquantes<p.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=S&&S[0].includes("alco")&&S[1].includes("linux")&&(x=0,T.forEach(l=>{(l.OS.includes("Linux")||l.OS.includes("CentOS")||l.OS.includes("VMware Photon")||l.os_quick.includes("linux"))&&l.position.includes("alco")&&(l.kb_manquantes<p.serveursBon?this.kb_verte+=1:l.kb_manquantes>=p.serveursBon&&l.kb_manquantes<p.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=S&&S[0].includes("heberge")&&S[1].includes("windows")&&(x=0,T.forEach(l=>{!(l.OS.includes("Linux")||l.OS.includes("CentOS")||l.OS.includes("VMware Photon")||l.os_quick.includes("linux"))&&l.position.includes("heberge")&&(l.kb_manquantes<p.serveursBon?this.kb_verte+=1:l.kb_manquantes>=p.serveursBon&&l.kb_manquantes<p.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),null!=S&&S[0].includes("heberge")&&S[1].includes("linux")&&(x=0,T.forEach(l=>{(l.OS.includes("Linux")||l.OS.includes("CentOS")||l.OS.includes("VMware Photon")||l.os_quick.includes("linux"))&&l.position.includes("heberge")&&(l.kb_manquantes<p.serveursBon?this.kb_verte+=1:l.kb_manquantes>=p.serveursBon&&l.kb_manquantes<p.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,x++)})),this.chart.data.datasets[0].data.push(this.kb_rouge),this.chart.data.datasets[0].data.push(this.kb_orange),this.chart.data.datasets[0].data.push(this.kb_verte),this.chart.options={responsive:!0,aspectRatio:2,plugins:{legend:{position:"right"},datalabels:{color:"black",font:{weight:"bold",size:16},formatter:(l,b)=>{const A=(l/x*100).toFixed(1);return l/T.length*100<8?null:`${A}%`}},tooltip:{callbacks:{label:function(l){return" "+l.formattedValue+" Serveurs, soit : "+(parseInt(l.formattedValue)/x*100).toFixed(1)+"%"}},displayColors:!1}},elements:{point:{radius:0}},onClick:function(l){v.navigate(["patchManagement/serveurs/Alco_Windows"])},animation:{easing:"linear"}},this.chart.update(),this.chart.resize()})})}}return C.\u0275fac=function(v){return new(v||C)(q.Y36(J.t),q.Y36(K.F0),q.Y36($.gb))},C.\u0275cmp=q.Xpm({type:C,selectors:[["sb-charts-pie"]],viewQuery:function(v,p){if(1&v&&q.Gf(L,5),2&v){let T;q.iGM(T=q.CRH())&&(p.myPieChart=T.first)}},inputs:{osSelected:"osSelected"},features:[q.TTD],decls:2,vars:0,consts:[["width","100%","height","100%"],["myPieChart",""]],template:function(v,p){1&v&&q._UZ(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),C})()},3678:(G,F,d)=>{d.d(F,{L:()=>L});var h=d(7751),e=d(4893),Z=d(4267),q=d(2382),J=d(9444);function K(M,C){if(1&M){const _=e.EpF();e.TgZ(0,"span",14),e.NdJ("mouseenter",function(){const T=e.CHM(_).$implicit;return e.oxw().hoveredDate=T})("mouseleave",function(){return e.CHM(_),e.oxw().hoveredDate=null}),e._uU(1),e.qZA()}if(2&M){const _=C.$implicit,v=C.focused,p=e.oxw();e.ekj("focused",v)("range",p.isRange(_))("faded",p.isHovered(_)||p.isInside(_)),e.xp6(1),e.hij(" ",_.day," ")}}const $=function(){return["fas","table"]};let L=(()=>{class M{constructor(_,v,p){this.calendar=_,this.formatter=v,this.historiqueService=p,this.hoveredDate=null,this.fromDate=null,this.toDate=null}onDateSelection(_){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&_&&_.after(this.fromDate)?this.toDate=_:(this.toDate=null,this.fromDate=_):this.fromDate=_}isHovered(_){return this.fromDate&&!this.toDate&&this.hoveredDate&&_.after(this.fromDate)&&_.before(this.hoveredDate)}isInside(_){return this.toDate&&_.after(this.fromDate)&&_.before(this.toDate)}isRange(_){return _.equals(this.fromDate)||this.toDate&&_.equals(this.toDate)||this.isInside(_)||this.isHovered(_)}validateInput(_,v){const p=this.formatter.parse(v);return p&&this.calendar.isValid(h.qj.from(p))?h.qj.from(p):_}eventChange(){this.historiqueService.dateSelected_debut=null==this.fromDate?null:new Date(this.fromDate.year,this.fromDate.month-1,this.fromDate.day),this.historiqueService.dateSelected_fin=null==this.toDate?null:new Date(this.toDate.year,this.toDate.month-1,this.toDate.day)}ngOnInit(){}}return M.\u0275fac=function(_){return new(_||M)(e.Y36(h.vL),e.Y36(h.NG),e.Y36(Z.J))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-date-picker"]],decls:19,vars:8,consts:[[1,"form-inline"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"autoClose","displayMonths","dayTemplate","startDate","dateSelect"],["datepicker","ngbDatepicker"],["t",""],[1,"input-group","mr-2"],["placeholder","D\xe9but","name","dpFromDate",1,"form-control",3,"value","input"],["dpFromDate",""],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[1,"mr-1",3,"icon"],["placeholder","Fin","name","dpToDate",1,"form-control",3,"value","input"],["dpToDate",""],["type","button",1,"btn","btn-outline-primary","ml-2",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(_,v){if(1&_){const p=e.EpF();e.TgZ(0,"form",0)(1,"div")(2,"div",1)(3,"div",2)(4,"input",3,4),e.NdJ("dateSelect",function(P){return v.onDateSelection(P),v.eventChange()}),e.qZA(),e.YNc(6,K,2,7,"ng-template",null,5,e.W1O),e.qZA()(),e.TgZ(8,"div",6)(9,"input",7,8),e.NdJ("input",function(){e.CHM(p);const P=e.MAs(10);return v.fromDate=v.validateInput(v.fromDate,P.value)}),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(){return e.CHM(p),e.MAs(5).toggle()}),e._UZ(12,"fa-icon",10),e.qZA()()(),e.TgZ(13,"div")(14,"div",2)(15,"input",11,12),e.NdJ("input",function(){e.CHM(p);const P=e.MAs(16);return v.toDate=v.validateInput(v.toDate,P.value)}),e.qZA(),e.TgZ(17,"button",13),e.NdJ("click",function(){return v.fromDate=null,v.toDate=null,v.eventChange()}),e._uU(18,"Reset"),e.qZA()()()()}if(2&_){const p=e.MAs(7);e.xp6(4),e.Q6J("autoClose","outside")("displayMonths",1)("dayTemplate",p)("startDate",v.fromDate),e.xp6(5),e.Q6J("value",v.formatter.format(v.fromDate)),e.xp6(3),e.Q6J("icon",e.DdM(7,$)),e.xp6(3),e.Q6J("value",v.formatter.format(v.toDate))}},directives:[q._Y,q.JL,q.F,h.J4,J.BN],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]}),M})()},858:(G,F,d)=>{d.d(F,{p:()=>Y});var h=d(1135),e=d(4893),Z=d(4267),q=d(3154),J=d(7979),K=d(5278),$=d(5212),L=d(6333),M=d(2382),C=d(9444),_=d(9808),v=d(3678),p=d(3177),T=d(6021);const P=function(){return["fab","windows"]};function S(E,I){if(1&E){const f=e.EpF();e.TgZ(0,"div",25)(1,"div",26),e._UZ(2,"fa-icon",14),e._uU(3,"Windows"),e.qZA(),e.TgZ(4,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="Production"}),e._uU(7,"Prod"),e.qZA(),e.TgZ(8,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="Pre-production"}),e._uU(9,"Pre-Prod"),e.qZA(),e.TgZ(10,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="Recette-Formation"}),e._uU(11,"Rec-Form"),e.qZA(),e.TgZ(12,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="BDD"}),e._uU(13,"BDD"),e.qZA(),e.TgZ(14,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="BDD-Recette"}),e._uU(15,"BDD-Rec"),e.qZA(),e.TgZ(16,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="DMZ"}),e._uU(17,"DMZ"),e.qZA()()}2&E&&(e.xp6(2),e.Q6J("icon",e.DdM(1,P)))}const x=function(){return["fab","linux"]};function l(E,I){if(1&E){const f=e.EpF();e.TgZ(0,"div",28)(1,"div",26),e._UZ(2,"fa-icon",14),e._uU(3,"Linux"),e.qZA(),e.TgZ(4,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="BDD-PRODPRE"}),e._uU(7,"BDD-ProPre"),e.qZA(),e.TgZ(8,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="BDD-RECFOR"}),e._uU(9,"BDD-RECFOR"),e.qZA(),e.TgZ(10,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="PROD-PRE"}),e._uU(11,"PROD-PRE"),e.qZA(),e.TgZ(12,"button",27),e.NdJ("click",function(){return e.CHM(f),e.oxw(2).historiqueService.typeselected="REC-FOR"}),e._uU(13,"REC-FOR"),e.qZA()()}2&E&&(e.xp6(2),e.Q6J("icon",e.DdM(1,x)))}function b(E,I){if(1&E&&(e.TgZ(0,"div",22),e.YNc(1,S,18,2,"div",23),e.YNc(2,l,14,2,"div",24),e.qZA()),2&E){const f=I.ngIf;e.xp6(1),e.Q6J("ngIf","Alco_Windows"==f),e.xp6(1),e.Q6J("ngIf","Alco_Linux"==f)}}function m(E,I){if(1&E&&(e.TgZ(0,"span",15),e._uU(1,"Total historiques: "),e.TgZ(2,"span",29),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&E){const f=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,f.historiqueService.total$))}}const A=function(){return["fas","xmark"]};function U(E,I){if(1&E){const f=e.EpF();e.TgZ(0,"li",30),e._uU(1),e.TgZ(2,"span",31),e.NdJ("click",function(){const W=e.CHM(f).$implicit;return e.oxw().deleteItem(W)}),e._UZ(3,"fa-icon",6),e.qZA()()}if(2&E){const f=I.$implicit;e.xp6(1),e.Oqu(f),e.xp6(2),e.Q6J("icon",e.DdM(2,A))}}function B(E,I){1&E&&(e.TgZ(0,"div",32)(1,"div",33),e._uU(2," Chargement ... "),e.qZA()())}function w(E,I){if(1&E&&(e.TgZ(0,"p",34),e._uU(1),e.qZA()),2&E){const f=I.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",f,"h")}}function u(E,I){1&E&&(e.TgZ(0,"div",32)(1,"div",33),e._uU(2," Chargement ... "),e.qZA()())}function H(E,I){if(1&E&&(e.TgZ(0,"p",34),e._uU(1),e.qZA()),2&E){const f=I.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",f,"h")}}const j=function(){return["fas","search"]},N=function(){return["fas","chart-area"]};let Y=(()=>{class E{constructor(f,k,D){this.historiqueService=f,this.horaireMajService=k,this.route=D,this.pageSize=4,this.maRecherche=Array(),this.search="",this.title="Nombres de patchs /mois",this.horaireMaj=new h.X(""),this.osSelected=new h.X("All")}ngOnDestroy(){this.search="",this.maRecherche.splice(0,this.maRecherche.length),this.historiqueService.serveursselected=[]}ngOnInit(){this.horaireMajService.getHoraireMaj().subscribe(f=>{console.log("horaire: "+f),this.horaireMaj.next(f)}),this.route.params.subscribe(f=>{null!=f.OSSelected&&(this.osSelected.next(f.OSSelected),this.osSelected.subscribe(k=>{this.historiqueService.OSSelected=k}))})}RemoveElementFromArray(f){this.maRecherche.forEach((k,D)=>{k==f&&this.maRecherche.splice(D,1)})}deleteItem(f){this.RemoveElementFromArray(f);var k=this.historiqueService.serveursselected;k.forEach((D,W)=>{D==f&&k.splice(W,1)}),this.historiqueService.serveursselected=k}ajout(){this.maRecherche.push(this.search);var f=this.historiqueService.serveursselected;f.push(this.search),this.historiqueService.serveursselected=f}}return E.\u0275fac=function(f){return new(f||E)(e.Y36(Z.J),e.Y36(q.w),e.Y36(J.gz))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-historique"]],inputs:{pageSize:"pageSize"},decls:49,vars:28,consts:[["title","Historique",3,"hideBreadcrumbs"],[1,"card-body"],[1,"form-group","form-inline"],["type","text","name","searchTerm",1,"form-control","ml-1",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],["class","ml-2 btn-toolbar","role","toolbar","aria-label","Toolbar with button groups",4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3","list-group","list-group-horizontal"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"row"],[1,"col-lg-6"],[1,"card-header","form-inline"],[1,"mr-1",3,"icon"],[1,"ml-3"],["class","progress ml-1",4,"ngIf"],[1,"card-footer","small","text-muted","d-flex","d-flex","justify-content-between"],["class","ml-auto",4,"ngIf"],["id","#title"],[1,"ml-0",2,"visibility","hidden"],[1,"card-footer","small","text-muted","d-flex","mb-0"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["class","btn-group me-2","role","group","aria-label","First group",4,"ngIf"],["class","btn-group me-2 ml-2","role","group","aria-label","Third group",4,"ngIf"],["role","group","aria-label","First group",1,"btn-group","me-2"],[1,"btn"],["type","button",1,"btn","btn-outline-info",3,"click"],["role","group","aria-label","Third group",1,"btn-group","me-2","ml-2"],[1,"font-weight-bold"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ml-3",3,"click"],[1,"progress","ml-1"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","100%"],[1,"ml-auto"]],template:function(f,k){1&f&&(e.TgZ(0,"sb-layout-dashboard"),e._UZ(1,"sb-dashboard-head",0),e.TgZ(2,"sb-card")(3,"div",1)(4,"form")(5,"div",2),e._uU(6,"Recherche: "),e.TgZ(7,"input",3),e.NdJ("ngModelChange",function(W){return k.search=W}),e.qZA(),e.TgZ(8,"div",4)(9,"button",5),e.NdJ("click",function(){return k.ajout()}),e._UZ(10,"fa-icon",6),e.qZA()(),e.YNc(11,b,3,2,"div",7),e.ALo(12,"async"),e.YNc(13,m,5,3,"span",8),e.ALo(14,"async"),e.TgZ(15,"ul",9),e.YNc(16,U,4,3,"li",10),e.qZA()()()()(),e.TgZ(17,"div",11)(18,"div",12)(19,"sb-card")(20,"div",13),e._UZ(21,"fa-icon",14),e.TgZ(22,"span"),e._uU(23,"Intervalle: "),e.qZA(),e._UZ(24,"app-date-picker",15),e.qZA(),e.TgZ(25,"div",1),e.YNc(26,B,3,0,"div",16),e.ALo(27,"async"),e._UZ(28,"sb-charts-area"),e.qZA(),e.TgZ(29,"div",17),e._uU(30,"Mise \xe0 jour /jour "),e.YNc(31,w,2,1,"p",18),e.ALo(32,"async"),e.qZA()()(),e.TgZ(33,"div",12)(34,"sb-card")(35,"div",13),e._UZ(36,"fa-icon",14),e.TgZ(37,"span",19),e._uU(38),e.qZA(),e._UZ(39,"app-date-picker",20),e.qZA(),e.TgZ(40,"div",1),e.YNc(41,u,3,0,"div",16),e.ALo(42,"async"),e._UZ(43,"sb-charts-bar"),e.qZA(),e.TgZ(44,"div",21)(45,"p"),e._uU(46,"Mise \xe0 jour /mois (moyenne)"),e.qZA(),e.YNc(47,H,2,1,"p",18),e.ALo(48,"async"),e.qZA()()()()()),2&f&&(e.xp6(1),e.Q6J("hideBreadcrumbs",!1),e.xp6(6),e.Q6J("ngModel",k.search),e.xp6(3),e.Q6J("icon",e.DdM(25,j)),e.xp6(1),e.Q6J("ngIf",e.lcZ(12,13,k.osSelected)),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,15,k.historiqueService.total$)),e.xp6(3),e.Q6J("ngForOf",k.maRecherche),e.xp6(5),e.Q6J("icon",e.DdM(26,N)),e.xp6(5),e.Q6J("ngIf",e.lcZ(27,17,k.historiqueService.loading$)),e.xp6(5),e.Q6J("ngIf",e.lcZ(32,19,k.horaireMaj)),e.xp6(5),e.Q6J("icon",e.DdM(27,N)),e.xp6(2),e.Oqu(k.title),e.xp6(3),e.Q6J("ngIf",e.lcZ(42,21,k.historiqueService.loading$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(48,23,k.horaireMaj)))},directives:[K.Q,$.T,L.A,M._Y,M.JL,M.F,M.Fj,M.JJ,M.On,C.BN,_.O5,_.sg,v.L,p.m,T.e],pipes:[_.Ov],styles:["button[_ngcontent-%COMP%]:focus{color:#fff;background-color:#17a2b8;box-shadow:none}button[_ngcontent-%COMP%]{border:.5px solid #17a2b8!important}"],changeDetection:0}),E})()},9136:(G,F,d)=>{d.d(F,{e:()=>p});var h=d(9808),e=d(7979),Z=d(2382),q=d(2539),J=d(5592),K=d(4267),$=d(4893);d(858),d(3177),d(6021),d(9410),d(3678);let p=(()=>{class T{}return T.\u0275fac=function(S){return new(S||T)},T.\u0275mod=$.oAB({type:T}),T.\u0275inj=$.cJS({providers:[h.JJ,...K.u],imports:[[h.ez,e.Bz,Z.UX,Z.u5,q.n,J.A]]}),T})()},4267:(G,F,d)=>{d.d(F,{J:()=>P,u:()=>S});var h=d(1135),e=d(7579),Z=d(8505),q=d(8372),J=d(3900),K=d(4825),$=d(9646),L=d(4893),M=d(9808),C=d(520);let P=(()=>{class x{constructor(b,m){this.pipe=b,this.http=m,this._loading$=new h.X(!0),this._search$=new e.x,this._mesHisto$=new e.x,this._historique$=new h.X([]),this._total$=new h.X(0),this.baseURL="https://172.17.2.130/",this._state={dateSelected_debut:"TOUT",dateSelected_fin:"TOUT",typeSelected:"Tous",serveursSelected:[],OSSelected:"Alco_Windows"},this._search$.pipe((0,Z.b)(()=>this._loading$.next(!0)),(0,q.b)(120),(0,J.w)(()=>this.get_historiques()),(0,K.g)(120),(0,Z.b)(()=>this._loading$.next(!1))).subscribe(A=>{this._mesHisto$.next(A)}),this._mesHisto$.pipe((0,Z.b)(()=>this._loading$.next(!0)),(0,q.b)(120),(0,J.w)(A=>this._search(A)),(0,K.g)(120),(0,Z.b)(()=>this._loading$.next(!1))).subscribe(A=>{this._historique$.next(A.historiques),this._total$.next(A.total)}),this._search$.next()}get meshistorique$(){return this._mesHisto$.asObservable()}get historique$(){return this._historique$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get dateselected_debut(){return this._state.dateSelected_debut}get dateselected_fin(){return this._state.dateSelected_fin}set dateSelected_debut(b){this._set(null==b?{dateSelected_debut:"TOUT"}:{dateSelected_debut:b})}set dateSelected_fin(b){this._set(null==b?{dateSelected_fin:"TOUT"}:{dateSelected_fin:b})}get typeselected(){return this._state.typeSelected}set typeselected(b){this._set({typeSelected:b})}get serveursselected(){return this._state.serveursSelected}set serveursselected(b){this._set({serveursSelected:b})}set OSSelected(b){this._set({OSSelected:b})}_set(b){Object.assign(this._state,b),this._search$.next()}_search(b){const{dateSelected_debut:m,dateSelected_fin:A,typeSelected:U,serveursSelected:B}=this._state;let w=b;return w=w.filter(H=>function p(x,l,b){let m=new Date(x.date);if(m.setHours(0),"TOUT"==l&&"TOUT"==b)return!0;if("TOUT"==l&&b instanceof Date)return m.getTime()===b.getTime();if(l instanceof Date&&"TOUT"==b)return m.getTime()===l.getTime();if(l instanceof Date&&b instanceof Date)return m.getTime()>=l.getTime()&&m.getTime()<=b.getTime();throw console.error("Erreur Date type")}(H,m,A)),w.forEach(H=>{H.serveurs=H.serveurs.filter(j=>function _(x,l){return"Tous"==l||x.type==l}(j,U))}),w.forEach(H=>{H.serveurs=H.serveurs.filter(j=>function v(x,l,b){if(0==l.length)return!0;let m=!1;return l.forEach(A=>{1==function T(x,l,b){return x.name.toLowerCase().includes(l.toLowerCase())||x.type.toLowerCase().includes(l.toLowerCase())||x.ip.toLowerCase().includes(l.toLowerCase())||x.OS.toLowerCase().includes(l.toLowerCase())||x.description.toLowerCase().includes(l.toLowerCase())||b.transform(x.kb_manquantes).includes(l)||b.transform(x.kb_failed).includes(l)||b.transform(x.kb_inconnus).includes(l)||x.date_dernier_update.toLocaleLowerCase().includes(l.toLocaleLowerCase())||x.date_last_rapport.toLowerCase().includes(l.toLowerCase())}(x,A,b)&&(m=!0)}),m}(j,B,this.pipe))}),w=w.filter(H=>H.serveurs.length>0),(0,$.of)({historiques:w,total:w.length})}get_historiques(){try{return this.http.get(this.baseURL+"servNode/historiques/"+this._state.OSSelected,{withCredentials:!0})}catch(b){throw{msg:"Erreur get_serveurs(): "+b}}}}return x.\u0275fac=function(b){return new(b||x)(L.LFG(M.JJ),L.LFG(C.eN))},x.\u0275prov=L.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})();const S=[P]},1013:(G,F,d)=>{d.d(F,{Z:()=>ve});var h=d(5081),e=d(829),Z=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),q_textSize=function(t,n,i){var c,a=[].concat(n),r=a.length,o=t.font,s=0;for(t.font=i.string,c=0;c<r;++c)s=Math.max(t.measureText(a[c]).width,s);return t.font=o,{height:r*i.lineHeight,width:s}};function J(t,n){var i=n.x,a=n.y;if(null===i)return{x:0,y:-1};if(null===a)return{x:1,y:0};var r=t.x-i,o=t.y-a,s=Math.sqrt(r*r+o*o);return{x:s?r/s:0,y:s?o/s:-1}}function v(t,n,i){var a=0;return t<i.left?a|=1:t>i.right&&(a|=2),n<i.top?a|=8:n>i.bottom&&(a|=4),a}function T(t,n){var r,o,i=n.anchor,a=t;return n.clamp&&(a=function p(t,n){for(var g,y,O,i=t.x0,a=t.y0,r=t.x1,o=t.y1,s=v(i,a,n),c=v(r,o,n);s|c&&!(s&c);)8&(g=s||c)?(y=i+(r-i)*(n.top-a)/(o-a),O=n.top):4&g?(y=i+(r-i)*(n.bottom-a)/(o-a),O=n.bottom):2&g?(O=a+(o-a)*(n.right-i)/(r-i),y=n.right):1&g&&(O=a+(o-a)*(n.left-i)/(r-i),y=n.left),g===s?s=v(i=y,a=O,n):c=v(r=y,o=O,n);return{x0:i,x1:r,y0:a,y1:o}}(a,n.area)),"start"===i?(r=a.x0,o=a.y0):"end"===i?(r=a.x1,o=a.y1):(r=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function K(t,n,i,a,r){switch(r){case"center":i=a=0;break;case"bottom":i=0,a=1;break;case"right":i=1,a=0;break;case"left":i=-1,a=0;break;case"top":i=0,a=-1;break;case"start":i=-i,a=-a;break;case"end":break;default:r*=Math.PI/180,i=Math.cos(r),a=Math.sin(r)}return{x:t,y:n,vx:i,vy:a}}(r,o,t.vx,t.vy,n.align)}var P={arc:function(t,n){var i=(t.startAngle+t.endAngle)/2,a=Math.cos(i),r=Math.sin(i),o=t.innerRadius,s=t.outerRadius;return T({x0:t.x+a*o,y0:t.y+r*o,x1:t.x+a*s,y1:t.y+r*s,vx:a,vy:r},n)},point:function(t,n){var i=J(t,n.origin),a=i.x*t.options.radius,r=i.y*t.options.radius;return T({x0:t.x-a,y0:t.y-r,x1:t.x+a,y1:t.y+r,vx:i.x,vy:i.y},n)},bar:function(t,n){var i=J(t,n.origin),a=t.x,r=t.y,o=0,s=0;return t.horizontal?(a=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(r=Math.min(t.y,t.base),s=Math.abs(t.base-t.y)),T({x0:a,y0:r+s,x1:a+o,y1:r,vx:i.x,vy:i.y},n)},fallback:function(t,n){var i=J(t,n.origin);return T({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},n)}},S=function(t){return Math.round(t*Z)/Z};function l(t,n){var i=n.chart.getDatasetMeta(n.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var a=i.getBasePixel();return t.horizontal?{x:a,y:null}:{x:null,y:a}}function b(t){return t instanceof e.qi?P.arc:t instanceof e.od?P.point:t instanceof e.ZL?P.bar:P.fallback}function B(t,n,i){var a=t.shadowBlur,r=i.stroked,o=S(i.x),s=S(i.y),c=S(i.w);r&&t.strokeText(n,o,s,c),i.filled&&(a&&r&&(t.shadowBlur=0),t.fillText(n,o,s,c),a&&r&&(t.shadowBlur=a))}var u=function(t,n,i,a){var r=this;r._config=t,r._index=a,r._model=null,r._rects=null,r._ctx=n,r._el=i};(0,h.a2)(u.prototype,{_modelize:function(t,n,i,a){var r=this,o=r._index,s=(0,h.Z)((0,h.a)([i.font,{}],a,o)),c=(0,h.a)([i.color,e.ce.color],a,o);return{align:(0,h.a)([i.align,"center"],a,o),anchor:(0,h.a)([i.anchor,"center"],a,o),area:a.chart.chartArea,backgroundColor:(0,h.a)([i.backgroundColor,null],a,o),borderColor:(0,h.a)([i.borderColor,null],a,o),borderRadius:(0,h.a)([i.borderRadius,0],a,o),borderWidth:(0,h.a)([i.borderWidth,0],a,o),clamp:(0,h.a)([i.clamp,!1],a,o),clip:(0,h.a)([i.clip,!1],a,o),color:c,display:t,font:s,lines:n,offset:(0,h.a)([i.offset,0],a,o),opacity:(0,h.a)([i.opacity,1],a,o),origin:l(r._el,a),padding:(0,h.C)((0,h.a)([i.padding,0],a,o)),positioner:b(r._el),rotation:(0,h.a)([i.rotation,0],a,o)*(Math.PI/180),size:q_textSize(r._ctx,n,s),textAlign:(0,h.a)([i.textAlign,"start"],a,o),textShadowBlur:(0,h.a)([i.textShadowBlur,0],a,o),textShadowColor:(0,h.a)([i.textShadowColor,c],a,o),textStrokeColor:(0,h.a)([i.textStrokeColor,c],a,o),textStrokeWidth:(0,h.a)([i.textStrokeWidth,0],a,o)}},update:function(t){var s,c,g,n=this,i=null,a=null,r=n._index,o=n._config,y=(0,h.a)([o.display,!0],t,r);y&&(c=(0,h.v)((0,h.O)(o.formatter,[s=t.dataset.data[r],t]),s),(g=(0,h.k)(c)?[]:function(t){var i,n=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?n.unshift.apply(n,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):(0,h.k)(t)||n.unshift(""+i);return n}(c)).length&&(a=function x(t){var n=t.borderWidth||0,i=t.padding,a=t.size.height,r=t.size.width,o=-r/2,s=-a/2;return{frame:{x:o-i.left-n,y:s-i.top-n,w:r+i.width+2*n,h:a+i.height+2*n},text:{x:o,y:s,w:r,h:a}}}(i=n._modelize(y,g,o,t)))),n._model=i,n._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,n){var s,a=t.ctx,r=this._model,o=this._rects;!this.visible()||(a.save(),r.clip&&(s=r.area,a.beginPath(),a.rect(s.left,s.top,s.right-s.left,s.bottom-s.top),a.clip()),a.globalAlpha=function(t,n,i){return Math.max(t,Math.min(n,i))}(0,r.opacity,1),a.translate(S(n.x),S(n.y)),a.rotate(r.rotation),function A(t,n,i){var a=i.backgroundColor,r=i.borderColor,o=i.borderWidth;!a&&(!r||!o)||(t.beginPath(),function m(t,n,i,a,r,o){var s=Math.PI/2;if(o){var c=Math.min(o,r/2,a/2),g=n+c,y=i+c,O=n+a-c,R=i+r-c;t.moveTo(n,y),g<O&&y<R?(t.arc(g,y,c,-Math.PI,-s),t.arc(O,y,c,-s,0),t.arc(O,R,c,0,s),t.arc(g,R,c,s,Math.PI)):g<O?(t.moveTo(g,i),t.arc(O,y,c,-s,s),t.arc(g,y,c,s,Math.PI+s)):y<R?(t.arc(g,y,c,-Math.PI,0),t.arc(g,R,c,0,Math.PI)):t.arc(g,y,c,-Math.PI,Math.PI),t.closePath(),t.moveTo(n,i)}else t.rect(n,i,a,r)}(t,S(n.x)+o/2,S(n.y)+o/2,S(n.w)-o,S(n.h)-o,i.borderRadius),t.closePath(),a&&(t.fillStyle=a,t.fill()),r&&o&&(t.strokeStyle=r,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}(a,o.frame,r),function w(t,n,i,a){var V,r=a.textAlign,o=a.color,s=!!o,c=a.font,g=n.length,y=a.textStrokeColor,O=a.textStrokeWidth,R=y&&O;if(g&&(s||R))for(i=function U(t,n,i){var a=i.lineHeight,r=t.w,o=t.x;return"center"===n?o+=r/2:("end"===n||"right"===n)&&(o+=r),{h:a,w:r,x:o,y:t.y+a/2}}(i,r,c),t.font=c.string,t.textAlign=r,t.textBaseline="middle",t.shadowBlur=a.textShadowBlur,t.shadowColor=a.textShadowColor,s&&(t.fillStyle=o),R&&(t.lineJoin="round",t.lineWidth=O,t.strokeStyle=y),V=0,g=n.length;V<g;++V)B(t,n[V],{stroked:R,filled:s,w:i.w,x:i.x,y:i.y+i.h*V})}(a,r.lines,o.text,r),a.restore())}});var H=Number.MIN_SAFE_INTEGER||-9007199254740991,j=Number.MAX_SAFE_INTEGER||9007199254740991;function N(t,n,i){var a=Math.cos(i),r=Math.sin(i),o=n.x,s=n.y;return{x:o+a*(t.x-o)-r*(t.y-s),y:s+r*(t.x-o)+a*(t.y-s)}}function Y(t,n){var o,s,y,i=j,a=H,r=n.origin;for(o=0;o<t.length;++o)y=n.vx*((s=t[o]).x-r.x)+n.vy*(s.y-r.y),i=Math.min(i,y),a=Math.max(a,y);return{min:i,max:a}}function E(t,n){var i=n.x-t.x,a=n.y-t.y,r=Math.sqrt(i*i+a*a);return{vx:(n.x-t.x)/r,vy:(n.y-t.y)/r,origin:t,ln:r}}var I=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function f(t,n,i){var a=n.positioner(t,n),r=a.vx,o=a.vy;if(!r&&!o)return{x:a.x,y:a.y};var s=i.w,c=i.h,g=n.rotation,y=Math.abs(s/2*Math.cos(g))+Math.abs(c/2*Math.sin(g)),O=Math.abs(s/2*Math.sin(g))+Math.abs(c/2*Math.cos(g)),R=1/Math.max(Math.abs(r),Math.abs(o));return y*=r*R,O*=o*R,{x:a.x+(y+=n.offset*r),y:a.y+(O+=n.offset*o)}}(0,h.a2)(I.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,n,i){this._rotation=i,this._rect={x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},contains:function(t){var n=this,a=n._rect;return!((t=N(t,n.center(),-n._rotation)).x<a.x-1||t.y<a.y-1||t.x>a.x+a.w+2||t.y>a.y+a.h+2)},intersects:function(t){var r,o,s,n=this._points(),i=t._points(),a=[E(n[0],n[1]),E(n[0],n[3])];for(this._rotation!==t._rotation&&a.push(E(i[0],i[1]),E(i[0],i[3])),r=0;r<a.length;++r)if(o=Y(n,a[r]),s=Y(i,a[r]),o.max<s.min||s.max<o.min)return!1;return!0},_points:function(){var t=this,n=t._rect,i=t._rotation,a=t.center();return[N({x:n.x,y:n.y},a,i),N({x:n.x+n.w,y:n.y},a,i),N({x:n.x+n.w,y:n.y+n.h},a,i),N({x:n.x,y:n.y+n.h},a,i)]}});var W={prepare:function(t){var i,a,r,o,s,n=[];for(i=0,r=t.length;i<r;++i)for(a=0,o=t[i].length;a<o;++a)n.push(s=t[i][a]),s.$layout={_box:new I,_hidable:!1,_visible:!0,_set:i,_idx:a};return n.sort(function(c,g){var y=c.$layout,O=g.$layout;return y._idx===O._idx?O._set-y._set:O._idx-y._idx}),this.update(n),n},update:function(t){var i,a,r,o,s,n=!1;for(i=0,a=t.length;i<a;++i)o=(r=t[i]).model(),(s=r.$layout)._hidable=o&&"auto"===o.display,s._visible=r.visible(),n|=s._hidable;n&&function D(t){var n,i,a,r,o,s,c;for(n=0,i=t.length;n<i;++n)(r=(a=t[n]).$layout)._visible&&(c=new Proxy(a._el,{get:(g,y)=>g.getProps([y],!0)[y]}),o=a.geometry(),s=f(c,a.model(),o),r._box.update(s,o,a.rotation()));(function k(t,n){var i,a,r,o;for(i=t.length-1;i>=0;--i)for(r=t[i].$layout,a=i-1;a>=0&&r._visible;--a)(o=t[a].$layout)._visible&&r._box.intersects(o._box)&&n(r,o)})(t,function(g,y){var O=g._hidable,R=y._hidable;O&&R||R?y._visible=!1:O&&(g._visible=!1)})}(t)},lookup:function(t,n){var i,a;for(i=t.length-1;i>=0;--i)if((a=t[i].$layout)&&a._visible&&a._box.contains(n))return t[i];return null},draw:function(t,n){var i,a,r,o,s,c;for(i=0,a=n.length;i<a;++i)(o=(r=n[i]).$layout)._visible&&(s=r.geometry(),c=f(r._el,r.model(),s),o._box.update(c,s,r.rotation()),r.draw(t,c))}},Q="$datalabels",oe="$default";function ae(t,n,i){if(n){var o,a=i.$context,r=i.$groups;!n[r._set]||(o=n[r._set][r._key])&&!0===(0,h.O)(o,[a])&&(t[Q]._dirty=!0,i.update(a))}}const ve={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,h.k)(t))return null;var i,a,r,n=t;if((0,h.i)(t))if((0,h.k)(t.label))if((0,h.k)(t.r))for(n="",r=0,a=(i=Object.keys(t)).length;r<a;++r)n+=(0!==r?", ":"")+i[r]+": "+t[i[r]];else n=t.r;else n=t.label;return""+n},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[Q]={_actives:[]}},beforeUpdate:function(t){var n=t[Q];n._listened=!1,n._listeners={},n._datasets=[],n._labels=[]},afterDatasetUpdate:function(t,n,i){var R,V,se,le,ne,ue,te,ee,a=n.index,r=t[Q],o=r._datasets[a]=[],s=t.isDatasetVisible(a),c=t.data.datasets[a],g=function de(t,n){var o,s,i=t.datalabels,a={},r=[];return!1===i?null:(!0===i&&(i={}),n=(0,h.a2)({},[n,i]),o=n.labels||{},s=Object.keys(o),delete n.labels,s.length?s.forEach(function(c){o[c]&&r.push((0,h.a2)({},[n,o[c],{_key:c}]))}):r.push(n),a=r.reduce(function(c,g){return(0,h.D)(g.listeners||{},function(y,O){c[O]=c[O]||{},c[O][g._key||oe]=y}),delete g.listeners,c},{}),{labels:r,listeners:a})}(c,i),y=n.meta.data||[],O=t.ctx;for(O.save(),R=0,se=y.length;R<se;++R)if((te=y[R])[Q]=[],s&&te&&t.getDataVisibility(R)&&!te.skip)for(V=0,le=g.labels.length;V<le;++V)ue=(ne=g.labels[V])._key,(ee=new u(ne,O,te,R)).$groups={_set:a,_key:ue||oe},ee.$context={active:!1,chart:t,dataIndex:R,dataset:c,datasetIndex:a},ee.update(ee.$context),te[Q].push(ee),o.push(ee);O.restore(),(0,h.a2)(r._listeners,g.listeners,{merger:function(ie,re,pe){re[ie]=re[ie]||{},re[ie][n.index]=pe[ie],r._listened=!0}})},afterUpdate:function(t,n){t[Q]._labels=W.prepare(t[Q]._datasets,n)},afterDatasetsDraw:function(t){W.draw(t,t[Q]._labels)},beforeEvent:function(t,n){if(t[Q]._listened){var i=n.event;switch(i.type){case"mousemove":case"mouseout":!function _e(t,n){var r,o,i=t[Q],a=i._listeners;if(a.enter||a.leave){if("mousemove"===n.type)o=W.lookup(i._labels,n);else if("mouseout"!==n.type)return;r=i._hovered,i._hovered=o,function ce(t,n,i,a){var r,o;!i&&!a||(i?a?i!==a&&(o=r=!0):o=!0:r=!0,o&&ae(t,n.leave,i),r&&ae(t,n.enter,a))}(t,a,r,o)}}(t,i);break;case"click":!function he(t,n){var i=t[Q],a=i._listeners.click,r=a&&W.lookup(i._labels,n);r&&ae(t,a,r)}(t,i)}}},afterEvent:function(t){var o,s,c,g,y,O,R,n=t[Q],r=function(t,n){var r,o,s,c,i=t.slice(),a=[];for(r=0,s=n.length;r<s;++r)-1===(o=i.indexOf(c=n[r]))?a.push([c,1]):i.splice(o,1);for(r=0,s=i.length;r<s;++r)a.push([i[r],-1]);return a}(n._actives,n._actives=t.getActiveElements());for(o=0,s=r.length;o<s;++o)if((y=r[o])[1])for(c=0,g=(R=y[0].element[Q]||[]).length;c<g;++c)(O=R[c]).$context.active=1===y[1],O.update(O.$context);(n._dirty||r.length)&&(W.update(n._labels),t.render()),delete n._dirty}}}}]);