"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[387],{387:(Q,_,l)=>{l.r(_),l.d(_,{ExclusionsRoutingModule:()=>q,ROUTES:()=>v});var m=l(7979),u=l(9808),r=l(2382),C=l(2539),b=l(5592),x=l(520),e=l(4893);const a={headers:new x.WM({"Access-Control-Allow-Methods":"GET,POST,PUT,DELETE","Access-Control-Allow-Headers":"Content-type","Content-Type":"application/json","Access-Control-Allow-Origin":"*"}),withCredentials:!0};let g=(()=>{class n{constructor(t){this.http=t,this.baseURL="https://172.17.2.130/"}ajout(t,s){try{return this.http.put(s.length<=2?this.baseURL+"servNode/exclusions_add/0":this.baseURL+"servNode/exclusions_add/"+s,JSON.stringify(t),a)}catch(o){throw{msg:"Erreur envoie des exclusions: "+o}}}getExclusions(){try{return this.http.get(this.baseURL+"servNode/exclusions",a)}catch(t){throw{msg:"Erreur r\xe9cup\xe9ration des exclusions: "+t}}}deleteExclusions(t,s,o){try{return this.http.delete(o.length<=2?this.baseURL+"servNode/exclusions_delete/"+t+"/"+s+"/0":this.baseURL+"servNode/exclusions_delete/"+t+"/"+s+"/"+o,a)}catch(i){throw{msg:"Erreur supression des exclusions: "+i}}}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(x.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const E=[g];var d=l(7528),Z=l(1135),T=l(5212),A=l(6333),h=l(7751),y=l(3305),M=l(4667),k=l(9444);function S(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"h4",5),e._uU(2,"Supression Exclusion"),e.qZA(),e.TgZ(3,"button",6),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",7)(5,"p")(6,"strong"),e._uU(7,"\xcates-vous s\xfbr de vouloir supprimer l'exclusion ?"),e.qZA()(),e.TgZ(8,"p")(9,"span",8),e._uU(10,"Une notification sera envoy\xe9 aux administrateurs syst\xe8mes."),e.qZA()()(),e.TgZ(11,"div",9)(12,"button",10),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("cancel click")}),e._uU(13,"Annuler"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){const i=e.CHM(t).$implicit,p=e.oxw();return i.close("Ok click"),p.supressionExclusion()}),e._uU(15,"Supprimer"),e.qZA()()}}function J(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"input",22),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).temporaire=o}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("ngModel",t.temporaire)}}function U(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"input",23),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).temporaire=o}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("ngModel",t.temporaire)}}function w(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"h4",5),e._uU(2,"Ajout d'une exclusion"),e.qZA(),e.TgZ(3,"button",6),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",7)(5,"p")(6,"strong"),e._uU(7,"Selection des serveurs: "),e.qZA()(),e.TgZ(8,"ngx-treeview",12),e.NdJ("filterChange",function(o){return e.CHM(t),e.oxw().onFilterChange(o)})("selectedChange",function(o){return e.CHM(t),e.oxw().values=o}),e.qZA(),e.TgZ(9,"div",13)(10,"div",14)(11,"strong",15),e._uU(12,"Temporaire: "),e.qZA()(),e.TgZ(13,"div",16)(14,"div",17),e.YNc(15,J,1,1,"input",18),e.YNc(16,U,1,1,"input",19),e._UZ(17,"label",20),e.qZA()()()(),e.TgZ(18,"div",9)(19,"button",10),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("cancel click")}),e._uU(20,"Annuler"),e.qZA(),e.TgZ(21,"button",21),e.NdJ("click",function(){const i=e.CHM(t).$implicit,p=e.oxw();return i.close("Ok click"),p.creationExclusion()}),e._uU(22,"Cr\xe9er"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("config",t.config)("items",t.items_fullServeur),e.xp6(7),e.Q6J("ngIf","$KzGxqD&hAEtB32"==t.urlKey),e.xp6(1),e.Q6J("ngIf","$KzGxqD&hAEtB32"!=t.urlKey)}}function N(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"form")(1,"div")(2,"div",24)(3,"div",25)(4,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),i=e.MAs(3);return o.open(i)}),e._uU(5,"Ajouter une exception"),e.qZA()()()()()}}const F=function(){return["fas","delete-left"]};function I(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"td")(1,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,i=e.oxw(2),p=e.MAs(1);return i.open(p),i.__id=o._id}),e._UZ(2,"fa-icon",33),e.qZA()()}2&n&&(e.xp6(2),e.Q6J("icon",e.DdM(2,F))("size","2x"))}function O(n,c){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"ngb-highlight",30),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",31),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"ngb-highlight",31),e.qZA(),e.YNc(7,I,3,3,"td",2),e.ALo(8,"async"),e.qZA()),2&n){const t=c.$implicit,s=e.oxw().ngIf,o=e.oxw();e.xp6(2),e.Q6J("result",(s.indexOf(t)+1).toString()),e.xp6(2),e.Q6J("result",t.name),e.xp6(2),e.Q6J("result",t.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,4,o.auth.isAdmin)||"$KzGxqD&hAEtB32"==o.urlKey)}}function R(n,c){if(1&n&&(e.TgZ(0,"table",27)(1,"thead")(2,"tr")(3,"th",28),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",28),e._uU(6,"Nom"),e.qZA(),e.TgZ(7,"th",28),e._uU(8,"Description"),e.qZA(),e._UZ(9,"th",28),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,O,9,6,"tr",29),e.qZA()()),2&n){const t=c.ngIf;e.xp6(11),e.Q6J("ngForOf",t)}}let K=(()=>{class n{constructor(t,s,o,i){this.exclusionsService=t,this.serveursService=s,this.modalService=o,this.auth=i,this.serv=[],this.__id="",this.config=d.VF.create({hasAllCheckBox:!1,hasFilter:!0,hasCollapseExpand:!0,decoupleChildFromParent:!1,maxHeight:400}),this.closeResult="",this.temporaire=!0}ngOnInit(){this.serveurs=this.exclusionsService.getExclusions(),this.serveurs$=this.serveursService.messerveurs$,this.getTreeItemsFullServeur()}getTreeItemsFullServeur(){const t=new d.cA({text:"serveurs",value:9,children:[{text:"Production",value:91,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"Pre-production",value:92,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"Recette-Formation",value:93,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"BDD",value:94,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"BDD-Recette",value:95,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"DMZ",value:96,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0}]});return this.serveurs$.subscribe(s=>{this.serv=s,s.forEach(o=>{t.children.forEach(i=>{i.text==o.type&&i.children.push(new d.cA({text:o.name,value:i.value+101,checked:!1}))})}),this.items_fullServeur=[t]}),[t]}onFilterChange(t){console.log("filter:",t)}getCheckedItem(t){let s=[];return t[0].children.forEach(o=>{o.children.forEach(i=>{i.checked&&s.push(i.text)})}),s}creationExclusion(){let t=this.getCheckedItem(this.items_fullServeur),s=[];this.serv.forEach(o=>{t.includes(o.name)&&s.push({name:o.fullName,description:o.description,user:this.auth.user.value.name,temporaire:this.temporaire,_id:void 0})}),this.exclusionsService.ajout(s,this.urlKey).subscribe(o=>{this.ngOnInit(),setTimeout(function(){alert(o)},1e3)})}supressionExclusion(){null!=this.__id&&""!=this.__id?this.exclusionsService.deleteExclusions(this.__id,this.auth.user.value.name,this.urlKey).subscribe(t=>{this.ngOnInit()}):console.log("error: _ID unfined")}open(t){this.modalService.open(t,{centered:!0}).result.then(s=>{this.closeResult=`Closed with: ${s}`},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}getDismissReason(t){return t===h.If.ESC?"by pressing ESC":t===h.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${t}`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g),e.Y36(y.t),e.Y36(h.FF),e.Y36(M.g))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-exclusions-tab"]],inputs:{urlKey:"urlKey"},decls:8,vars:6,consts:[["content",""],["content_addExcl",""],[4,"ngIf"],["class","table table-striped",4,"ngIf"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[1,"text-danger"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[3,"config","items","filterChange","selectedChange"],[1,"row","align-items-center"],[1,"col"],[1,"mb-0"],[1,"col-auto"],[1,"custom-control","custom-switch"],["type","checkbox","class","custom-control-input","id","customSwitches","name","alertMail","disabled","",3,"ngModel","ngModelChange",4,"ngIf"],["type","checkbox","class","custom-control-input","id","customSwitches","name","alertMail",3,"ngModel","ngModelChange",4,"ngIf"],["for","customSwitches",1,"custom-control-label"],["type","button",1,"btn","btn-success",3,"click"],["type","checkbox","id","customSwitches","name","alertMail","disabled","",1,"custom-control-input",3,"ngModel","ngModelChange"],["type","checkbox","id","customSwitches","name","alertMail",1,"custom-control-input",3,"ngModel","ngModelChange"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["role","group","aria-label","first group",1,"btn-group","me-2","ml-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["Style","font-weight: bold",3,"result"],[3,"result"],[1,"delete",3,"click"],[3,"icon","size"]],template:function(t,s){1&t&&(e.YNc(0,S,16,0,"ng-template",null,0,e.W1O),e.YNc(2,w,23,4,"ng-template",null,1,e.W1O),e.YNc(4,N,6,0,"form",2),e.ALo(5,"async"),e.YNc(6,R,12,1,"table",3),e.ALo(7,"async")),2&t&&(e.xp6(4),e.Q6J("ngIf",e.lcZ(5,2,s.auth.isAdmin)||"$KzGxqD&hAEtB32"==s.urlKey),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,4,s.serveurs)))},directives:[d.GA,u.O5,r.Wl,r.JJ,r.On,r._Y,r.JL,r.F,u.sg,h._h,k.BN],pipes:[u.Ov],styles:[".delete[_ngcontent-%COMP%]{border:0ch;background-color:unset}"]}),n})();function B(n,c){if(1&n&&(e.TgZ(0,"sb-card")(1,"div",2)(2,"div"),e._uU(3,"Serveurs Exclus"),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"app-exclusions-tab",4),e.qZA()()),2&n){const t=c.ngIf;e.xp6(5),e.Q6J("urlKey",t)}}let f=(()=>{class n{constructor(t){this.route=t,this.urlKey=new Z.X(" ")}ngOnInit(){this.route.params.subscribe(t=>{null!=t.urlKey&&this.urlKey.next(t.urlKey)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-exclusions"]],decls:3,vars:4,consts:[["title","Exclusions",3,"hideBreadcrumbs"],[4,"ngIf"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body"],[3,"urlKey"]],template:function(t,s){1&t&&(e._UZ(0,"sb-dashboard-head",0),e.YNc(1,B,6,1,"sb-card",1),e.ALo(2,"async")),2&t&&(e.Q6J("hideBreadcrumbs",!1),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.urlKey)))},directives:[T.T,u.O5,A.A,K],pipes:[u.Ov],styles:[""]}),n})(),D=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[u.JJ,...E],imports:[[u.ez,m.Bz,r.UX,r.u5,C.n,b.A,d.X5.forRoot()]]}),n})();var $=l(6440);const v=[{path:"",canActivate:[],component:f,data:{title:"Exclusions - Patch Management",breadcrumbs:[{text:"Dashboard",link:"/patchManagement/dashboard"},{text:"Exclusions",active:!0}]}}];let q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[$.J,D,m.Bz.forChild(v)],m.Bz]}),n})()}}]);