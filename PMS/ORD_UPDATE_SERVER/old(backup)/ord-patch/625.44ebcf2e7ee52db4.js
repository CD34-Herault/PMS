"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[625],{2625:(D,_,c)=>{c.r(_),c.d(_,{ExclusionsRoutingModule:()=>B,ROUTES:()=>g});var m=c(6952),u=c(9808),r=c(2382),f=c(2539),v=c(5592),h=c(9524),d=c(7528),e=c(5e3),b=c(1135),C=c(5212),Z=c(6333),p=c(7751),E=c(3305),T=c(4667),A=c(9444);function y(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"h4",5),e._uU(2,"Supression Exclusion"),e.qZA(),e.TgZ(3,"button",6),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",7)(5,"p")(6,"strong"),e._uU(7,"\xcates-vous s\xfbr de vouloir supprimer l'exclusion ?"),e.qZA()(),e.TgZ(8,"p")(9,"span",8),e._uU(10,"Une notification sera envoy\xe9 aux administrateurs syst\xe8mes."),e.qZA()()(),e.TgZ(11,"div",9)(12,"button",10),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("cancel click")}),e._uU(13,"Annuler"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){const i=e.CHM(t).$implicit,a=e.oxw();return i.close("Ok click"),a.supressionExclusion()}),e._uU(15,"Supprimer"),e.qZA()()}}function M(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"input",22),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).temporaire=s}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("ngModel",t.temporaire)}}function k(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"input",23),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).temporaire=s}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("ngModel",t.temporaire)}}function J(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"h4",5),e._uU(2,"Ajout d'une exclusion"),e.qZA(),e.TgZ(3,"button",6),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",7)(5,"p")(6,"strong"),e._uU(7,"Selection des serveurs: "),e.qZA()(),e.TgZ(8,"ngx-treeview",12),e.NdJ("filterChange",function(s){return e.CHM(t),e.oxw().onFilterChange(s)})("selectedChange",function(s){return e.CHM(t),e.oxw().values=s}),e.qZA(),e.TgZ(9,"div",13)(10,"div",14)(11,"strong",15),e._uU(12,"Temporaire: "),e.qZA()(),e.TgZ(13,"div",16)(14,"div",17),e.YNc(15,M,1,1,"input",18),e.YNc(16,k,1,1,"input",19),e._UZ(17,"label",20),e.qZA()()()(),e.TgZ(18,"div",9)(19,"button",10),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("cancel click")}),e._uU(20,"Annuler"),e.qZA(),e.TgZ(21,"button",21),e.NdJ("click",function(){const i=e.CHM(t).$implicit,a=e.oxw();return i.close("Ok click"),a.creationExclusion()}),e._uU(22,"Cr\xe9er"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("config",t.config)("items",t.items_fullServeur),e.xp6(7),e.Q6J("ngIf","$KzGxqD&hAEtB32"==t.urlKey),e.xp6(1),e.Q6J("ngIf","$KzGxqD&hAEtB32"!=t.urlKey)}}function S(n,l){if(1&n&&(e.TgZ(0,"span",28),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Total: ",e.lcZ(2,1,t.serveursService.total$),"")}}function I(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"form")(1,"div")(2,"div",24)(3,"div",25)(4,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(),i=e.MAs(3);return s.open(i)}),e._uU(5,"Ajouter une exception"),e.qZA()(),e.TgZ(6,"div",25),e.YNc(7,S,3,3,"span",27),e.ALo(8,"async"),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",e.lcZ(8,1,t.serveursService.total$))}}const U=function(){return["fas","delete-left"]};function N(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"td")(1,"button",34),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,i=e.oxw(2),a=e.MAs(1);return i.open(a),i.__id=s._id}),e._UZ(2,"fa-icon",35),e.qZA()()}2&n&&(e.xp6(2),e.Q6J("icon",e.DdM(2,U))("size","2x"))}function w(n,l){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"ngb-highlight",32),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",33),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"ngb-highlight",33),e.qZA(),e.YNc(7,N,3,3,"td",2),e.ALo(8,"async"),e.qZA()),2&n){const t=l.$implicit,o=e.oxw().ngIf,s=e.oxw();e.xp6(2),e.Q6J("result",(o.indexOf(t)+1).toString()),e.xp6(2),e.Q6J("result",t.name),e.xp6(2),e.Q6J("result",t.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,4,s.auth.isAdmin)||"$KzGxqD&hAEtB32"==s.urlKey)}}function F(n,l){if(1&n&&(e.TgZ(0,"table",29)(1,"thead")(2,"tr")(3,"th",30),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",30),e._uU(6,"Nom"),e.qZA(),e.TgZ(7,"th",30),e._uU(8,"Description"),e.qZA(),e._UZ(9,"th",30),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,w,9,6,"tr",31),e.qZA()()),2&n){const t=l.ngIf;e.xp6(11),e.Q6J("ngForOf",t)}}let K=(()=>{class n{constructor(t,o,s,i){this.exclusionsService=t,this.serveursService=o,this.modalService=s,this.auth=i,this.serv=[],this.__id="",this.config=d.VF.create({hasAllCheckBox:!1,hasFilter:!0,hasCollapseExpand:!0,decoupleChildFromParent:!1,maxHeight:400}),this.closeResult="",this.temporaire=!0}ngOnInit(){this.serveurs=this.exclusionsService.getExclusions(),this.serveurs$=this.serveursService.messerveurs$,this.getTreeItemsFullServeur(),this.serveurs.subscribe(t=>{this.serveurs$.subscribe(o=>{t.forEach(s=>{if(console.log("TEST"),null!=o.find(i=>i.fullName.match(s.name))){let i=o.find(a=>{});console.log("maj: "+s.name+" "+(null==i?void 0:i.kb_manquantes))}})})})}getTreeItemsFullServeur(){const t=new d.cA({text:"serveurs",value:9,children:[{text:"Production",value:91,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"Pre-production",value:92,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"Recette-Formation",value:93,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"BDD",value:94,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"BDD-Recette",value:95,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0},{text:"DMZ",value:96,children:[{text:"",value:0,disabled:!0,checked:!1}],collapsed:!0}]});return this.serveurs$.subscribe(o=>{this.serv=o,o.forEach(s=>{t.children.forEach(i=>{i.text==s.type&&i.children.push(new d.cA({text:s.name,value:i.value+101,checked:!1}))})}),this.items_fullServeur=[t]}),[t]}onFilterChange(t){console.log("filter:",t)}getCheckedItem(t){let o=[];return t[0].children.forEach(s=>{s.children.forEach(i=>{i.checked&&o.push(i.text)})}),o}creationExclusion(){let t=this.getCheckedItem(this.items_fullServeur),o=[];this.serv.forEach(s=>{t.includes(s.name)&&o.push({name:s.fullName,description:s.description,user:this.auth.user.value.name,temporaire:this.temporaire,_id:void 0})}),this.exclusionsService.ajout(o,this.urlKey).subscribe(s=>{this.ngOnInit(),setTimeout(function(){alert(s)},1e3)})}supressionExclusion(){null!=this.__id&&""!=this.__id?this.exclusionsService.deleteExclusions(this.__id,this.auth.user.value.name,this.urlKey).subscribe(t=>{this.ngOnInit()}):console.log("error: _ID unfined")}open(t){this.modalService.open(t,{centered:!0}).result.then(o=>{this.closeResult=`Closed with: ${o}`},o=>{this.closeResult=`Dismissed ${this.getDismissReason(o)}`})}getDismissReason(t){return t===p.If.ESC?"by pressing ESC":t===p.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${t}`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.z),e.Y36(E.t),e.Y36(p.FF),e.Y36(T.g))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-exclusions-tab"]],inputs:{urlKey:"urlKey"},decls:8,vars:6,consts:[["content",""],["content_addExcl",""],[4,"ngIf"],["class","table table-striped",4,"ngIf"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[1,"text-danger"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[3,"config","items","filterChange","selectedChange"],[1,"row","align-items-center"],[1,"col"],[1,"mb-0"],[1,"col-auto"],[1,"custom-control","custom-switch"],["type","checkbox","class","custom-control-input","id","customSwitches","name","alertMail","disabled","",3,"ngModel","ngModelChange",4,"ngIf"],["type","checkbox","class","custom-control-input","id","customSwitches","name","alertMail",3,"ngModel","ngModelChange",4,"ngIf"],["for","customSwitches",1,"custom-control-label"],["type","button",1,"btn","btn-success",3,"click"],["type","checkbox","id","customSwitches","name","alertMail","disabled","",1,"custom-control-input",3,"ngModel","ngModelChange"],["type","checkbox","id","customSwitches","name","alertMail",1,"custom-control-input",3,"ngModel","ngModelChange"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["role","group","aria-label","first group",1,"btn-group","me-2","ml-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["Style","font-weight: bold",3,"result"],[3,"result"],[1,"delete",3,"click"],[3,"icon","size"]],template:function(t,o){1&t&&(e.YNc(0,y,16,0,"ng-template",null,0,e.W1O),e.YNc(2,J,23,4,"ng-template",null,1,e.W1O),e.YNc(4,I,9,3,"form",2),e.ALo(5,"async"),e.YNc(6,F,12,1,"table",3),e.ALo(7,"async")),2&t&&(e.xp6(4),e.Q6J("ngIf",e.lcZ(5,2,o.auth.isAdmin)||"$KzGxqD&hAEtB32"==o.urlKey),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,4,o.serveurs)))},directives:[d.GA,u.O5,r.Wl,r.JJ,r.On,r._Y,r.JL,r.F,u.sg,p._h,A.BN],pipes:[u.Ov],styles:[".delete[_ngcontent-%COMP%]{border:0ch;background-color:unset}"]}),n})();function $(n,l){if(1&n&&(e.TgZ(0,"sb-card")(1,"div",2)(2,"div"),e._uU(3,"Serveurs Exclus"),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"app-exclusions-tab",4),e.qZA()()),2&n){const t=l.ngIf;e.xp6(5),e.Q6J("urlKey",t)}}let x=(()=>{class n{constructor(t){this.route=t,this.urlKey=new b.X(" ")}ngOnInit(){this.route.params.subscribe(t=>{null!=t.urlKey&&this.urlKey.next(t.urlKey)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-exclusions"]],decls:3,vars:4,consts:[["title","Exclusions",3,"hideBreadcrumbs"],[4,"ngIf"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body"],[3,"urlKey"]],template:function(t,o){1&t&&(e._UZ(0,"sb-dashboard-head",0),e.YNc(1,$,6,1,"sb-card",1),e.ALo(2,"async")),2&t&&(e.Q6J("hideBreadcrumbs",!1),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.urlKey)))},directives:[C.T,u.O5,Z.A,K],pipes:[u.Ov],styles:[""]}),n})(),O=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[u.JJ,...h.u],imports:[[u.ez,m.Bz,r.UX,r.u5,f.n,v.A,d.X5.forRoot()]]}),n})();var q=c(6440);const g=[{path:"",canActivate:[],component:x,data:{title:"Exclusions - Patch Management",breadcrumbs:[{text:"Dashboard",link:"/patchManagement/dashboard"},{text:"Exclusions",active:!0}]}}];let B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[q.J,O,m.Bz.forChild(g)],m.Bz]}),n})()}}]);