"use strict";(self.webpackChunkord_patch=self.webpackChunkord_patch||[]).push([[136],{3177:(ae,K,_)=>{_.d(K,{m:()=>V});var g=_(4274),d=_(5e3),L=_(9524),E=_(4267),W=_(3305);const F=["myAreaChart"];let V=(()=>{class D{constructor(u,f,k){this.exclusionsService=u,this.historiqueService=f,this.serv=k}ngOnInit(){}ngAfterViewInit(){let u=this.historiqueService;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$,this.chart=new g.Z(this.myAreaChart.nativeElement,{type:"line",data:{labels:[],datasets:[{label:"Maj necessaires",borderWidth:1,tension:.3,fill:!0,backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",pointRadius:5,pointBackgroundColor:"rgba(179,0,102,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(179,0,102,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj \xe9chou\xe9es",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",pointRadius:5,pointBackgroundColor:"rgba(210,7,7,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(210,7,7,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj inconnues",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",pointRadius:5,pointBackgroundColor:"rgba(103,114,105,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(103,114,105,1)",pointHitRadius:50,pointBorderWidth:2,data:[]},{label:"Maj serveurs exclus",fill:!0,tension:.3,borderWidth:1,backgroundColor:"rgba(39,114,245,0.2)",borderColor:"rgba(39,114,245,1)",pointRadius:5,pointBackgroundColor:"rgba(39,114,245,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(39,114,245,1)",pointHitRadius:50,pointBorderWidth:2,data:[]}]},options:{scales:{xAxes:{time:{unit:"day"},grid:{display:!1},ticks:{autoSkip:!0,maxRotation:45,minRotation:45,maxTicksLimit:20}},y:{min:0,grid:{color:"rgba(0, 0, 0, .125)"}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(u.typeselected){case"Production":u.imgAreaProd.next(this.toBase64Image());break;case"Pre-production":u.imgAreaPre.next(this.toBase64Image());break;case"Recette-Formation":u.imgAreaRec.next(this.toBase64Image());break;case"BDD":u.imgAreaBdd.next(this.toBase64Image());break;case"BDD-Recette":u.imgAreaBddRec.next(this.toBase64Image());break;case"Production,BDD":case"Production,Pre-production,BDD":u.imgAreaProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":u.imgAreaRecBddRec.next(this.toBase64Image())}}}}}),this.chart.hide(2),this.exclusionsService.getExclusions().subscribe(f=>{this.serveurs_exclu=f,this.historique$.subscribe(k=>{var M,P,T,N,S,b,x,n,q,j,I,w,p,H,J,G,Q,ee;null===(P=null===(M=this.chart.data.datasets)||void 0===M?void 0:M[0].data)||void 0===P||P.splice(0,null===(N=null===(T=this.chart.data.datasets)||void 0===T?void 0:T[0].data)||void 0===N?void 0:N.length),null===(b=null===(S=this.chart.data.datasets)||void 0===S?void 0:S[1].data)||void 0===b||b.splice(0,null===(n=null===(x=this.chart.data.datasets)||void 0===x?void 0:x[1].data)||void 0===n?void 0:n.length),null===(j=null===(q=this.chart.data.datasets)||void 0===q?void 0:q[2].data)||void 0===j||j.splice(0,null===(w=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[2].data)||void 0===w?void 0:w.length),null===(H=null===(p=this.chart.data.datasets)||void 0===p?void 0:p[3].data)||void 0===H||H.splice(0,null===(G=null===(J=this.chart.data.datasets)||void 0===J?void 0:J[3].data)||void 0===G?void 0:G.length),null===(Q=this.chart.data.labels)||void 0===Q||Q.splice(0,null===(ee=this.chart.data.labels)||void 0===ee?void 0:ee.length);var X=0;k.forEach(te=>{var Y,B,Z,c,h,v,O,$,z;null===(Y=this.chart.data.labels)||void 0===Y||Y.push(te.date);var se=0,ne=0,oe=0,le=0;te.serveurs.forEach(t=>{se+=t.kb_inconnus,ne+=t.kb_failed,oe+=t.kb_manquantes,1==this.checkExclu(t)&&(le+=t.kb_manquantes)}),null===(Z=null===(B=this.chart.data.datasets)||void 0===B?void 0:B[0].data)||void 0===Z||Z.push(oe),null===(h=null===(c=this.chart.data.datasets)||void 0===c?void 0:c[1].data)||void 0===h||h.push(ne),null===(O=null===(v=this.chart.data.datasets)||void 0===v?void 0:v[2].data)||void 0===O||O.push(se),null===(z=null===($=this.chart.data.datasets)||void 0===$?void 0:$[3].data)||void 0===z||z.push(le),se>=X&&(X=se),ne>=X&&(X=ne),oe>=X&&(X=oe),function e(D,A){D.options.scales.y={min:0,grid:{color:"rgba(0, 0, 0, .125)"}}}(this.chart)}),this.chart.update()})})}checkExclu(u){return null!=this.serveurs_exclu.find(f=>f.name.match(u.fullName))}}return D.\u0275fac=function(u){return new(u||D)(d.Y36(L.z),d.Y36(E.J),d.Y36(W.t))},D.\u0275cmp=d.Xpm({type:D,selectors:[["sb-charts-area"]],viewQuery:function(u,f){if(1&u&&d.Gf(F,5),2&u){let k;d.iGM(k=d.CRH())&&(f.myAreaChart=k.first)}},decls:2,vars:0,consts:[["myAreaChart",""]],template:function(u,f){1&u&&d._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),D})()},6021:(ae,K,_)=>{_.d(K,{e:()=>F});var g=_(829),d=_(1013),L=_(5e3),E=_(4267);const W=["myBarChart"];let F=(()=>{class V{constructor(D){this.historiqueService=D}ngOnInit(){}ngAfterViewInit(){var D;this.historique$=this.historiqueService.historique$,this.total$=this.historiqueService.total$;let u,A=this.historiqueService;this.chart=new g.kL(this.myBarChart.nativeElement,{type:"bar",plugins:[d.Z],data:{datasets:[]},options:{plugins:{datalabels:{color:"#236be8"}},animation:{onComplete:function(){if(null!=this.data.datasets[1])switch(A.typeselected){case"Production":A.imgBarProd.next(this.toBase64Image()),A.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),A.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":A.imgBarPre.next(this.toBase64Image()),A.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),A.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":A.imgBarRec.next(this.toBase64Image()),A.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),A.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":A.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":A.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":A.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":A.imgBarRecBddRec.next(this.toBase64Image()),A.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),A.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":A.imgBarProdBdd.next(this.toBase64Image()),A.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),A.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}),null!=this.osSelected&&(u=null===(D=this.osSelected)||void 0===D?void 0:D.split("_")),this.historique$.subscribe(f=>{var k,M,P,T,N,S,b=0;if("TOUT"!=this.historiqueService.dateselected_debut&&"TOUT"!=this.historiqueService.dateselected_fin){if(null===(k=this.chart.data.datasets)||void 0===k||k.splice(0,null===(M=this.chart.data.datasets)||void 0===M?void 0:M.length),null===(P=this.chart.data.labels)||void 0===P||P.splice(0,null===(T=this.chart.data.labels)||void 0===T?void 0:T.length),this.chart.data={labels:["Avant","Apr\xe8s"],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]},f.forEach(n=>{var q,j,I,w,p,H,J,G,Q,ee,X,te,Y=0,B=0,Z=0;n.serveurs.forEach(h=>{null!=h.kb_inconnus&&(Y+=h.kb_inconnus),null!=h.kb_failed&&(B+=h.kb_failed),null!=h.kb_manquantes&&(Z+=h.kb_manquantes)});let c=new Date(n.date);c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),this.historiqueService.dateselected_debut instanceof Date&&c.getTime()==this.historiqueService.dateselected_debut.getTime()&&(null===(j=null===(q=this.chart.data.datasets)||void 0===q?void 0:q[0].data)||void 0===j||j.push(Z),null===(w=null===(I=this.chart.data.datasets)||void 0===I?void 0:I[1].data)||void 0===w||w.push(B),null===(H=null===(p=this.chart.data.datasets)||void 0===p?void 0:p[2].data)||void 0===H||H.push(Y)),this.historiqueService.dateselected_fin instanceof Date&&c.getTime()==this.historiqueService.dateselected_fin.getTime()&&(null===(G=null===(J=this.chart.data.datasets)||void 0===J?void 0:J[0].data)||void 0===G||G.push(Z),null===(ee=null===(Q=this.chart.data.datasets)||void 0===Q?void 0:Q[1].data)||void 0===ee||ee.push(B),null===(te=null===(X=this.chart.data.datasets)||void 0===X?void 0:X[2].data)||void 0===te||te.push(Y)),Y>=b&&(b=Y),B>=b&&(b=B),Z>=b&&(b=Z)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*b),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}else{null===(N=this.chart.data.datasets)||void 0===N||N.splice(0,null===(S=this.chart.data.datasets)||void 0===S?void 0:S.length),this.chart.data={labels:[],datasets:[{label:"Maj necessaires",backgroundColor:"rgba(179,0,102,0.2)",borderColor:"rgba(179,0,102,1)",borderWidth:1,data:[]},{label:"Maj \xe9chou\xe9es",backgroundColor:"rgba(210,7,7,0.2)",borderColor:"rgba(210,7,7,1)",borderWidth:1,data:[]},{label:"Maj inconnues",backgroundColor:"rgba(103,114,105,0.2)",borderColor:"rgba(103,114,105,1)",borderWidth:1,data:[]}]};var x=[];if(f.forEach(n=>{let q=new Date(n.date).toLocaleString("default",{month:"short"});this.moisInTab(x,q)||x.push({nom:q,kb_failed:0,kb_necessaire:0,kb_unkown:0,nbr_histo:0});var j=0,I=0,w=0;n.serveurs.forEach(p=>{null!=u&&u[0].includes("alco")&&u[1].includes("windows")?!(p.OS.includes("Linux")||p.OS.includes("CentOS")||p.OS.includes("VMware Photon")||p.os_quick.includes("linux"))&&p.position.includes("alco")&&(null!=p.kb_inconnus&&(j+=p.kb_inconnus),null!=p.kb_failed&&(I+=p.kb_failed),null!=p.kb_manquantes&&(w+=p.kb_manquantes)):null!=u&&u[0].includes("alco")&&u[1].includes("linux")?(p.OS.includes("Linux")||p.OS.includes("CentOS")||p.OS.includes("VMware Photon")||p.os_quick.includes("linux"))&&p.position.includes("alco")&&(null!=p.kb_inconnus&&(j+=p.kb_inconnus),null!=p.kb_failed&&(I+=p.kb_failed),null!=p.kb_manquantes&&(w+=p.kb_manquantes)):null!=u&&u[0].includes("heberge")&&u[1].includes("windows")?!(p.OS.includes("Linux")||p.OS.includes("CentOS")||p.OS.includes("VMware Photon")||p.os_quick.includes("linux"))&&p.position.includes("heberge")&&(null!=p.kb_inconnus&&(j+=p.kb_inconnus),null!=p.kb_failed&&(I+=p.kb_failed),null!=p.kb_manquantes&&(w+=p.kb_manquantes)):null!=u&&u[0].includes("heberge")&&u[1].includes("linux")?(p.OS.includes("Linux")||p.OS.includes("CentOS")||p.OS.includes("VMware Photon")||p.os_quick.includes("linux"))&&p.position.includes("heberge")&&(null!=p.kb_inconnus&&(j+=p.kb_inconnus),null!=p.kb_failed&&(I+=p.kb_failed),null!=p.kb_manquantes&&(w+=p.kb_manquantes)):(null!=p.kb_inconnus&&(j+=p.kb_inconnus),null!=p.kb_failed&&(I+=p.kb_failed),null!=p.kb_manquantes&&(w+=p.kb_manquantes))});for(let p=0;p<x.length;p++)x[p].nom==q&&(x[p].kb_failed+=I,x[p].kb_necessaire+=w,x[p].kb_unkown+=j)}),x.forEach(n=>{var q,j,I,w,p,H,J;n.kb_failed=Math.round(n.kb_failed/(n.nbr_histo+1)),n.kb_necessaire=Math.round(n.kb_necessaire/(n.nbr_histo+1)),n.kb_unkown=Math.round(n.kb_unkown/(n.nbr_histo+1)),null===(q=this.chart.data.labels)||void 0===q||q.push(n.nom),null===(I=null===(j=this.chart.data.datasets)||void 0===j?void 0:j[0].data)||void 0===I||I.push(n.kb_necessaire),null===(p=null===(w=this.chart.data.datasets)||void 0===w?void 0:w[1].data)||void 0===p||p.push(n.kb_failed),null===(J=null===(H=this.chart.data.datasets)||void 0===H?void 0:H[2].data)||void 0===J||J.push(n.kb_unkown),n.kb_unkown>=b&&(b=n.kb_unkown),n.kb_failed>=b&&(b=n.kb_failed),n.kb_necessaire>=b&&(b=n.kb_necessaire)}),null==this.chart.options.scales){let n=this.historiqueService;this.chart.options={responsive:!0,scales:{xAxes:{time:{unit:"month"},grid:{display:!1},ticks:{maxTicksLimit:6}},yAxes:{ticks:{maxTicksLimit:5},min:0,max:Math.round(1.5*b),grid:{display:!0}}},animation:{onComplete:function(){if(null!=this.data.datasets[0].data[0])switch(n.typeselected){case"Production":n.imgBarProd.next(this.toBase64Image()),n.majAvProdAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Pre-production":n.imgBarPre.next(this.toBase64Image()),n.majAvPreAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApPreAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Recette-Formation":n.imgBarRec.next(this.toBase64Image()),n.majAvRecAppli.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecAppli.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"BDD":n.imgBarBdd.next(this.toBase64Image());break;case"BDD-Recette":n.imgBarBddRec.next(this.toBase64Image());break;case"Production,BDD":n.imgBarProdBdd.next(this.toBase64Image());break;case"Recette-Formation,BDD-Recette":n.imgBarRecBddRec.next(this.toBase64Image()),n.majAvRecBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApRecBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0");break;case"Production,Pre-production,BDD":n.imgBarProdBdd.next(this.toBase64Image()),n.majAvProdBdd.next(null!=this.data.datasets[0].data[0]?this.data.datasets[0].data[0].toString():"0"),n.majApProdBdd.next(null!=this.data.datasets[0].data[1]?this.data.datasets[0].data[1].toString():"0")}}}}}this.chart.update()}})}moisInTab(D,A){for(let u=0;u<D.length;u++)if(D[u].nom==A)return D[u].nbr_histo++,!0;return!1}}return V.\u0275fac=function(D){return new(D||V)(L.Y36(E.J))},V.\u0275cmp=L.Xpm({type:V,selectors:[["sb-charts-bar"]],viewQuery:function(D,A){if(1&D&&L.Gf(W,5),2&D){let u;L.iGM(u=L.CRH())&&(A.myBarChart=u.first)}},inputs:{osSelected:"osSelected"},decls:2,vars:0,consts:[["myBarChart",""]],template:function(D,A){1&D&&L._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),V})()},9410:(ae,K,_)=>{_.d(K,{y:()=>A});var g=_(829),d=_(1013),L=_(1135),E=_(5e3),W=_(3305),F=_(6952),V=_(757),e=_(4267);const D=["myPieChart"];let A=(()=>{class u{constructor(k,M,P,T){this.serveursService=k,this.route=M,this.userProfilService=P,this.historiqueService=T,this.lesServeurs=new L.X([]),this.kb_verte=0,this.kb_orange=0,this.kb_rouge=0,this.serveurs$=this.serveursService.messerveurs$,this.serveurs$.subscribe(N=>{this.lesServeurs.next(N)})}ngOnChanges(k){this.lesServeurs.next([])}ngOnInit(){var k=this.route;let M=this.historiqueService;this.userProfilService.get_user_profil().subscribe(P=>{this.chart=new g.kL(this.myPieChart.nativeElement,{type:"pie",data:{labels:["Serveurs n\xe9cessitant > "+P.serveursAlerte+" Maj","Serveurs n\xe9cessitant "+P.serveursBon+" \xe0 "+P.serveursAlerte+" Maj","Serveurs n\xe9cessitant < "+P.serveursBon+" Maj"],datasets:[{data:[],backgroundColor:["#dc3545","#ffc107","#28a745"]}]},options:{responsive:!0,aspectRatio:2,animation:{easing:"linear",onComplete:function(){null!=this.data.datasets[0].data[0]&&M.imgPie.next(this.toBase64Image())}}},plugins:[d.Z]}),this.lesServeurs.subscribe(T=>{var N;this.chart.data.datasets[0].data=[];let S,b=T.length;null!=this.osSelected&&(S=null===(N=this.osSelected)||void 0===N?void 0:N.split("_")),null!=S&&S[0].includes("alco")&&S[1].includes("windows")&&(b=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<P.serveursBon?this.kb_verte+=1:n.kb_manquantes>=P.serveursBon&&n.kb_manquantes<P.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,b++)})),null!=S&&S[0].includes("alco")&&S[1].includes("linux")&&(b=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("alco")&&(n.kb_manquantes<P.serveursBon?this.kb_verte+=1:n.kb_manquantes>=P.serveursBon&&n.kb_manquantes<P.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,b++)})),null!=S&&S[0].includes("heberge")&&S[1].includes("windows")&&(b=0,T.forEach(n=>{!(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<P.serveursBon?this.kb_verte+=1:n.kb_manquantes>=P.serveursBon&&n.kb_manquantes<P.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,b++)})),null!=S&&S[0].includes("heberge")&&S[1].includes("linux")&&(b=0,T.forEach(n=>{(n.OS.includes("Linux")||n.OS.includes("CentOS")||n.OS.includes("VMware Photon")||n.os_quick.includes("linux"))&&n.position.includes("heberge")&&(n.kb_manquantes<P.serveursBon?this.kb_verte+=1:n.kb_manquantes>=P.serveursBon&&n.kb_manquantes<P.serveursAlerte?this.kb_orange+=1:this.kb_rouge+=1,b++)})),this.chart.data.datasets[0].data.push(this.kb_rouge),this.chart.data.datasets[0].data.push(this.kb_orange),this.chart.data.datasets[0].data.push(this.kb_verte);let x=this.historiqueService;this.chart.options={responsive:!0,aspectRatio:2,plugins:{legend:{position:"right"},datalabels:{color:"black",font:{weight:"bold",size:16},formatter:(n,q)=>{const I=(n/b*100).toFixed(1);return n/T.length*100<8?null:`${I}%`}},tooltip:{callbacks:{label:function(n){return" "+n.formattedValue+" Serveurs, soit : "+(parseInt(n.formattedValue)/b*100).toFixed(1)+"%"}},displayColors:!1}},elements:{point:{radius:0}},onClick:function(n){k.navigate(["patchManagement/serveurs/Alco_Windows"])},animation:{easing:"linear",onComplete:function(){x.imgPie.next(this.toBase64Image())}}},this.chart.update(),this.chart.resize()})})}ngAfterViewChecked(){}}return u.\u0275fac=function(k){return new(k||u)(E.Y36(W.t),E.Y36(F.F0),E.Y36(V.gb),E.Y36(e.J))},u.\u0275cmp=E.Xpm({type:u,selectors:[["sb-charts-pie"]],viewQuery:function(k,M){if(1&k&&E.Gf(D,5),2&k){let P;E.iGM(P=E.CRH())&&(M.myPieChart=P.first)}},inputs:{osSelected:"osSelected"},features:[E.TTD],decls:2,vars:0,consts:[["myPieChart",""]],template:function(k,M){1&k&&E._UZ(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),u})()},3678:(ae,K,_)=>{_.d(K,{L:()=>e});var g=_(7751),d=_(5e3),L=_(4267),E=_(2382),W=_(9444);function F(D,A){if(1&D){const u=d.EpF();d.TgZ(0,"span",14),d.NdJ("mouseenter",function(){const M=d.CHM(u).$implicit;return d.oxw().hoveredDate=M})("mouseleave",function(){return d.CHM(u),d.oxw().hoveredDate=null}),d._uU(1),d.qZA()}if(2&D){const u=A.$implicit,f=A.focused,k=d.oxw();d.ekj("focused",f)("range",k.isRange(u))("faded",k.isHovered(u)||k.isInside(u)),d.xp6(1),d.hij(" ",u.day," ")}}const V=function(){return["fas","table"]};let e=(()=>{class D{constructor(u,f,k){this.calendar=u,this.formatter=f,this.historiqueService=k,this.hoveredDate=null,this.fromDate=null,this.toDate=null}onDateSelection(u){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&u&&u.after(this.fromDate)?this.toDate=u:(this.toDate=null,this.fromDate=u):this.fromDate=u}isHovered(u){return this.fromDate&&!this.toDate&&this.hoveredDate&&u.after(this.fromDate)&&u.before(this.hoveredDate)}isInside(u){return this.toDate&&u.after(this.fromDate)&&u.before(this.toDate)}isRange(u){return u.equals(this.fromDate)||this.toDate&&u.equals(this.toDate)||this.isInside(u)||this.isHovered(u)}validateInput(u,f){const k=this.formatter.parse(f);return k&&this.calendar.isValid(g.qj.from(k))?g.qj.from(k):u}eventChange(){this.historiqueService.dateSelected_debut=null==this.fromDate?null:new Date(this.fromDate.year,this.fromDate.month-1,this.fromDate.day),this.historiqueService.dateSelected_fin=null==this.toDate?null:new Date(this.toDate.year,this.toDate.month-1,this.toDate.day)}ngOnInit(){}}return D.\u0275fac=function(u){return new(u||D)(d.Y36(g.vL),d.Y36(g.NG),d.Y36(L.J))},D.\u0275cmp=d.Xpm({type:D,selectors:[["app-date-picker"]],decls:19,vars:8,consts:[[1,"form-inline"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"autoClose","displayMonths","dayTemplate","startDate","dateSelect"],["datepicker","ngbDatepicker"],["t",""],[1,"input-group","mr-2"],["placeholder","D\xe9but","name","dpFromDate",1,"form-control",3,"value","input"],["dpFromDate",""],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[1,"mr-1",3,"icon"],["placeholder","Fin","name","dpToDate",1,"form-control",3,"value","input"],["dpToDate",""],["type","button",1,"btn","btn-outline-primary","ml-2",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(u,f){if(1&u){const k=d.EpF();d.TgZ(0,"form",0)(1,"div")(2,"div",1)(3,"div",2)(4,"input",3,4),d.NdJ("dateSelect",function(P){return f.onDateSelection(P),f.eventChange()}),d.qZA(),d.YNc(6,F,2,7,"ng-template",null,5,d.W1O),d.qZA()(),d.TgZ(8,"div",6)(9,"input",7,8),d.NdJ("input",function(){d.CHM(k);const P=d.MAs(10);return f.fromDate=f.validateInput(f.fromDate,P.value)}),d.qZA(),d.TgZ(11,"button",9),d.NdJ("click",function(){return d.CHM(k),d.MAs(5).toggle()}),d._UZ(12,"fa-icon",10),d.qZA()()(),d.TgZ(13,"div")(14,"div",2)(15,"input",11,12),d.NdJ("input",function(){d.CHM(k);const P=d.MAs(16);return f.toDate=f.validateInput(f.toDate,P.value)}),d.qZA(),d.TgZ(17,"button",13),d.NdJ("click",function(){return f.fromDate=null,f.toDate=null,f.eventChange()}),d._uU(18,"Reset"),d.qZA()()()()}if(2&u){const k=d.MAs(7);d.xp6(4),d.Q6J("autoClose","outside")("displayMonths",1)("dayTemplate",k)("startDate",f.fromDate),d.xp6(5),d.Q6J("value",f.formatter.format(f.fromDate)),d.xp6(3),d.Q6J("icon",d.DdM(7,V)),d.xp6(3),d.Q6J("value",f.formatter.format(f.toDate))}},directives:[E._Y,E.JL,E.F,g.J4,W.BN],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]}),D})()},4850:(ae,K,_)=>{_.d(K,{p:()=>Y});var g=_(7751),d=_(1135),L=_(3177),E=_(6021),W=_(9410),F=_(3678),e=_(5e3),D=_(4267),A=_(3154),u=_(6952),f=_(2382),k=_(5212),M=_(6333),P=_(9444),T=_(9808);function N(B,Z){if(1&B){const c=e.EpF();e.TgZ(0,"div",24)(1,"h4",25),e._uU(2,"Generation Du Rapport"),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){return e.CHM(c).$implicit.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",27)(5,"form",28)(6,"p"),e._uU(7,"Veuillez S\xe9l\xe9ctionner le nombre de jours \xe0 prendre en compte pour le rapport."),e.qZA(),e.TgZ(8,"input",29),e.NdJ("ngModelChange",function(v){return e.CHM(c),e.oxw().joursRapport=v}),e.qZA(),e.TgZ(9,"p"),e._uU(10,"Choisissez l'environnement:"),e.qZA(),e.TgZ(11,"select",30),e.NdJ("ngModelChange",function(v){return e.CHM(c),e.oxw().environnement=v}),e.TgZ(12,"option",31),e._uU(13,"Production"),e.qZA(),e.TgZ(14,"option",32),e._uU(15,"Recette-Formation"),e.qZA()(),e.TgZ(16,"label",33)(17,"input",34),e.NdJ("ngModelChange",function(v){return e.CHM(c),e.oxw().bdd_checked=v}),e.qZA(),e._uU(18," Avec BDD "),e.qZA(),e.TgZ(19,"div")(20,"label",35),e._uU(21,"Entrez votre email"),e.qZA(),e.TgZ(22,"input",36),e.NdJ("ngModelChange",function(v){return e.CHM(c),e.oxw().email=v}),e.qZA(),e.TgZ(23,"div",37),e._uU(24," Attention email obligatoire "),e.qZA()()()(),e.TgZ(25,"div",38)(26,"button",39),e.NdJ("click",function(){return e.CHM(c).$implicit.dismiss("cancel click")}),e._uU(27,"Annuler"),e.qZA(),e.TgZ(28,"button",40),e.NdJ("click",function(){const O=e.CHM(c).$implicit,$=e.oxw();return O.close("Ok click"),$.genereRapport()}),e._uU(29,"G\xe9n\xe9rer"),e.qZA()()}if(2&B){const c=e.oxw();e.xp6(8),e.Q6J("min",1)("ngModel",c.joursRapport),e.xp6(3),e.Q6J("ngModel",c.environnement),e.xp6(6),e.Q6J("ngModel",c.bdd_checked),e.xp6(5),e.Q6J("ngModel",c.email)}}const S=function(){return["fab","windows"]};function b(B,Z){if(1&B){const c=e.EpF();e.TgZ(0,"div",45)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Windows "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Production"}),e._uU(7,"Prod"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Pre-production"}),e._uU(9,"Pre-Prod"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Recette-Formation"}),e._uU(11,"Rec-Form"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="BDD"}),e._uU(13,"BDD"),e.qZA(),e.TgZ(14,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="BDD-Recette"}),e._uU(15,"BDD-Rec"),e.qZA(),e.TgZ(16,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="DMZ"}),e._uU(17,"DMZ"),e.qZA()()}2&B&&(e.xp6(2),e.Q6J("icon",e.DdM(1,S)))}function x(B,Z){if(1&B){const c=e.EpF();e.TgZ(0,"div",48)(1,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Production,Pre-production,BDD"}),e._uU(2,"Production + BDD"),e.qZA(),e.TgZ(3,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Recette-Formation,BDD-Recette"}),e._uU(4,"Rec-Form + BDD-Rec"),e.qZA()()}}const n=function(){return["fab","linux"]};function q(B,Z){if(1&B){const c=e.EpF();e.TgZ(0,"div",49)(1,"div",46),e._UZ(2,"fa-icon",16),e._uU(3,"Linux "),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="Tous"}),e._uU(5,"Tous"),e.qZA(),e.TgZ(6,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="BDD-PRODPRE"}),e._uU(7,"BDD-ProPre"),e.qZA(),e.TgZ(8,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="BDD-RECFOR"}),e._uU(9,"BDD-RECFOR"),e.qZA(),e.TgZ(10,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="PROD-PRE"}),e._uU(11,"PROD-PRE"),e.qZA(),e.TgZ(12,"button",47),e.NdJ("click",function(){return e.CHM(c),e.oxw(2).historiqueService.typeselected="REC-FOR"}),e._uU(13,"REC-FOR"),e.qZA()()}2&B&&(e.xp6(2),e.Q6J("icon",e.DdM(1,n)))}function j(B,Z){if(1&B&&(e.TgZ(0,"div",41),e.YNc(1,b,18,2,"div",42),e.YNc(2,x,5,0,"div",43),e.YNc(3,q,14,2,"div",44),e.qZA()),2&B){const c=Z.ngIf;e.xp6(1),e.Q6J("ngIf","Alco_Windows"==c),e.xp6(1),e.Q6J("ngIf","Alco_Windows"==c),e.xp6(1),e.Q6J("ngIf","Alco_Linux"==c)}}function I(B,Z){if(1&B&&(e.TgZ(0,"span",17),e._uU(1,"Total historiques: "),e.TgZ(2,"span",50),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&B){const c=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,c.historiqueService.total$))}}const w=function(){return["fas","xmark"]};function p(B,Z){if(1&B){const c=e.EpF();e.TgZ(0,"li",51),e._uU(1),e.TgZ(2,"span",52),e.NdJ("click",function(){const O=e.CHM(c).$implicit;return e.oxw().deleteItem(O)}),e._UZ(3,"fa-icon",7),e.qZA()()}if(2&B){const c=Z.$implicit;e.xp6(1),e.Oqu(c),e.xp6(2),e.Q6J("icon",e.DdM(2,w))}}function H(B,Z){if(1&B&&(e.TgZ(0,"div",53)(1,"div",54),e._uU(2),e.qZA()()),2&B){const c=e.oxw();e.xp6(1),e.Udp("width",c.progress,"%"),e.xp6(1),e.hij(" ",c.progress,"% Complete ")}}function J(B,Z){1&B&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function G(B,Z){if(1&B&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&B){const c=Z.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",c,"h")}}function Q(B,Z){1&B&&(e.TgZ(0,"div",55)(1,"div",56),e._uU(2," Chargement ... "),e.qZA()())}function ee(B,Z){if(1&B&&(e.TgZ(0,"p",57),e._uU(1),e.qZA()),2&B){const c=Z.ngIf;e.xp6(1),e.hij("La liste des serveurs est mise \xe0 jour \xe0 ",c,"h")}}const X=function(){return["fas","search"]},te=function(){return["fas","chart-area"]};let Y=(()=>{class B{constructor(c,h,v,O,$){this.historiqueService=c,this.horaireMajService=h,this.route=v,this.modalService=O,this.viewContainerRef=$,this.pageSize=4,this.maRecherche=Array(),this.search="",this.title="Nombres de patchs /mois",this.horaireMaj=new d.X(""),this.osSelected=new d.X("All"),this.joursRapport=1,this.loading_rapport=new d.X(!1),this.progress=0,this.environnement="Prod",this.bdd_checked=!0,this.email=""}ngOnDestroy(){this.search="",this.maRecherche.splice(0,this.maRecherche.length),this.historiqueService.serveursselected=[]}ngOnInit(){this.horaireMajService.getHoraireMaj().subscribe(c=>{console.log("horaire: "+c),this.horaireMaj.next(c)}),this.route.params.subscribe(c=>{null!=c.OSSelected&&(this.osSelected.next(c.OSSelected),this.osSelected.subscribe(h=>{this.historiqueService.OSSelected=h}))})}RemoveElementFromArray(c){this.maRecherche.forEach((h,v)=>{h==c&&this.maRecherche.splice(v,1)})}deleteItem(c){this.RemoveElementFromArray(c);var h=this.historiqueService.serveursselected;h.forEach((v,O)=>{v==c&&h.splice(O,1)}),this.historiqueService.serveursselected=h}ajout(){this.maRecherche.push(this.search);var c=this.historiqueService.serveursselected;c.push(this.search),this.historiqueService.serveursselected=c}open(c){this.modalService.open(c,{centered:!0}).result.then(h=>{this.closeResult=`Closed with: ${h}`},h=>{this.closeResult=`Dismissed ${this.getDismissReason(h)}`})}getDismissReason(c){return c===g.If.ESC?"by pressing ESC":c===g.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${c}`}genereRapport(){this.loading_rapport.next(!0);const c=new Date;c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);const h=new Date(c);h.setDate(h.getDate()-this.joursRapport),h.setHours(0),h.setMinutes(0),h.setSeconds(0),h.setMilliseconds(0),this.historiqueService.dateSelected_fin=c,this.historiqueService.dateSelected_debut=h,this.historiqueService.imgAreaProd.next(" "),this.historiqueService.imgAreaPre.next(" "),this.historiqueService.imgAreaBdd.next(" "),this.historiqueService.imgAreaProdBdd.next(" "),this.historiqueService.imgAreaRec.next(" "),this.historiqueService.imgAreaBddRec.next(" "),this.historiqueService.imgAreaRecBddRec.next(" "),this.historiqueService.imgBarProd.next(" "),this.historiqueService.imgBarPre.next(" "),this.historiqueService.imgBarBdd.next(" "),this.historiqueService.imgBarProdBdd.next(" "),this.historiqueService.imgBarRec.next(" "),this.historiqueService.imgBarBddRec.next(" "),this.historiqueService.imgBarRecBddRec.next(" "),this.historiqueService.imgPie.next(" "),this.historiqueService.majAvProdAppli.next(" "),this.historiqueService.majApProdAppli.next(" "),this.historiqueService.majAvProdBdd.next(" "),this.historiqueService.majApProdBdd.next(" "),this.historiqueService.majAvRecAppli.next(" "),this.historiqueService.majApRecAppli.next(" "),this.historiqueService.majAvRecBdd.next(" "),this.historiqueService.majApRecBdd.next(" "),this.progress=10;const v=this.viewContainerRef.createComponent(W.y);if(v.instance.osSelected="alco_windows","Prod"==this.environnement){let O=this.historiqueService.loading$.subscribe($=>{0==$&&setTimeout(()=>{" "!=this.historiqueService.imgAreaProd.getValue()&&" "!=this.historiqueService.imgAreaPre.getValue()&&" "!=this.historiqueService.imgBarProd.getValue()&&" "!=this.historiqueService.imgBarPre.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBdd.getValue()&&" "!=this.historiqueService.imgAreaProdBdd.getValue()&&" "!=this.historiqueService.imgBarBdd.getValue()&&" "!=this.historiqueService.imgBarProdBdd.getValue()?(O.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!0,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaBdd.getValue()||" "==this.historiqueService.imgBarBdd.getValue()?(this.progress=70,this.historiqueService.typeselected="BDD"):(this.progress=90,this.historiqueService.typeselected="Production,Pre-production,BDD"):(this.progress=75,O.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Prod",!1,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaProd.getValue()||" "==this.historiqueService.imgBarProd.getValue()?(this.progress=25,this.historiqueService.typeselected="Production"):(" "==this.historiqueService.imgAreaPre.getValue()||" "==this.historiqueService.imgBarPre.getValue())&&(this.progress=40,this.historiqueService.typeselected="Pre-production")},1e4)})}else if("Rec"==this.environnement){let O=this.historiqueService.loading$.subscribe($=>{0==$&&setTimeout(()=>{" "!=this.historiqueService.imgAreaRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()?1==this.bdd_checked?" "!=this.historiqueService.imgAreaBddRec.getValue()&&" "!=this.historiqueService.imgAreaRecBddRec.getValue()&&" "!=this.historiqueService.imgBarRec.getValue()&&" "!=this.historiqueService.imgBarRecBddRec.getValue()?(O.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!0,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):" "==this.historiqueService.imgAreaBddRec.getValue()||" "==this.historiqueService.imgBarRec.getValue()?(this.progress=50,this.historiqueService.typeselected="BDD-Recette"):(this.progress=70,this.historiqueService.typeselected="Recette-Formation,BDD-Recette"):(this.progress=80,O.unsubscribe(),v.destroy(),this.historiqueService.generateRapport(this.joursRapport,"Rec",!1,this.email).subscribe(z=>{this.progress=100,this.loading_rapport.next(!1),alert(z)})):(" "==this.historiqueService.imgAreaRec.getValue()||" "==this.historiqueService.imgBarRec.getValue())&&(this.progress=25,this.historiqueService.typeselected="Recette-Formation")},1e4)})}}}return B.\u0275fac=function(c){return new(c||B)(e.Y36(D.J),e.Y36(A.w),e.Y36(u.gz),e.Y36(g.FF),e.Y36(e.s_b))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-historique"]],inputs:{pageSize:"pageSize"},decls:54,vars:31,consts:[["content",""],["title","Historique",3,"hideBreadcrumbs"],[1,"card-body"],[1,"form-group","form-inline"],["type","text","name","searchTerm",1,"form-control","ml-1","col-1",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],["class","ml-2 btn-toolbar","role","toolbar","aria-label","Toolbar with button groups",4,"ngIf"],["class","ml-3",4,"ngIf"],[1,"ml-3","list-group","list-group-horizontal"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","progress",4,"ngIf"],[1,"row"],[1,"col-lg-6"],[1,"card-header","form-inline"],[1,"mr-1",3,"icon"],[1,"ml-3"],["class","progress ml-1",4,"ngIf"],[1,"card-footer","small","text-muted","d-flex","d-flex","justify-content-between"],["class","ml-auto",4,"ngIf"],["id","#title"],[1,"ml-0",2,"visibility","hidden"],[1,"card-footer","small","text-muted","d-flex","mb-0"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",1,"needs-validation"],["type","number","name","input-jour",1,"form-control","ml-1",3,"min","ngModel","ngModelChange"],["name","select_env",1,"browser-default","custom-select",3,"ngModel","ngModelChange"],["value","Prod"],["value","Rec"],[1,"form-check-label","mt-1"],["type","checkbox","value","bdd_checked","name","check_bdd","checked","",3,"ngModel","ngModelChange"],["for","form9"],["type","email","id","exampleInputEmail1","aria-describedby","emailHelp","placeholder","Enter email","name","email","required","",1,"form-control","is-invalid",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"click"],["role","toolbar","aria-label","Toolbar with button groups",1,"ml-2","btn-toolbar"],["class","btn-group me-2","role","group","aria-label","First group",4,"ngIf"],["class","btn-group me-2 ml-1","role","group","aria-label","Second group",4,"ngIf"],["class","btn-group me-2 ml-2","role","group","aria-label","Third group",4,"ngIf"],["role","group","aria-label","First group",1,"btn-group","me-2"],[1,"btn"],["type","button",1,"btn","btn-outline-info","button_perso",3,"click"],["role","group","aria-label","Second group",1,"btn-group","me-2","ml-1"],["role","group","aria-label","Third group",1,"btn-group","me-2","ml-2"],[1,"font-weight-bold"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ml-3",3,"click"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-success"],[1,"progress","ml-1"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated",2,"width","100%"],[1,"ml-auto"]],template:function(c,h){if(1&c){const v=e.EpF();e.YNc(0,N,30,5,"ng-template",null,0,e.W1O),e._UZ(2,"sb-dashboard-head",1),e.TgZ(3,"sb-card")(4,"div",2)(5,"form")(6,"div",3),e._uU(7,"Recherche: "),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function($){return h.search=$}),e.qZA(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return h.ajout()}),e._UZ(11,"fa-icon",7),e.qZA()(),e.YNc(12,j,4,3,"div",8),e.ALo(13,"async"),e.YNc(14,I,5,3,"span",9),e.ALo(15,"async"),e.TgZ(16,"ul",10),e.YNc(17,p,4,3,"li",11),e.qZA(),e.TgZ(18,"button",6),e.NdJ("click",function(){e.CHM(v);const $=e.MAs(1);return h.open($)}),e._uU(19,"G\xe9n\xe9rer rapport"),e.qZA()()(),e.YNc(20,H,3,3,"div",12),e.ALo(21,"async"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"sb-card")(25,"div",15),e._UZ(26,"fa-icon",16),e.TgZ(27,"span"),e._uU(28,"Intervalle: "),e.qZA(),e._UZ(29,"app-date-picker",17),e.qZA(),e.TgZ(30,"div",2),e.YNc(31,J,3,0,"div",18),e.ALo(32,"async"),e._UZ(33,"sb-charts-area"),e.qZA(),e.TgZ(34,"div",19),e._uU(35,"Mise \xe0 jour /jour "),e.YNc(36,G,2,1,"p",20),e.ALo(37,"async"),e.qZA()()(),e.TgZ(38,"div",14)(39,"sb-card")(40,"div",15),e._UZ(41,"fa-icon",16),e.TgZ(42,"span",21),e._uU(43),e.qZA(),e._UZ(44,"app-date-picker",22),e.qZA(),e.TgZ(45,"div",2),e.YNc(46,Q,3,0,"div",18),e.ALo(47,"async"),e._UZ(48,"sb-charts-bar"),e.qZA(),e.TgZ(49,"div",23)(50,"p"),e._uU(51,"Mise \xe0 jour /mois (moyenne)"),e.qZA(),e.YNc(52,ee,2,1,"p",20),e.ALo(53,"async"),e.qZA()()()()}2&c&&(e.xp6(2),e.Q6J("hideBreadcrumbs",!1),e.xp6(6),e.Q6J("ngModel",h.search),e.xp6(3),e.Q6J("icon",e.DdM(28,X)),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,14,h.osSelected)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,16,h.historiqueService.total$)),e.xp6(3),e.Q6J("ngForOf",h.maRecherche),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,18,h.loading_rapport)),e.xp6(6),e.Q6J("icon",e.DdM(29,te)),e.xp6(5),e.Q6J("ngIf",e.lcZ(32,20,h.historiqueService.loading$)),e.xp6(5),e.Q6J("ngIf",e.lcZ(37,22,h.horaireMaj)),e.xp6(5),e.Q6J("icon",e.DdM(30,te)),e.xp6(2),e.Oqu(h.title),e.xp6(3),e.Q6J("ngIf",e.lcZ(47,24,h.historiqueService.loading$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(53,26,h.horaireMaj)))},directives:[f._Y,f.JL,f.F,f.qQ,f.wV,f.Fj,f.JJ,f.On,f.EJ,f.YN,f.Kr,f.Wl,f.Q7,k.T,M.A,P.BN,T.O5,T.sg,F.L,L.m,E.e],pipes:[T.Ov],styles:[".button_perso[_ngcontent-%COMP%]:focus{color:#fff;background-color:#17a2b8;box-shadow:none}.button_perso[_ngcontent-%COMP%]{border:.5px solid #17a2b8!important}"],changeDetection:0}),B})()},9136:(ae,K,_)=>{_.d(K,{e:()=>k});var g=_(9808),d=_(6952),L=_(2382),E=_(2539),W=_(5592),F=_(4267),V=_(5e3);_(4850),_(3177),_(6021),_(9410),_(3678);let k=(()=>{class M{}return M.\u0275fac=function(T){return new(T||M)},M.\u0275mod=V.oAB({type:M}),M.\u0275inj=V.cJS({providers:[g.JJ,...F.u],imports:[[g.ez,d.Bz,L.UX,L.u5,E.n,W.A]]}),M})()},4267:(ae,K,_)=>{_.d(K,{J:()=>T,u:()=>N});var g=_(520),d=_(1135),L=_(7579),E=_(8505),W=_(8372),F=_(3900),V=_(4825),e=_(9646),D=_(5e3),A=_(9808);const u={headers:new g.WM({"Access-Control-Allow-Methods":"GET,POST,PUT,DELETE","Access-Control-Allow-Headers":"Content-type","Content-Type":"application/json","Access-Control-Allow-Origin":"*"}),withCredentials:!0};let T=(()=>{class S{constructor(x,n){this.pipe=x,this.http=n,this._loading$=new d.X(!0),this._search$=new L.x,this._mesHisto$=new L.x,this._historique$=new d.X([]),this._total$=new d.X(0),this.imgAreaProd=new d.X(""),this.imgAreaPre=new d.X(""),this.imgAreaBdd=new d.X(""),this.imgAreaProdBdd=new d.X(""),this.imgAreaRec=new d.X(""),this.imgAreaBddRec=new d.X(""),this.imgAreaRecBddRec=new d.X(""),this.imgBarProd=new d.X(""),this.imgBarPre=new d.X(""),this.imgBarBdd=new d.X(""),this.imgBarProdBdd=new d.X(""),this.imgBarRec=new d.X(""),this.imgBarBddRec=new d.X(""),this.imgBarRecBddRec=new d.X(""),this.imgPie=new d.X(""),this.majAvProdAppli=new d.X(""),this.majApProdAppli=new d.X(""),this.majAvPreAppli=new d.X(""),this.majApPreAppli=new d.X(""),this.majAvProdBdd=new d.X(""),this.majApProdBdd=new d.X(""),this.majAvRecAppli=new d.X(""),this.majApRecAppli=new d.X(""),this.majAvRecBdd=new d.X(""),this.majApRecBdd=new d.X(""),this.baseURL="https://pms.it.herault.fr/",this._state={dateSelected_debut:"TOUT",dateSelected_fin:"TOUT",typeSelected:"Tous",serveursSelected:[],OSSelected:"Alco_Windows"},this._search$.pipe((0,E.b)(()=>this._loading$.next(!0)),(0,W.b)(120),(0,F.w)(()=>this.get_historiques()),(0,V.g)(120)).subscribe(q=>{this._mesHisto$.next(q)}),this._mesHisto$.pipe((0,W.b)(120),(0,F.w)(q=>this._search(q)),(0,V.g)(120),(0,E.b)(()=>this._loading$.next(!1))).subscribe(q=>{this._historique$.next(q.historiques),this._total$.next(q.total)}),this._search$.next()}get meshistorique$(){return this._mesHisto$.asObservable()}get historique$(){return this._historique$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get dateselected_debut(){return this._state.dateSelected_debut}get dateselected_fin(){return this._state.dateSelected_fin}set dateSelected_debut(x){this._set(null==x?{dateSelected_debut:"TOUT"}:{dateSelected_debut:x}),console.log("DATEEE: "+x)}set dateSelected_fin(x){this._set(null==x?{dateSelected_fin:"TOUT"}:{dateSelected_fin:x})}get typeselected(){return this._state.typeSelected}set typeselected(x){this._set({typeSelected:x})}get serveursselected(){return this._state.serveursSelected}set serveursselected(x){this._set({serveursSelected:x})}set OSSelected(x){this._set({OSSelected:x})}_set(x){Object.assign(this._state,x),this._search$.next()}_search(x){const{dateSelected_debut:n,dateSelected_fin:q,typeSelected:j,serveursSelected:I}=this._state;let w=x;return w=w.filter(H=>function M(S,b,x){let n=new Date(S.date);if(n.setHours(0),"TOUT"==b&&"TOUT"==x)return!0;if("TOUT"==b&&x instanceof Date)return n.getTime()===x.getTime();if(b instanceof Date&&"TOUT"==x)return n.getTime()===b.getTime();if(b instanceof Date&&x instanceof Date)return n.getTime()>=b.getTime()&&n.getTime()<=x.getTime();throw console.error("Erreur Date type")}(H,n,q)),w.forEach(H=>{H.serveurs=H.serveurs.filter(J=>function f(S,b){let x=b.split(",");return"Tous"==x[0]||x.includes(S.type)}(J,j))}),w.forEach(H=>{H.serveurs=H.serveurs.filter(J=>function k(S,b,x){if(0==b.length)return!0;let n=!1;return b.forEach(q=>{1==function P(S,b,x){return S.name.toLowerCase().includes(b.toLowerCase())||S.type.toLowerCase().includes(b.toLowerCase())||S.ip.toLowerCase().includes(b.toLowerCase())||S.OS.toLowerCase().includes(b.toLowerCase())||S.description.toLowerCase().includes(b.toLowerCase())||x.transform(S.kb_manquantes).includes(b)||x.transform(S.kb_failed).includes(b)||x.transform(S.kb_inconnus).includes(b)||S.date_dernier_update.toLocaleLowerCase().includes(b.toLocaleLowerCase())||S.date_last_rapport.toLowerCase().includes(b.toLowerCase())}(S,q,x)&&(n=!0)}),n}(J,I,this.pipe))}),w=w.filter(H=>H.serveurs.length>0),(0,e.of)({historiques:w,total:w.length})}get_historiques(){try{return this.http.get(this.baseURL+"servNode/historiques/"+this._state.OSSelected,u)}catch(x){throw{msg:"Erreur get_serveurs(): "+x}}}generateRapport(x,n,q,j){try{return"Prod"==n?1==q?this.http.put(this.baseURL+"servNode/historiques_rapport/"+n+"/"+j+"/true/"+this.majAvProdBdd.getValue()+"/"+this.majApProdBdd.getValue(),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),areaBdd:this.imgAreaBdd.getValue(),areaProdBdd:this.imgAreaProdBdd.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),barBdd:this.imgBarBdd.getValue(),barProdBdd:this.imgBarProdBdd.getValue(),pie:this.imgPie.getValue()},u):this.http.put(this.baseURL+"servNode/historiques_rapport/"+n+"/"+j+"/false/"+(parseInt(this.majAvProdAppli.getValue())+parseInt(this.majAvPreAppli.getValue()))+"/"+(parseInt(this.majApProdAppli.getValue())+parseInt(this.majApPreAppli.getValue())),{areaProd:this.imgAreaProd.getValue(),areaPre:this.imgAreaPre.getValue(),barProd:this.imgBarProd.getValue(),barPre:this.imgBarPre.getValue(),pie:this.imgPie.getValue()},u):1==q?this.http.put(this.baseURL+"servNode/historiques_rapport/"+n+"/"+j+"/true/"+this.majAvRecBdd.getValue()+"/"+this.majApRecBdd.getValue(),{areaRec:this.imgAreaRec.getValue(),areaBddRec:this.imgAreaBddRec.getValue(),areaRecBddRec:this.imgAreaRecBddRec.getValue(),barRec:this.imgBarRec.getValue(),barBddRec:this.imgBarBddRec.getValue(),barRecBddRec:this.imgBarRecBddRec.getValue(),pie:this.imgPie.getValue()},u):this.http.put(this.baseURL+"servNode/historiques_rapport/"+n+"/"+j+"/false/"+this.majAvRecAppli.getValue()+"/"+this.majApRecAppli.getValue(),{areaRec:this.imgAreaRec.getValue(),barRec:this.imgBarRec.getValue(),pie:this.imgPie.getValue()},u)}catch(I){throw{msg:"Erreur get_serveurs(): "+I}}}}return S.\u0275fac=function(x){return new(x||S)(D.LFG(A.JJ),D.LFG(g.eN))},S.\u0275prov=D.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const N=[T]},1013:(ae,K,_)=>{_.d(K,{Z:()=>le});var g=_(5081),d=_(829),L=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),E_textSize=function(t,r,i){var m,a=[].concat(r),s=a.length,o=t.font,l=0;for(t.font=i.string,m=0;m<s;++m)l=Math.max(t.measureText(a[m]).width,l);return t.font=o,{height:s*i.lineHeight,width:l}};function W(t,r){var i=r.x,a=r.y;if(null===i)return{x:0,y:-1};if(null===a)return{x:1,y:0};var s=t.x-i,o=t.y-a,l=Math.sqrt(s*s+o*o);return{x:l?s/l:0,y:l?o/l:-1}}function f(t,r,i){var a=0;return t<i.left?a|=1:t>i.right&&(a|=2),r<i.top?a|=8:r>i.bottom&&(a|=4),a}function M(t,r){var s,o,i=r.anchor,a=t;return r.clamp&&(a=function k(t,r){for(var C,y,R,i=t.x0,a=t.y0,s=t.x1,o=t.y1,l=f(i,a,r),m=f(s,o,r);l|m&&!(l&m);)8&(C=l||m)?(y=i+(s-i)*(r.top-a)/(o-a),R=r.top):4&C?(y=i+(s-i)*(r.bottom-a)/(o-a),R=r.bottom):2&C?(R=a+(o-a)*(r.right-i)/(s-i),y=r.right):1&C&&(R=a+(o-a)*(r.left-i)/(s-i),y=r.left),C===l?l=f(i=y,a=R,r):m=f(s=y,o=R,r);return{x0:i,x1:s,y0:a,y1:o}}(a,r.area)),"start"===i?(s=a.x0,o=a.y0):"end"===i?(s=a.x1,o=a.y1):(s=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function F(t,r,i,a,s){switch(s){case"center":i=a=0;break;case"bottom":i=0,a=1;break;case"right":i=1,a=0;break;case"left":i=-1,a=0;break;case"top":i=0,a=-1;break;case"start":i=-i,a=-a;break;case"end":break;default:s*=Math.PI/180,i=Math.cos(s),a=Math.sin(s)}return{x:t,y:r,vx:i,vy:a}}(s,o,t.vx,t.vy,r.align)}var P={arc:function(t,r){var i=(t.startAngle+t.endAngle)/2,a=Math.cos(i),s=Math.sin(i),o=t.innerRadius,l=t.outerRadius;return M({x0:t.x+a*o,y0:t.y+s*o,x1:t.x+a*l,y1:t.y+s*l,vx:a,vy:s},r)},point:function(t,r){var i=W(t,r.origin),a=i.x*t.options.radius,s=i.y*t.options.radius;return M({x0:t.x-a,y0:t.y-s,x1:t.x+a,y1:t.y+s,vx:i.x,vy:i.y},r)},bar:function(t,r){var i=W(t,r.origin),a=t.x,s=t.y,o=0,l=0;return t.horizontal?(a=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(s=Math.min(t.y,t.base),l=Math.abs(t.base-t.y)),M({x0:a,y0:s+l,x1:a+o,y1:s,vx:i.x,vy:i.y},r)},fallback:function(t,r){var i=W(t,r.origin);return M({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},r)}},T=function(t){return Math.round(t*L)/L};function S(t,r){var i=r.chart.getDatasetMeta(r.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var a=i.getBasePixel();return t.horizontal?{x:a,y:null}:{x:null,y:a}}function b(t){return t instanceof d.qi?P.arc:t instanceof d.od?P.point:t instanceof d.ZL?P.bar:P.fallback}function j(t,r,i){var a=t.shadowBlur,s=i.stroked,o=T(i.x),l=T(i.y),m=T(i.w);s&&t.strokeText(r,o,l,m),i.filled&&(a&&s&&(t.shadowBlur=0),t.fillText(r,o,l,m),a&&s&&(t.shadowBlur=a))}var w=function(t,r,i,a){var s=this;s._config=t,s._index=a,s._model=null,s._rects=null,s._ctx=r,s._el=i};(0,g.a2)(w.prototype,{_modelize:function(t,r,i,a){var s=this,o=s._index,l=(0,g.Z)((0,g.a)([i.font,{}],a,o)),m=(0,g.a)([i.color,d.ce.color],a,o);return{align:(0,g.a)([i.align,"center"],a,o),anchor:(0,g.a)([i.anchor,"center"],a,o),area:a.chart.chartArea,backgroundColor:(0,g.a)([i.backgroundColor,null],a,o),borderColor:(0,g.a)([i.borderColor,null],a,o),borderRadius:(0,g.a)([i.borderRadius,0],a,o),borderWidth:(0,g.a)([i.borderWidth,0],a,o),clamp:(0,g.a)([i.clamp,!1],a,o),clip:(0,g.a)([i.clip,!1],a,o),color:m,display:t,font:l,lines:r,offset:(0,g.a)([i.offset,0],a,o),opacity:(0,g.a)([i.opacity,1],a,o),origin:S(s._el,a),padding:(0,g.C)((0,g.a)([i.padding,0],a,o)),positioner:b(s._el),rotation:(0,g.a)([i.rotation,0],a,o)*(Math.PI/180),size:E_textSize(s._ctx,r,l),textAlign:(0,g.a)([i.textAlign,"start"],a,o),textShadowBlur:(0,g.a)([i.textShadowBlur,0],a,o),textShadowColor:(0,g.a)([i.textShadowColor,m],a,o),textStrokeColor:(0,g.a)([i.textStrokeColor,m],a,o),textStrokeWidth:(0,g.a)([i.textStrokeWidth,0],a,o)}},update:function(t){var l,m,C,r=this,i=null,a=null,s=r._index,o=r._config,y=(0,g.a)([o.display,!0],t,s);y&&(m=(0,g.v)((0,g.O)(o.formatter,[l=t.dataset.data[s],t]),l),(C=(0,g.k)(m)?[]:function(t){var i,r=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?r.unshift.apply(r,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):(0,g.k)(t)||r.unshift(""+i);return r}(m)).length&&(a=function N(t){var r=t.borderWidth||0,i=t.padding,a=t.size.height,s=t.size.width,o=-s/2,l=-a/2;return{frame:{x:o-i.left-r,y:l-i.top-r,w:s+i.width+2*r,h:a+i.height+2*r},text:{x:o,y:l,w:s,h:a}}}(i=r._modelize(y,C,o,t)))),r._model=i,r._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,r){var l,a=t.ctx,s=this._model,o=this._rects;!this.visible()||(a.save(),s.clip&&(l=s.area,a.beginPath(),a.rect(l.left,l.top,l.right-l.left,l.bottom-l.top),a.clip()),a.globalAlpha=function(t,r,i){return Math.max(t,Math.min(r,i))}(0,s.opacity,1),a.translate(T(r.x),T(r.y)),a.rotate(s.rotation),function n(t,r,i){var a=i.backgroundColor,s=i.borderColor,o=i.borderWidth;!a&&(!s||!o)||(t.beginPath(),function x(t,r,i,a,s,o){var l=Math.PI/2;if(o){var m=Math.min(o,s/2,a/2),C=r+m,y=i+m,R=r+a-m,U=i+s-m;t.moveTo(r,y),C<R&&y<U?(t.arc(C,y,m,-Math.PI,-l),t.arc(R,y,m,-l,0),t.arc(R,U,m,0,l),t.arc(C,U,m,l,Math.PI)):C<R?(t.moveTo(C,i),t.arc(R,y,m,-l,l),t.arc(C,y,m,l,Math.PI+l)):y<U?(t.arc(C,y,m,-Math.PI,0),t.arc(C,U,m,0,Math.PI)):t.arc(C,y,m,-Math.PI,Math.PI),t.closePath(),t.moveTo(r,i)}else t.rect(r,i,a,s)}(t,T(r.x)+o/2,T(r.y)+o/2,T(r.w)-o,T(r.h)-o,i.borderRadius),t.closePath(),a&&(t.fillStyle=a,t.fill()),s&&o&&(t.strokeStyle=s,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}(a,o.frame,s),function I(t,r,i,a){var ie,s=a.textAlign,o=a.color,l=!!o,m=a.font,C=r.length,y=a.textStrokeColor,R=a.textStrokeWidth,U=y&&R;if(C&&(l||U))for(i=function q(t,r,i){var a=i.lineHeight,s=t.w,o=t.x;return"center"===r?o+=s/2:("end"===r||"right"===r)&&(o+=s),{h:a,w:s,x:o,y:t.y+a/2}}(i,s,m),t.font=m.string,t.textAlign=s,t.textBaseline="middle",t.shadowBlur=a.textShadowBlur,t.shadowColor=a.textShadowColor,l&&(t.fillStyle=o),U&&(t.lineJoin="round",t.lineWidth=R,t.strokeStyle=y),ie=0,C=r.length;ie<C;++ie)j(t,r[ie],{stroked:U,filled:l,w:i.w,x:i.x,y:i.y+i.h*ie})}(a,s.lines,o.text,s),a.restore())}});var p=Number.MIN_SAFE_INTEGER||-9007199254740991,H=Number.MAX_SAFE_INTEGER||9007199254740991;function J(t,r,i){var a=Math.cos(i),s=Math.sin(i),o=r.x,l=r.y;return{x:o+a*(t.x-o)-s*(t.y-l),y:l+s*(t.x-o)+a*(t.y-l)}}function G(t,r){var o,l,y,i=H,a=p,s=r.origin;for(o=0;o<t.length;++o)y=r.vx*((l=t[o]).x-s.x)+r.vy*(l.y-s.y),i=Math.min(i,y),a=Math.max(a,y);return{min:i,max:a}}function Q(t,r){var i=r.x-t.x,a=r.y-t.y,s=Math.sqrt(i*i+a*a);return{vx:(r.x-t.x)/s,vy:(r.y-t.y)/s,origin:t,ln:s}}var ee=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function X(t,r,i){var a=r.positioner(t,r),s=a.vx,o=a.vy;if(!s&&!o)return{x:a.x,y:a.y};var l=i.w,m=i.h,C=r.rotation,y=Math.abs(l/2*Math.cos(C))+Math.abs(m/2*Math.sin(C)),R=Math.abs(l/2*Math.sin(C))+Math.abs(m/2*Math.cos(C)),U=1/Math.max(Math.abs(s),Math.abs(o));return y*=s*U,R*=o*U,{x:a.x+(y+=r.offset*s),y:a.y+(R+=r.offset*o)}}(0,g.a2)(ee.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,r,i){this._rotation=i,this._rect={x:r.x+t.x,y:r.y+t.y,w:r.w,h:r.h}},contains:function(t){var r=this,a=r._rect;return!((t=J(t,r.center(),-r._rotation)).x<a.x-1||t.y<a.y-1||t.x>a.x+a.w+2||t.y>a.y+a.h+2)},intersects:function(t){var s,o,l,r=this._points(),i=t._points(),a=[Q(r[0],r[1]),Q(r[0],r[3])];for(this._rotation!==t._rotation&&a.push(Q(i[0],i[1]),Q(i[0],i[3])),s=0;s<a.length;++s)if(o=G(r,a[s]),l=G(i,a[s]),o.max<l.min||l.max<o.min)return!1;return!0},_points:function(){var t=this,r=t._rect,i=t._rotation,a=t.center();return[J({x:r.x,y:r.y},a,i),J({x:r.x+r.w,y:r.y},a,i),J({x:r.x+r.w,y:r.y+r.h},a,i),J({x:r.x,y:r.y+r.h},a,i)]}});var B={prepare:function(t){var i,a,s,o,l,r=[];for(i=0,s=t.length;i<s;++i)for(a=0,o=t[i].length;a<o;++a)r.push(l=t[i][a]),l.$layout={_box:new ee,_hidable:!1,_visible:!0,_set:i,_idx:a};return r.sort(function(m,C){var y=m.$layout,R=C.$layout;return y._idx===R._idx?R._set-y._set:R._idx-y._idx}),this.update(r),r},update:function(t){var i,a,s,o,l,r=!1;for(i=0,a=t.length;i<a;++i)o=(s=t[i]).model(),(l=s.$layout)._hidable=o&&"auto"===o.display,l._visible=s.visible(),r|=l._hidable;r&&function Y(t){var r,i,a,s,o,l,m;for(r=0,i=t.length;r<i;++r)(s=(a=t[r]).$layout)._visible&&(m=new Proxy(a._el,{get:(C,y)=>C.getProps([y],!0)[y]}),o=a.geometry(),l=X(m,a.model(),o),s._box.update(l,o,a.rotation()));(function te(t,r){var i,a,s,o;for(i=t.length-1;i>=0;--i)for(s=t[i].$layout,a=i-1;a>=0&&s._visible;--a)(o=t[a].$layout)._visible&&s._box.intersects(o._box)&&r(s,o)})(t,function(C,y){var R=C._hidable,U=y._hidable;R&&U||U?y._visible=!1:R&&(C._visible=!1)})}(t)},lookup:function(t,r){var i,a;for(i=t.length-1;i>=0;--i)if((a=t[i].$layout)&&a._visible&&a._box.contains(r))return t[i];return null},draw:function(t,r){var i,a,s,o,l,m;for(i=0,a=r.length;i<a;++i)(o=(s=r[i]).$layout)._visible&&(l=s.geometry(),m=X(s._el,s.model(),l),o._box.update(m,l,s.rotation()),s.draw(t,m))}},h="$datalabels",v="$default";function $(t,r,i){if(r){var o,a=i.$context,s=i.$groups;!r[s._set]||(o=r[s._set][s._key])&&!0===(0,g.O)(o,[a])&&(t[h]._dirty=!0,i.update(a))}}const le={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,g.k)(t))return null;var i,a,s,r=t;if((0,g.i)(t))if((0,g.k)(t.label))if((0,g.k)(t.r))for(r="",s=0,a=(i=Object.keys(t)).length;s<a;++s)r+=(0!==s?", ":"")+i[s]+": "+t[i[s]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[h]={_actives:[]}},beforeUpdate:function(t){var r=t[h];r._listened=!1,r._listeners={},r._datasets=[],r._labels=[]},afterDatasetUpdate:function(t,r,i){var U,ie,_e,pe,ce,me,de,re,a=r.index,s=t[h],o=s._datasets[a]=[],l=t.isDatasetVisible(a),m=t.data.datasets[a],C=function O(t,r){var o,l,i=t.datalabels,a={},s=[];return!1===i?null:(!0===i&&(i={}),r=(0,g.a2)({},[r,i]),o=r.labels||{},l=Object.keys(o),delete r.labels,l.length?l.forEach(function(m){o[m]&&s.push((0,g.a2)({},[r,o[m],{_key:m}]))}):s.push(r),a=s.reduce(function(m,C){return(0,g.D)(C.listeners||{},function(y,R){m[R]=m[R]||{},m[R][C._key||v]=y}),delete C.listeners,m},{}),{labels:s,listeners:a})}(m,i),y=r.meta.data||[],R=t.ctx;for(R.save(),U=0,_e=y.length;U<_e;++U)if((de=y[U])[h]=[],l&&de&&t.getDataVisibility(U)&&!de.skip)for(ie=0,pe=C.labels.length;ie<pe;++ie)me=(ce=C.labels[ie])._key,(re=new w(ce,R,de,U)).$groups={_set:a,_key:me||v},re.$context={active:!1,chart:t,dataIndex:U,dataset:m,datasetIndex:a},re.update(re.$context),de[h].push(re),o.push(re);R.restore(),(0,g.a2)(s._listeners,C.listeners,{merger:function(ue,he,fe){he[ue]=he[ue]||{},he[ue][r.index]=fe[ue],s._listened=!0}})},afterUpdate:function(t,r){t[h]._labels=B.prepare(t[h]._datasets,r)},afterDatasetsDraw:function(t){B.draw(t,t[h]._labels)},beforeEvent:function(t,r){if(t[h]._listened){var i=r.event;switch(i.type){case"mousemove":case"mouseout":!function se(t,r){var s,o,i=t[h],a=i._listeners;if(a.enter||a.leave){if("mousemove"===r.type)o=B.lookup(i._labels,r);else if("mouseout"!==r.type)return;s=i._hovered,i._hovered=o,function z(t,r,i,a){var s,o;!i&&!a||(i?a?i!==a&&(o=s=!0):o=!0:s=!0,o&&$(t,r.leave,i),s&&$(t,r.enter,a))}(t,a,s,o)}}(t,i);break;case"click":!function ne(t,r){var i=t[h],a=i._listeners.click,s=a&&B.lookup(i._labels,r);s&&$(t,a,s)}(t,i)}}},afterEvent:function(t){var o,l,m,C,y,R,U,r=t[h],s=function(t,r){var s,o,l,m,i=t.slice(),a=[];for(s=0,l=r.length;s<l;++s)-1===(o=i.indexOf(m=r[s]))?a.push([m,1]):i.splice(o,1);for(s=0,l=i.length;s<l;++s)a.push([i[s],-1]);return a}(r._actives,r._actives=t.getActiveElements());for(o=0,l=s.length;o<l;++o)if((y=s[o])[1])for(m=0,C=(U=y[0].element[h]||[]).length;m<C;++m)(R=U[m]).$context.active=1===y[1],R.update(R.$context);(r._dirty||s.length)&&(B.update(r._labels),t.render()),delete r._dirty}}}}]);