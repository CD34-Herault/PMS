"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ItemIntegerAction = void 0;
const Action_1 = require("../Action");
const ActionType_1 = require("./ActionType");
class ItemIntegerAction extends Action_1.Action {
    constructor() {
        super(...arguments);
        this.type = ActionType_1.ActionType.ITEM_INTEGER;
    }
    transform(state) {
        const context = state.context;
        const length = state.dataview.getUint8(state.index);
        state.index++;
        context.index++;
        if (length === 1) {
            const value = state.dataview.getUint8(state.index);
            state.index++;
            context.index++;
            const key = Object.keys(context.sequence).length;
            context.sequence[key] = value;
        }
        else {
            throw new Error('read integer length not understood');
        }
        if (context.index === context.length) {
            state.nextAction = ActionType_1.ActionType.INIT;
            return;
        }
        state.nextAction = ActionType_1.ActionType.ITEM;
    }
}
exports.ItemIntegerAction = ItemIntegerAction;
//# sourceMappingURL=ItemIntegerAction.js.map